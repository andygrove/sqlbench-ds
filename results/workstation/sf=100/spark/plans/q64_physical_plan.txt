AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(150) Project [product_name#12261, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s11#12253, s21#12254, s31#12255, s12#12256, s22#12257, s32#12258, syear#12386, cnt#12389L]
   +- *(150) Sort [product_name#12261 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, cnt#12389L ASC NULLS FIRST, s1#12277 ASC NULLS FIRST, s1#12390 ASC NULLS FIRST], true, 0
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 100
            +- Exchange rangepartitioning(product_name#12261 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, cnt#12389L ASC NULLS FIRST, s1#12277 ASC NULLS FIRST, s1#12390 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#133945]
               +- *(149) Project [product_name#12261, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s1#12277 AS s11#12253, s2#12278 AS s21#12254, s3#12279 AS s31#12255, s1#12390 AS s12#12256, s2#12391 AS s22#12257, s3#12392 AS s32#12258, syear#12386, cnt#12389L, s1#12277, s1#12390]
                  +- *(149) SortMergeJoin [item_sk#12262, store_name#12263, store_zip#12264], [item_sk#12375, store_name#12376, store_zip#12377], Inner, (cnt#12389L <= cnt#12276L)
                     :- *(147) Sort [item_sk#12262 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, store_zip#12264 ASC NULLS FIRST], false, 0
                     :  +- AQEShuffleRead coalesced
                     :     +- ShuffleQueryStage 98
                     :        +- Exchange hashpartitioning(item_sk#12262, store_name#12263, store_zip#12264, 200), ENSURE_REQUIREMENTS, [id=#133711]
                     :           +- *(143) HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#263)), sum(UnscaledValue(ss_list_price#264)), sum(UnscaledValue(ss_coupon_amt#271))], output=[product_name#12261, item_sk#12262, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s1#12277, s2#12278, s3#12279])
                     :              +- *(143) HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#263)), partial_sum(UnscaledValue(ss_list_price#264)), partial_sum(UnscaledValue(ss_coupon_amt#271))], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314, count#12773L, sum#12774L, sum#12775L, sum#12776L])
                     :                 +- *(143) Project [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#12286, d_year#12314, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, i_item_sk#668, i_product_name#689]
                     :                    +- *(143) SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
                     :                       :- *(141) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                     :                       :  +- AQEShuffleRead coalesced
                     :                       :     +- ShuffleQueryStage 96
                     :                       :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#133416]
                     :                       :           +- *(137) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
                     :                       :              +- *(137) SortMergeJoin [hd_income_band_sk#12346], [ib_income_band_sk#12363], Inner
                     :                       :                 :- *(135) Sort [hd_income_band_sk#12346 ASC NULLS FIRST], false, 0
                     :                       :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :     +- ShuffleQueryStage 94
                     :                       :                 :        +- Exchange hashpartitioning(hd_income_band_sk#12346, 200), ENSURE_REQUIREMENTS, [id=#133041]
                     :                       :                 :           +- *(131) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
                     :                       :                 :              +- *(131) SortMergeJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner
                     :                       :                 :                 :- *(129) Sort [hd_income_band_sk#89 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :     +- ShuffleQueryStage 92
                     :                       :                 :                 :        +- Exchange hashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#132582]
                     :                       :                 :                 :           +- *(125) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
                     :                       :                 :                 :              +- *(125) SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#12350], Inner
                     :                       :                 :                 :                 :- *(123) Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :     +- ShuffleQueryStage 90
                     :                       :                 :                 :                 :        +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#132039]
                     :                       :                 :                 :                 :           +- *(119) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71]
                     :                       :                 :                 :                 :              +- *(119) SortMergeJoin [ss_addr_sk#258], [ca_address_sk#62], Inner
                     :                       :                 :                 :                 :                 :- *(117) Sort [ss_addr_sk#258 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :     +- ShuffleQueryStage 88
                     :                       :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#131412]
                     :                       :                 :                 :                 :                 :           +- *(113) Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346]
                     :                       :                 :                 :                 :                 :              +- *(113) SortMergeJoin [c_current_hdemo_sk#403], [hd_demo_sk#12345], Inner
                     :                       :                 :                 :                 :                 :                 :- *(111) Sort [c_current_hdemo_sk#403 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 86
                     :                       :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#130701]
                     :                       :                 :                 :                 :                 :                 :           +- *(107) Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89]
                     :                       :                 :                 :                 :                 :                 :              +- *(107) SortMergeJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner
                     :                       :                 :                 :                 :                 :                 :                 :- *(105) Sort [ss_hdemo_sk#257 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 84
                     :                       :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#129906]
                     :                       :                 :                 :                 :                 :                 :                 :           +- *(101) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
                     :                       :                 :                 :                 :                 :                 :                 :              +- *(101) SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :- *(99) Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 82
                     :                       :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#129027]
                     :                       :                 :                 :                 :                 :                 :                 :                 :           +- *(95) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
                     :                       :                 :                 :                 :                 :                 :                 :                 :              +- *(95) SortMergeJoin [c_current_cdemo_sk#402], [cd_demo_sk#12336], Inner, NOT (cd_marital_status#224 = cd_marital_status#12338)
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :- *(93) Sort [c_current_cdemo_sk#402 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 80
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#128064]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(89) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314, cd_marital_status#224]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(89) SortMergeJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(87) Sort [ss_cdemo_sk#256 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 78
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#127017]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(83) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(83) SortMergeJoin [c_first_shipto_date_sk#405], [d_date_sk#12308], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(81) Sort [c_first_shipto_date_sk#405 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 76
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#125886]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(77) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#12286]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(77) SortMergeJoin [c_first_sales_date_sk#406], [d_date_sk#12280], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(75) Sort [c_first_sales_date_sk#406 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 74
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#124671]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(71) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(71) SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(69) Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 72
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#123372]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(65) Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(65) SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(63) Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 70
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#122472]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(59) Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(59) SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(57) Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 67
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#121011]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(53) Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(53) SortMergeJoin [ss_item_sk#254], [cs_item_sk#559], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(51) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 61
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#111290]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(41) Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(41) SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(39) Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- ShuffleQueryStage 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#108817]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- *(1) Filter ((((((((isnotnull(ss_item_sk#254) AND isnotnull(ss_ticket_number#261L)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_customer_sk#255)) AND isnotnull(ss_cdemo_sk#256)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_hdemo_sk#257)) AND isnotnull(ss_addr_sk#258))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(1) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(40) Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 1
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#108834]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- *(2) Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(2) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(52) Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- *(52) Project [cs_item_sk#559]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- *(52) Filter (isnotnull(sale#12259) AND (cast(sale#12259 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12260)), DecimalType(21,2), true)))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- *(52) HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#12259, refund#12260])
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- ShuffleQueryStage 64
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#114669]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                      +- *(47) HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#12780L, sum#12781, isEmpty#12782])
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                         +- *(47) Project [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                            +- *(47) SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :- *(45) Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :     +- ShuffleQueryStage 2
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :        +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#108855]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :           +- *(3) Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_order_number#561L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :              +- *(3) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :                 +- FileScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               +- *(46) Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                     +- ShuffleQueryStage 3
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                        +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#108872]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                           +- *(4) Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                              +- *(4) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                                 +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(58) Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 4
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#108901]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(5) Filter ((isnotnull(d_year#618) AND (d_year#618 = 2000)) AND isnotnull(d_date_sk#612))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(5) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2000), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(64) Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 5
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#108922]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(6) Filter ((isnotnull(s_store_sk#712) AND isnotnull(s_store_name#717)) AND isnotnull(s_zip#737))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(6) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(70) Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 6
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#108943]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(7) Filter (((((isnotnull(c_customer_sk#400) AND isnotnull(c_first_sales_date_sk#406)) AND isnotnull(c_first_shipto_date_sk#405)) AND isnotnull(c_current_cdemo_sk#402)) AND isnotnull(c_current_hdemo_sk#403)) AND isnotnull(c_current_addr_sk#404))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(7) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(76) Sort [d_date_sk#12280 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 7
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#12280, 200), ENSURE_REQUIREMENTS, [id=#108964]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(8) Filter isnotnull(d_date_sk#12280)
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(8) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#12280,d_year#12286] Batched: true, DataFilters: [isnotnull(d_date_sk#12280)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(82) Sort [d_date_sk#12308 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 9
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#12308, d_year#12314], Exchange hashpartitioning(d_date_sk#12280, 200), ENSURE_REQUIREMENTS, [id=#108964]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(88) Sort [cd_demo_sk#222 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 10
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#109008]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(10) Filter (isnotnull(cd_demo_sk#222) AND isnotnull(cd_marital_status#224))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(10) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 +- *(94) Sort [cd_demo_sk#12336 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 12
                     :                       :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#12336, cd_marital_status#12338], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#109008]
                     :                       :                 :                 :                 :                 :                 :                 :                 +- *(100) Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 13
                     :                       :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#109052]
                     :                       :                 :                 :                 :                 :                 :                 :                             +- *(12) Filter isnotnull(p_promo_sk#98)
                     :                       :                 :                 :                 :                 :                 :                 :                                +- *(12) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                     :                       :                 :                 :                 :                 :                 :                 +- *(106) Sort [hd_demo_sk#88 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 14
                     :                       :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#109073]
                     :                       :                 :                 :                 :                 :                 :                             +- *(13) Filter (isnotnull(hd_demo_sk#88) AND isnotnull(hd_income_band_sk#89))
                     :                       :                 :                 :                 :                 :                 :                                +- *(13) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                                   +- FileScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                     :                       :                 :                 :                 :                 :                 +- *(112) Sort [hd_demo_sk#12345 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                       +- ShuffleQueryStage 16
                     :                       :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#12345, hd_income_band_sk#12346], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#109073]
                     :                       :                 :                 :                 :                 +- *(118) Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                       +- ShuffleQueryStage 17
                     :                       :                 :                 :                 :                          +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#109117]
                     :                       :                 :                 :                 :                             +- *(15) Filter isnotnull(ca_address_sk#62)
                     :                       :                 :                 :                 :                                +- *(15) ColumnarToRow
                     :                       :                 :                 :                 :                                   +- FileScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                     :                       :                 :                 :                 +- *(124) Sort [ca_address_sk#12350 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                       +- ShuffleQueryStage 19
                     :                       :                 :                 :                          +- ReusedExchange [ca_address_sk#12350, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#109117]
                     :                       :                 :                 +- *(130) Sort [ib_income_band_sk#240 ASC NULLS FIRST], false, 0
                     :                       :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                       +- ShuffleQueryStage 20
                     :                       :                 :                          +- Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#109161]
                     :                       :                 :                             +- *(17) Filter isnotnull(ib_income_band_sk#240)
                     :                       :                 :                                +- *(17) ColumnarToRow
                     :                       :                 :                                   +- FileScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                     :                       :                 +- *(136) Sort [ib_income_band_sk#12363 ASC NULLS FIRST], false, 0
                     :                       :                    +- AQEShuffleRead coalesced
                     :                       :                       +- ShuffleQueryStage 22
                     :                       :                          +- ReusedExchange [ib_income_band_sk#12363], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#109161]
                     :                       +- *(142) Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
                     :                          +- AQEShuffleRead coalesced
                     :                             +- ShuffleQueryStage 23
                     :                                +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#109207]
                     :                                   +- *(19) Project [i_item_sk#668, i_product_name#689]
                     :                                      +- *(19) Filter ((((((isnotnull(i_current_price#673) AND i_color#685 IN (maroon,burnished,dim,steel,navajo,chocolate)) AND (i_current_price#673 >= 35.00)) AND (i_current_price#673 <= 45.00)) AND (i_current_price#673 >= 36.00)) AND (i_current_price#673 <= 50.00)) AND isnotnull(i_item_sk#668))
                     :                                         +- *(19) ColumnarToRow
                     :                                            +- FileScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (maroon,burnished,dim,steel,navajo,chocolate), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burnished,chocolate,dim,maroon,navajo,steel]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
                     +- *(148) Sort [item_sk#12375 ASC NULLS FIRST, store_name#12376 ASC NULLS FIRST, store_zip#12377 ASC NULLS FIRST], false, 0
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 99
                              +- Exchange hashpartitioning(item_sk#12375, store_name#12376, store_zip#12377, 200), ENSURE_REQUIREMENTS, [id=#133864]
                                 +- *(146) HashAggregate(keys=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#12425)), sum(UnscaledValue(ss_list_price#12426)), sum(UnscaledValue(ss_coupon_amt#12433))], output=[item_sk#12375, store_name#12376, store_zip#12377, syear#12386, cnt#12389L, s1#12390, s2#12391, s3#12392])
                                    +- *(146) HashAggregate(keys=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#12425)), partial_sum(UnscaledValue(ss_list_price#12426)), partial_sum(UnscaledValue(ss_coupon_amt#12433))], output=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580, count#12773L, sum#12786L, sum#12787L, sum#12788L])
                                       +- *(146) Project [ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, d_year#12552, d_year#12580, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, i_item_sk#12728, i_product_name#12749]
                                          +- *(146) SortMergeJoin [ss_item_sk#12416], [i_item_sk#12728], Inner
                                             :- *(144) Sort [ss_item_sk#12416 ASC NULLS FIRST], false, 0
                                             :  +- AQEShuffleRead coalesced
                                             :     +- ShuffleQueryStage 97
                                             :        +- Exchange hashpartitioning(ss_item_sk#12416, 200), ENSURE_REQUIREMENTS, [id=#133569]
                                             :           +- *(140) Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                             :              +- *(140) SortMergeJoin [hd_income_band_sk#12692], [ib_income_band_sk#12725], Inner
                                             :                 :- *(138) Sort [hd_income_band_sk#12692 ASC NULLS FIRST], false, 0
                                             :                 :  +- AQEShuffleRead coalesced
                                             :                 :     +- ShuffleQueryStage 95
                                             :                 :        +- Exchange hashpartitioning(hd_income_band_sk#12692, 200), ENSURE_REQUIREMENTS, [id=#133236]
                                             :                 :           +- *(134) Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                             :                 :              +- *(134) SortMergeJoin [hd_income_band_sk#12687], [ib_income_band_sk#12722], Inner
                                             :                 :                 :- *(132) Sort [hd_income_band_sk#12687 ASC NULLS FIRST], false, 0
                                             :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :     +- ShuffleQueryStage 93
                                             :                 :                 :        +- Exchange hashpartitioning(hd_income_band_sk#12687, 200), ENSURE_REQUIREMENTS, [id=#132819]
                                             :                 :                 :           +- *(128) Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                             :                 :                 :              +- *(128) SortMergeJoin [c_current_addr_sk#12635], [ca_address_sk#12709], Inner
                                             :                 :                 :                 :- *(126) Sort [c_current_addr_sk#12635 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :     +- ShuffleQueryStage 91
                                             :                 :                 :                 :        +- Exchange hashpartitioning(c_current_addr_sk#12635, 200), ENSURE_REQUIREMENTS, [id=#132318]
                                             :                 :                 :                 :           +- *(122) Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705]
                                             :                 :                 :                 :              +- *(122) SortMergeJoin [ss_addr_sk#12420], [ca_address_sk#12696], Inner
                                             :                 :                 :                 :                 :- *(120) Sort [ss_addr_sk#12420 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :     +- ShuffleQueryStage 89
                                             :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_addr_sk#12420, 200), ENSURE_REQUIREMENTS, [id=#131733]
                                             :                 :                 :                 :                 :           +- *(116) Project [ss_item_sk#12416, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692]
                                             :                 :                 :                 :                 :              +- *(116) SortMergeJoin [c_current_hdemo_sk#12634], [hd_demo_sk#12691], Inner
                                             :                 :                 :                 :                 :                 :- *(114) Sort [c_current_hdemo_sk#12634 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 87
                                             :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_hdemo_sk#12634, 200), ENSURE_REQUIREMENTS, [id=#131064]
                                             :                 :                 :                 :                 :                 :           +- *(110) Project [ss_item_sk#12416, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687]
                                             :                 :                 :                 :                 :                 :              +- *(110) SortMergeJoin [ss_hdemo_sk#12419], [hd_demo_sk#12686], Inner
                                             :                 :                 :                 :                 :                 :                 :- *(108) Sort [ss_hdemo_sk#12419 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 85
                                             :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_hdemo_sk#12419, 200), ENSURE_REQUIREMENTS, [id=#130311]
                                             :                 :                 :                 :                 :                 :                 :           +- *(104) Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                             :                 :                 :                 :                 :                 :                 :              +- *(104) SortMergeJoin [ss_promo_sk#12422], [p_promo_sk#12667], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :- *(102) Sort [ss_promo_sk#12422 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 83
                                             :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_promo_sk#12422, 200), ENSURE_REQUIREMENTS, [id=#129474]
                                             :                 :                 :                 :                 :                 :                 :                 :           +- *(98) Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                             :                 :                 :                 :                 :                 :                 :                 :              +- *(98) SortMergeJoin [c_current_cdemo_sk#12633], [cd_demo_sk#12658], Inner, NOT (cd_marital_status#12651 = cd_marital_status#12660)
                                             :                 :                 :                 :                 :                 :                 :                 :                 :- *(96) Sort [c_current_cdemo_sk#12633 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 81
                                             :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_cdemo_sk#12633, 200), ENSURE_REQUIREMENTS, [id=#128553]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(92) Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580, cd_marital_status#12651]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(92) SortMergeJoin [ss_cdemo_sk#12418], [cd_demo_sk#12649], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(90) Sort [ss_cdemo_sk#12418 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 79
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_cdemo_sk#12418, 200), ENSURE_REQUIREMENTS, [id=#127548]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(86) Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(86) SortMergeJoin [c_first_shipto_date_sk#12636], [d_date_sk#12574], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(84) Sort [c_first_shipto_date_sk#12636 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 77
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_shipto_date_sk#12636, 200), ENSURE_REQUIREMENTS, [id=#126459]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(80) Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, c_first_shipto_date_sk#12636, d_year#12552]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(80) SortMergeJoin [c_first_sales_date_sk#12637], [d_date_sk#12546], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(78) Sort [c_first_sales_date_sk#12637 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 75
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_sales_date_sk#12637, 200), ENSURE_REQUIREMENTS, [id=#125286]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(74) Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, c_first_shipto_date_sk#12636, c_first_sales_date_sk#12637]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(74) SortMergeJoin [ss_customer_sk#12417], [c_customer_sk#12631], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(72) Sort [ss_customer_sk#12417 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 73
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_customer_sk#12417, 200), ENSURE_REQUIREMENTS, [id=#124029]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(68) Project [ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(68) SortMergeJoin [ss_store_sk#12421], [s_store_sk#12602], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(66) Sort [ss_store_sk#12421 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 71
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_store_sk#12421, 200), ENSURE_REQUIREMENTS, [id=#122570]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(62) Project [ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_store_sk#12421, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(62) SortMergeJoin [ss_sold_date_sk#12414], [d_date_sk#12518], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(60) Sort [ss_sold_date_sk#12414 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 69
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- ReusedExchange [ss_sold_date_sk#12414, ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_store_sk#12421, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433], Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#121011]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(61) Sort [d_date_sk#12518 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 32
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#12518, 200), ENSURE_REQUIREMENTS, [id=#109324]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(24) Filter ((isnotnull(d_year#12524) AND (d_year#12524 = 2001)) AND isnotnull(d_date_sk#12518))
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(24) ColumnarToRow
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#12518,d_year#12524] Batched: true, DataFilters: [isnotnull(d_year#12524), (d_year#12524 = 2001), isnotnull(d_date_sk#12518)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(67) Sort [s_store_sk#12602 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 34
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [s_store_sk#12602, s_store_name#12607, s_zip#12627], Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#108922]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(73) Sort [c_customer_sk#12631 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 36
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [c_customer_sk#12631, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, c_first_shipto_date_sk#12636, c_first_sales_date_sk#12637], Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#108943]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(79) Sort [d_date_sk#12546 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 38
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#12546, d_year#12552], Exchange hashpartitioning(d_date_sk#12280, 200), ENSURE_REQUIREMENTS, [id=#108964]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(85) Sort [d_date_sk#12574 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 40
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#12574, d_year#12580], Exchange hashpartitioning(d_date_sk#12280, 200), ENSURE_REQUIREMENTS, [id=#108964]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(91) Sort [cd_demo_sk#12649 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 42
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#12649, cd_marital_status#12651], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#109008]
                                             :                 :                 :                 :                 :                 :                 :                 :                 +- *(97) Sort [cd_demo_sk#12658 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 44
                                             :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#12658, cd_marital_status#12660], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#109008]
                                             :                 :                 :                 :                 :                 :                 :                 +- *(103) Sort [p_promo_sk#12667 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 46
                                             :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [p_promo_sk#12667], Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#109052]
                                             :                 :                 :                 :                 :                 :                 +- *(109) Sort [hd_demo_sk#12686 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 48
                                             :                 :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#12686, hd_income_band_sk#12687], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#109073]
                                             :                 :                 :                 :                 :                 +- *(115) Sort [hd_demo_sk#12691 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                       +- ShuffleQueryStage 50
                                             :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#12691, hd_income_band_sk#12692], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#109073]
                                             :                 :                 :                 :                 +- *(121) Sort [ca_address_sk#12696 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                       +- ShuffleQueryStage 52
                                             :                 :                 :                 :                          +- ReusedExchange [ca_address_sk#12696, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#109117]
                                             :                 :                 :                 +- *(127) Sort [ca_address_sk#12709 ASC NULLS FIRST], false, 0
                                             :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                       +- ShuffleQueryStage 54
                                             :                 :                 :                          +- ReusedExchange [ca_address_sk#12709, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#109117]
                                             :                 :                 +- *(133) Sort [ib_income_band_sk#12722 ASC NULLS FIRST], false, 0
                                             :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                       +- ShuffleQueryStage 56
                                             :                 :                          +- ReusedExchange [ib_income_band_sk#12722], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#109161]
                                             :                 +- *(139) Sort [ib_income_band_sk#12725 ASC NULLS FIRST], false, 0
                                             :                    +- AQEShuffleRead coalesced
                                             :                       +- ShuffleQueryStage 58
                                             :                          +- ReusedExchange [ib_income_band_sk#12725], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#109161]
                                             +- *(145) Sort [i_item_sk#12728 ASC NULLS FIRST], false, 0
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage 60
                                                      +- ReusedExchange [i_item_sk#12728, i_product_name#12749], Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#109207]
+- == Initial Plan ==
   Project [product_name#12261, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s11#12253, s21#12254, s31#12255, s12#12256, s22#12257, s32#12258, syear#12386, cnt#12389L]
   +- Sort [product_name#12261 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, cnt#12389L ASC NULLS FIRST, s1#12277 ASC NULLS FIRST, s1#12390 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#12261 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, cnt#12389L ASC NULLS FIRST, s1#12277 ASC NULLS FIRST, s1#12390 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#108219]
         +- Project [product_name#12261, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s1#12277 AS s11#12253, s2#12278 AS s21#12254, s3#12279 AS s31#12255, s1#12390 AS s12#12256, s2#12391 AS s22#12257, s3#12392 AS s32#12258, syear#12386, cnt#12389L, s1#12277, s1#12390]
            +- SortMergeJoin [item_sk#12262, store_name#12263, store_zip#12264], [item_sk#12375, store_name#12376, store_zip#12377], Inner, (cnt#12389L <= cnt#12276L)
               :- Sort [item_sk#12262 ASC NULLS FIRST, store_name#12263 ASC NULLS FIRST, store_zip#12264 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#12262, store_name#12263, store_zip#12264, 200), ENSURE_REQUIREMENTS, [id=#108212]
               :     +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#263)), sum(UnscaledValue(ss_list_price#264)), sum(UnscaledValue(ss_coupon_amt#271))], output=[product_name#12261, item_sk#12262, store_name#12263, store_zip#12264, b_street_number#12265, b_street_name#12266, b_city#12267, b_zip#12268, c_street_number#12269, c_street_name#12270, c_city#12271, c_zip#12272, syear#12273, cnt#12276L, s1#12277, s2#12278, s3#12279])
               :        +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#263)), partial_sum(UnscaledValue(ss_list_price#264)), partial_sum(UnscaledValue(ss_coupon_amt#271))], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, d_year#618, d_year#12286, d_year#12314, count#12773L, sum#12774L, sum#12775L, sum#12776L])
               :           +- Project [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#12286, d_year#12314, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359, i_item_sk#668, i_product_name#689]
               :              +- SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
               :                 :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#108053]
               :                 :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
               :                 :        +- SortMergeJoin [hd_income_band_sk#12346], [ib_income_band_sk#12363], Inner
               :                 :           :- Sort [hd_income_band_sk#12346 ASC NULLS FIRST], false, 0
               :                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#12346, 200), ENSURE_REQUIREMENTS, [id=#108045]
               :                 :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
               :                 :           :        +- SortMergeJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner
               :                 :           :           :- Sort [hd_income_band_sk#89 ASC NULLS FIRST], false, 0
               :                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#108037]
               :                 :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#12352, ca_street_name#12353, ca_city#12356, ca_zip#12359]
               :                 :           :           :        +- SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#12350], Inner
               :                 :           :           :           :- Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
               :                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#108029]
               :                 :           :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71]
               :                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#258], [ca_address_sk#62], Inner
               :                 :           :           :           :           :- Sort [ss_addr_sk#258 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#108021]
               :                 :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89, hd_income_band_sk#12346]
               :                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#403], [hd_demo_sk#12345], Inner
               :                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#403 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#108013]
               :                 :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314, hd_income_band_sk#89]
               :                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner
               :                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#257 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#108005]
               :                 :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
               :                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
               :                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#107997]
               :                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
               :                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#402], [cd_demo_sk#12336], Inner, NOT (cd_marital_status#224 = cd_marital_status#12338)
               :                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#402 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#107989]
               :                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314, cd_marital_status#224]
               :                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner
               :                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#256 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#107981]
               :                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#12286, d_year#12314]
               :                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#405], [d_date_sk#12308], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#405 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#107973]
               :                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#12286]
               :                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#406], [d_date_sk#12280], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#406 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#107965]
               :                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406]
               :                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#107957]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#107949]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#107941]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254], [cs_item_sk#559], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#107934]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#107913]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#254) AND isnotnull(ss_ticket_number#261L)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_customer_sk#255)) AND isnotnull(ss_cdemo_sk#256)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_hdemo_sk#257)) AND isnotnull(ss_addr_sk#258))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#107914]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#559]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#12259) AND (cast(sale#12259 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12260)), DecimalType(21,2), true)))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#12259, refund#12260])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#107928]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#12780L, sum#12781, isEmpty#12782])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#107920]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_order_number#561L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#107921]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#107942]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2000)) AND isnotnull(d_date_sk#612))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2000), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2000), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#107950]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#712) AND isnotnull(s_store_name#717)) AND isnotnull(s_zip#737))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#107958]
               :                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#400) AND isnotnull(c_first_sales_date_sk#406)) AND isnotnull(c_first_shipto_date_sk#405)) AND isnotnull(c_current_cdemo_sk#402)) AND isnotnull(c_current_hdemo_sk#403)) AND isnotnull(c_current_addr_sk#404))
               :                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#12280 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#12280, 200), ENSURE_REQUIREMENTS, [id=#107966]
               :                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#12280)
               :                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#12280,d_year#12286] Batched: true, DataFilters: [isnotnull(d_date_sk#12280)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#12308 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#12308, 200), ENSURE_REQUIREMENTS, [id=#107974]
               :                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#12308)
               :                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#12308,d_year#12314] Batched: true, DataFilters: [isnotnull(d_date_sk#12308)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#222 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#107982]
               :                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#222) AND isnotnull(cd_marital_status#224))
               :                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#12336 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#12336, 200), ENSURE_REQUIREMENTS, [id=#107990]
               :                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#12336) AND isnotnull(cd_marital_status#12338))
               :                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#12336,cd_marital_status#12338] Batched: true, DataFilters: [isnotnull(cd_demo_sk#12336), isnotnull(cd_marital_status#12338)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#107998]
               :                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#98)
               :                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                 :           :           :           :           :           :           +- Sort [hd_demo_sk#88 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#108006]
               :                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#88) AND isnotnull(hd_income_band_sk#89))
               :                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           :           +- Sort [hd_demo_sk#12345 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#12345, 200), ENSURE_REQUIREMENTS, [id=#108014]
               :                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#12345) AND isnotnull(hd_income_band_sk#12346))
               :                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#12345,hd_income_band_sk#12346] Batched: true, DataFilters: [isnotnull(hd_demo_sk#12345), isnotnull(hd_income_band_sk#12346)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           +- Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
               :                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#108022]
               :                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#62)
               :                 :           :           :           :                    +- FileScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           :           +- Sort [ca_address_sk#12350 ASC NULLS FIRST], false, 0
               :                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#12350, 200), ENSURE_REQUIREMENTS, [id=#108030]
               :                 :           :           :                 +- Filter isnotnull(ca_address_sk#12350)
               :                 :           :           :                    +- FileScan parquet [ca_address_sk#12350,ca_street_number#12352,ca_street_name#12353,ca_city#12356,ca_zip#12359] Batched: true, DataFilters: [isnotnull(ca_address_sk#12350)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           +- Sort [ib_income_band_sk#240 ASC NULLS FIRST], false, 0
               :                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#108038]
               :                 :           :                 +- Filter isnotnull(ib_income_band_sk#240)
               :                 :           :                    +- FileScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 :           +- Sort [ib_income_band_sk#12363 ASC NULLS FIRST], false, 0
               :                 :              +- Exchange hashpartitioning(ib_income_band_sk#12363, 200), ENSURE_REQUIREMENTS, [id=#108046]
               :                 :                 +- Filter isnotnull(ib_income_band_sk#12363)
               :                 :                    +- FileScan parquet [ib_income_band_sk#12363] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#12363)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
               :                    +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#108054]
               :                       +- Project [i_item_sk#668, i_product_name#689]
               :                          +- Filter ((((((isnotnull(i_current_price#673) AND i_color#685 IN (maroon,burnished,dim,steel,navajo,chocolate)) AND (i_current_price#673 >= 35.00)) AND (i_current_price#673 <= 45.00)) AND (i_current_price#673 >= 36.00)) AND (i_current_price#673 <= 50.00)) AND isnotnull(i_item_sk#668))
               :                             +- FileScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (maroon,burnished,dim,steel,navajo,chocolate), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burnished,chocolate,dim,maroon,navajo,steel]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
               +- Sort [item_sk#12375 ASC NULLS FIRST, store_name#12376 ASC NULLS FIRST, store_zip#12377 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#12375, store_name#12376, store_zip#12377, 200), ENSURE_REQUIREMENTS, [id=#108213]
                     +- HashAggregate(keys=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#12425)), sum(UnscaledValue(ss_list_price#12426)), sum(UnscaledValue(ss_coupon_amt#12433))], output=[item_sk#12375, store_name#12376, store_zip#12377, syear#12386, cnt#12389L, s1#12390, s2#12391, s3#12392])
                        +- HashAggregate(keys=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#12425)), partial_sum(UnscaledValue(ss_list_price#12426)), partial_sum(UnscaledValue(ss_coupon_amt#12433))], output=[i_product_name#12749, i_item_sk#12728, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, d_year#12524, d_year#12552, d_year#12580, count#12773L, sum#12786L, sum#12787L, sum#12788L])
                           +- Project [ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, d_year#12552, d_year#12580, s_store_name#12607, s_zip#12627, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718, i_item_sk#12728, i_product_name#12749]
                              +- SortMergeJoin [ss_item_sk#12416], [i_item_sk#12728], Inner
                                 :- Sort [ss_item_sk#12416 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(ss_item_sk#12416, 200), ENSURE_REQUIREMENTS, [id=#108202]
                                 :     +- Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                 :        +- SortMergeJoin [hd_income_band_sk#12692], [ib_income_band_sk#12725], Inner
                                 :           :- Sort [hd_income_band_sk#12692 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#12692, 200), ENSURE_REQUIREMENTS, [id=#108194]
                                 :           :     +- Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                 :           :        +- SortMergeJoin [hd_income_band_sk#12687], [ib_income_band_sk#12722], Inner
                                 :           :           :- Sort [hd_income_band_sk#12687 ASC NULLS FIRST], false, 0
                                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#12687, 200), ENSURE_REQUIREMENTS, [id=#108186]
                                 :           :           :     +- Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705, ca_street_number#12711, ca_street_name#12712, ca_city#12715, ca_zip#12718]
                                 :           :           :        +- SortMergeJoin [c_current_addr_sk#12635], [ca_address_sk#12709], Inner
                                 :           :           :           :- Sort [c_current_addr_sk#12635 ASC NULLS FIRST], false, 0
                                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#12635, 200), ENSURE_REQUIREMENTS, [id=#108178]
                                 :           :           :           :     +- Project [ss_item_sk#12416, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692, ca_street_number#12698, ca_street_name#12699, ca_city#12702, ca_zip#12705]
                                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#12420], [ca_address_sk#12696], Inner
                                 :           :           :           :           :- Sort [ss_addr_sk#12420 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#12420, 200), ENSURE_REQUIREMENTS, [id=#108170]
                                 :           :           :           :           :     +- Project [ss_item_sk#12416, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687, hd_income_band_sk#12692]
                                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#12634], [hd_demo_sk#12691], Inner
                                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#12634 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#12634, 200), ENSURE_REQUIREMENTS, [id=#108162]
                                 :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580, hd_income_band_sk#12687]
                                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#12419], [hd_demo_sk#12686], Inner
                                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#12419 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#12419, 200), ENSURE_REQUIREMENTS, [id=#108154]
                                 :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#12422], [p_promo_sk#12667], Inner
                                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#12422 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#12422, 200), ENSURE_REQUIREMENTS, [id=#108146]
                                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#12633], [cd_demo_sk#12658], Inner, NOT (cd_marital_status#12651 = cd_marital_status#12660)
                                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#12633 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#12633, 200), ENSURE_REQUIREMENTS, [id=#108138]
                                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580, cd_marital_status#12651]
                                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#12418], [cd_demo_sk#12649], Inner
                                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#12418 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#12418, 200), ENSURE_REQUIREMENTS, [id=#108130]
                                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, d_year#12552, d_year#12580]
                                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#12636], [d_date_sk#12574], Inner
                                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#12636 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#12636, 200), ENSURE_REQUIREMENTS, [id=#108122]
                                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, c_first_shipto_date_sk#12636, d_year#12552]
                                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#12637], [d_date_sk#12546], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#12637 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#12637, 200), ENSURE_REQUIREMENTS, [id=#108114]
                                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627, c_current_cdemo_sk#12633, c_current_hdemo_sk#12634, c_current_addr_sk#12635, c_first_shipto_date_sk#12636, c_first_sales_date_sk#12637]
                                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#12417], [c_customer_sk#12631], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#12417 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#12417, 200), ENSURE_REQUIREMENTS, [id=#108106]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524, s_store_name#12607, s_zip#12627]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#12421], [s_store_sk#12602], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#12421 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#12421, 200), ENSURE_REQUIREMENTS, [id=#108098]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_store_sk#12421, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433, d_year#12524]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#12414], [d_date_sk#12518], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#12414 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#12414, 200), ENSURE_REQUIREMENTS, [id=#108090]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#12414, ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_store_sk#12421, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#12416], [cs_item_sk#12472], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#12416 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#12416, 200), ENSURE_REQUIREMENTS, [id=#108083]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#12414, ss_item_sk#12416, ss_customer_sk#12417, ss_cdemo_sk#12418, ss_hdemo_sk#12419, ss_addr_sk#12420, ss_store_sk#12421, ss_promo_sk#12422, ss_wholesale_cost#12425, ss_list_price#12426, ss_coupon_amt#12433]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#12416, ss_ticket_number#12423L], [sr_item_sk#12439, sr_ticket_number#12446L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#12416 ASC NULLS FIRST, ss_ticket_number#12423L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#12416, ss_ticket_number#12423L, 200), ENSURE_REQUIREMENTS, [id=#108062]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#12416) AND isnotnull(ss_ticket_number#12423L)) AND isnotnull(ss_sold_date_sk#12414)) AND isnotnull(ss_store_sk#12421)) AND isnotnull(ss_customer_sk#12417)) AND isnotnull(ss_cdemo_sk#12418)) AND isnotnull(ss_promo_sk#12422)) AND isnotnull(ss_hdemo_sk#12419)) AND isnotnull(ss_addr_sk#12420))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#12414,ss_item_sk#12416,ss_customer_sk#12417,ss_cdemo_sk#12418,ss_hdemo_sk#12419,ss_addr_sk#12420,ss_store_sk#12421,ss_promo_sk#12422,ss_ticket_number#12423L,ss_wholesale_cost#12425,ss_list_price#12426,ss_coupon_amt#12433] Batched: true, DataFilters: [isnotnull(ss_item_sk#12416), isnotnull(ss_ticket_number#12423L), isnotnull(ss_sold_date_sk#12414..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#12439 ASC NULLS FIRST, sr_ticket_number#12446L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#12439, sr_ticket_number#12446L, 200), ENSURE_REQUIREMENTS, [id=#108063]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#12439) AND isnotnull(sr_ticket_number#12446L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#12439,sr_ticket_number#12446L] Batched: true, DataFilters: [isnotnull(sr_item_sk#12439), isnotnull(sr_ticket_number#12446L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#12472 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#12472]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#12259) AND (cast(sale#12259 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#12260)), DecimalType(21,2), true)))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#12472], functions=[sum(UnscaledValue(cs_ext_list_price#12482)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#12514 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#12515 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#12516 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#12472, sale#12259, refund#12260])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#12472, 200), ENSURE_REQUIREMENTS, [id=#108077]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#12472], functions=[partial_sum(UnscaledValue(cs_ext_list_price#12482)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#12514 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#12515 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#12516 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#12472, sum#12792L, sum#12793, isEmpty#12794])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#12472, cs_ext_list_price#12482, cr_refunded_cash#12514, cr_reversed_charge#12515, cr_store_credit#12516]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#12472, cs_order_number#12474L], [cr_item_sk#12493, cr_order_number#12507L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#12472 ASC NULLS FIRST, cs_order_number#12474L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#12472, cs_order_number#12474L, 200), ENSURE_REQUIREMENTS, [id=#108069]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#12472) AND isnotnull(cs_order_number#12474L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#12472,cs_order_number#12474L,cs_ext_list_price#12482] Batched: true, DataFilters: [isnotnull(cs_item_sk#12472), isnotnull(cs_order_number#12474L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#12493 ASC NULLS FIRST, cr_order_number#12507L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#12493, cr_order_number#12507L, 200), ENSURE_REQUIREMENTS, [id=#108070]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#12493) AND isnotnull(cr_order_number#12507L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#12493,cr_order_number#12507L,cr_refunded_cash#12514,cr_reversed_charge#12515,cr_store_credit#12516] Batched: true, DataFilters: [isnotnull(cr_item_sk#12493), isnotnull(cr_order_number#12507L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#12518 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#12518, 200), ENSURE_REQUIREMENTS, [id=#108091]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#12524) AND (d_year#12524 = 2001)) AND isnotnull(d_date_sk#12518))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#12518,d_year#12524] Batched: true, DataFilters: [isnotnull(d_year#12524), (d_year#12524 = 2001), isnotnull(d_date_sk#12518)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#12602 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#12602, 200), ENSURE_REQUIREMENTS, [id=#108099]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#12602) AND isnotnull(s_store_name#12607)) AND isnotnull(s_zip#12627))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#12602,s_store_name#12607,s_zip#12627] Batched: true, DataFilters: [isnotnull(s_store_sk#12602), isnotnull(s_store_name#12607), isnotnull(s_zip#12627)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#12631 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#12631, 200), ENSURE_REQUIREMENTS, [id=#108107]
                                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#12631) AND isnotnull(c_first_sales_date_sk#12637)) AND isnotnull(c_first_shipto_date_sk#12636)) AND isnotnull(c_current_cdemo_sk#12633)) AND isnotnull(c_current_hdemo_sk#12634)) AND isnotnull(c_current_addr_sk#12635))
                                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#12631,c_current_cdemo_sk#12633,c_current_hdemo_sk#12634,c_current_addr_sk#12635,c_first_shipto_date_sk#12636,c_first_sales_date_sk#12637] Batched: true, DataFilters: [isnotnull(c_customer_sk#12631), isnotnull(c_first_sales_date_sk#12637), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#12546 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#12546, 200), ENSURE_REQUIREMENTS, [id=#108115]
                                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#12546)
                                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#12546,d_year#12552] Batched: true, DataFilters: [isnotnull(d_date_sk#12546)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#12574 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#12574, 200), ENSURE_REQUIREMENTS, [id=#108123]
                                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#12574)
                                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#12574,d_year#12580] Batched: true, DataFilters: [isnotnull(d_date_sk#12574)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#12649 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#12649, 200), ENSURE_REQUIREMENTS, [id=#108131]
                                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#12649) AND isnotnull(cd_marital_status#12651))
                                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#12649,cd_marital_status#12651] Batched: true, DataFilters: [isnotnull(cd_demo_sk#12649), isnotnull(cd_marital_status#12651)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#12658 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#12658, 200), ENSURE_REQUIREMENTS, [id=#108139]
                                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#12658) AND isnotnull(cd_marital_status#12660))
                                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#12658,cd_marital_status#12660] Batched: true, DataFilters: [isnotnull(cd_demo_sk#12658), isnotnull(cd_marital_status#12660)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#12667 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#12667, 200), ENSURE_REQUIREMENTS, [id=#108147]
                                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#12667)
                                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#12667] Batched: true, DataFilters: [isnotnull(p_promo_sk#12667)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                 :           :           :           :           :           :           +- Sort [hd_demo_sk#12686 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#12686, 200), ENSURE_REQUIREMENTS, [id=#108155]
                                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#12686) AND isnotnull(hd_income_band_sk#12687))
                                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#12686,hd_income_band_sk#12687] Batched: true, DataFilters: [isnotnull(hd_demo_sk#12686), isnotnull(hd_income_band_sk#12687)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           :           +- Sort [hd_demo_sk#12691 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#12691, 200), ENSURE_REQUIREMENTS, [id=#108163]
                                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#12691) AND isnotnull(hd_income_band_sk#12692))
                                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#12691,hd_income_band_sk#12692] Batched: true, DataFilters: [isnotnull(hd_demo_sk#12691), isnotnull(hd_income_band_sk#12692)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           +- Sort [ca_address_sk#12696 ASC NULLS FIRST], false, 0
                                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#12696, 200), ENSURE_REQUIREMENTS, [id=#108171]
                                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#12696)
                                 :           :           :           :                    +- FileScan parquet [ca_address_sk#12696,ca_street_number#12698,ca_street_name#12699,ca_city#12702,ca_zip#12705] Batched: true, DataFilters: [isnotnull(ca_address_sk#12696)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           :           +- Sort [ca_address_sk#12709 ASC NULLS FIRST], false, 0
                                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#12709, 200), ENSURE_REQUIREMENTS, [id=#108179]
                                 :           :           :                 +- Filter isnotnull(ca_address_sk#12709)
                                 :           :           :                    +- FileScan parquet [ca_address_sk#12709,ca_street_number#12711,ca_street_name#12712,ca_city#12715,ca_zip#12718] Batched: true, DataFilters: [isnotnull(ca_address_sk#12709)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           +- Sort [ib_income_band_sk#12722 ASC NULLS FIRST], false, 0
                                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#12722, 200), ENSURE_REQUIREMENTS, [id=#108187]
                                 :           :                 +- Filter isnotnull(ib_income_band_sk#12722)
                                 :           :                    +- FileScan parquet [ib_income_band_sk#12722] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#12722)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 :           +- Sort [ib_income_band_sk#12725 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(ib_income_band_sk#12725, 200), ENSURE_REQUIREMENTS, [id=#108195]
                                 :                 +- Filter isnotnull(ib_income_band_sk#12725)
                                 :                    +- FileScan parquet [ib_income_band_sk#12725] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#12725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 +- Sort [i_item_sk#12728 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(i_item_sk#12728, 200), ENSURE_REQUIREMENTS, [id=#108203]
                                       +- Project [i_item_sk#12728, i_product_name#12749]
                                          +- Filter ((((((isnotnull(i_current_price#12733) AND i_color#12745 IN (maroon,burnished,dim,steel,navajo,chocolate)) AND (i_current_price#12733 >= 35.00)) AND (i_current_price#12733 <= 45.00)) AND (i_current_price#12733 >= 36.00)) AND (i_current_price#12733 <= 50.00)) AND isnotnull(i_item_sk#12728))
                                             +- FileScan parquet [i_item_sk#12728,i_current_price#12733,i_color#12745,i_product_name#12749] Batched: true, DataFilters: [isnotnull(i_current_price#12733), i_color#12745 IN (maroon,burnished,dim,steel,navajo,chocolate)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [burnished,chocolate,dim,maroon,navajo,steel]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
