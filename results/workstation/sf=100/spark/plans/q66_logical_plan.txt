GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#772 ASC NULLS FIRST], true
      +- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#13075, year#13076], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#13075, year#13076, sum(jan_sales#13077) AS jan_sales#13127, sum(feb_sales#13078) AS feb_sales#13128, sum(mar_sales#13079) AS mar_sales#13129, sum(apr_sales#13080) AS apr_sales#13130, sum(may_sales#13081) AS may_sales#13131, sum(jun_sales#13082) AS jun_sales#13132, sum(jul_sales#13083) AS jul_sales#13133, sum(aug_sales#13084) AS aug_sales#13134, sum(sep_sales#13085) AS sep_sales#13135, sum(oct_sales#13086) AS oct_sales#13136, sum(nov_sales#13087) AS nov_sales#13137, sum(dec_sales#13088) AS dec_sales#13138, sum(CheckOverflow((promote_precision(jan_sales#13077) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS jan_sales_per_sq_foot#13139, sum(CheckOverflow((promote_precision(feb_sales#13078) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS feb_sales_per_sq_foot#13140, sum(CheckOverflow((promote_precision(mar_sales#13079) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS mar_sales_per_sq_foot#13141, sum(CheckOverflow((promote_precision(apr_sales#13080) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS apr_sales_per_sq_foot#13142, ... 20 more fields]
         +- Union false, false
            :- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, DIAMOND,AIRBORNE AS ship_carriers#13075, d_year#618 AS year#13076, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#13077, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#13078, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#13079, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#13080, sum(CASE WHEN (d_moy#620 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#13081, sum(CASE WHEN (d_moy#620 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#13082, sum(CASE WHEN (d_moy#620 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#13083, sum(CASE WHEN (d_moy#620 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#13084, sum(CASE WHEN (d_moy#620 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#13085, sum(CASE WHEN (d_moy#620 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#13086, sum(CASE WHEN (d_moy#620 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#13087, sum(CASE WHEN (d_moy#620 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#13088, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#13089, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#13090, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#13091, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#13092, ... 8 more fields]
            :  +- Project [ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :     +- Join Inner, (ws_ship_mode_sk#490 = sm_ship_mode_sk#444)
            :        :- Project [ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :        :  +- Join Inner, (ws_sold_time_sk#477 = t_time_sk#456)
            :        :     :- Project [ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :        :     :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#612)
            :        :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#491 = w_warehouse_sk#770)
            :        :     :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_warehouse_sk#491, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506]
            :        :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#491) AND isnotnull(ws_sold_date_sk#476)) AND (isnotnull(ws_sold_time_sk#477) AND isnotnull(ws_ship_mode_sk#490)))
            :        :     :     :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#770, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#770)
            :        :     :     :           +- Relation [w_warehouse_sk#770,w_warehouse_id#771,w_warehouse_name#772,w_warehouse_sq_ft#773,w_street_number#774,w_street_name#775,w_street_type#776,w_suite_number#777,w_city#778,w_county#779,w_state#780,w_zip#781,w_country#782,w_gmt_offset#783] parquet
            :        :     :     +- Project [d_date_sk#612, d_year#618, d_moy#620]
            :        :     :        +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2002)) AND isnotnull(d_date_sk#612))
            :        :     :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :        :     +- Project [t_time_sk#456]
            :        :        +- Filter ((isnotnull(t_time#458) AND ((t_time#458 >= 49530) AND (t_time#458 <= 78330))) AND isnotnull(t_time_sk#456))
            :        :           +- Relation [t_time_sk#456,t_time_id#457,t_time#458,t_hour#459,t_minute#460,t_second#461,t_am_pm#462,t_shift#463,t_sub_shift#464,t_meal_time#465] parquet
            :        +- Project [sm_ship_mode_sk#444]
            :           +- Filter (sm_carrier#448 IN (DIAMOND,AIRBORNE) AND isnotnull(sm_ship_mode_sk#444))
            :              +- Relation [sm_ship_mode_sk#444,sm_ship_mode_id#445,sm_type#446,sm_code#447,sm_carrier#448,sm_contract#449] parquet
            +- Aggregate [w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175, d_year#13183], [w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175, DIAMOND,AIRBORNE AS ship_carriers#13101, d_year#13183 AS year#13102, sum(CASE WHEN (d_moy#13185 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#13103, sum(CASE WHEN (d_moy#13185 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#13104, sum(CASE WHEN (d_moy#13185 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#13105, sum(CASE WHEN (d_moy#13185 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#13106, sum(CASE WHEN (d_moy#13185 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#13107, sum(CASE WHEN (d_moy#13185 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#13108, sum(CASE WHEN (d_moy#13185 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#13109, sum(CASE WHEN (d_moy#13185 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#13110, sum(CASE WHEN (d_moy#13185 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#13111, sum(CASE WHEN (d_moy#13185 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#13112, sum(CASE WHEN (d_moy#13185 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#13113, sum(CASE WHEN (d_moy#13185 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_sales_price#567 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#13114, sum(CASE WHEN (d_moy#13185 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_ship_tax#576 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#13115, sum(CASE WHEN (d_moy#13185 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_ship_tax#576 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#13116, sum(CASE WHEN (d_moy#13185 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_ship_tax#576 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#13117, sum(CASE WHEN (d_moy#13185 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_ship_tax#576 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#13118, ... 8 more fields]
               +- Project [cs_quantity#562, cs_ext_sales_price#567, cs_net_paid_inc_ship_tax#576, w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175, d_year#13183, d_moy#13185]
                  +- Join Inner, (cs_ship_mode_sk#557 = sm_ship_mode_sk#13215)
                     :- Project [cs_ship_mode_sk#557, cs_quantity#562, cs_ext_sales_price#567, cs_net_paid_inc_ship_tax#576, w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175, d_year#13183, d_moy#13185]
                     :  +- Join Inner, (cs_sold_time_sk#545 = t_time_sk#13205)
                     :     :- Project [cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_quantity#562, cs_ext_sales_price#567, cs_net_paid_inc_ship_tax#576, w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175, d_year#13183, d_moy#13185]
                     :     :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#13177)
                     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_quantity#562, cs_ext_sales_price#567, cs_net_paid_inc_ship_tax#576, w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175]
                     :     :     :  +- Join Inner, (cs_warehouse_sk#558 = w_warehouse_sk#13163)
                     :     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_warehouse_sk#558, cs_quantity#562, cs_ext_sales_price#567, cs_net_paid_inc_ship_tax#576]
                     :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#558) AND isnotnull(cs_sold_date_sk#544)) AND (isnotnull(cs_sold_time_sk#545) AND isnotnull(cs_ship_mode_sk#557)))
                     :     :     :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#13163, w_warehouse_name#13165, w_warehouse_sq_ft#13166, w_city#13171, w_county#13172, w_state#13173, w_country#13175]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#13163)
                     :     :     :           +- Relation [w_warehouse_sk#13163,w_warehouse_id#13164,w_warehouse_name#13165,w_warehouse_sq_ft#13166,w_street_number#13167,w_street_name#13168,w_street_type#13169,w_suite_number#13170,w_city#13171,w_county#13172,w_state#13173,w_zip#13174,w_country#13175,w_gmt_offset#13176] parquet
                     :     :     +- Project [d_date_sk#13177, d_year#13183, d_moy#13185]
                     :     :        +- Filter ((isnotnull(d_year#13183) AND (d_year#13183 = 2002)) AND isnotnull(d_date_sk#13177))
                     :     :           +- Relation [d_date_sk#13177,d_date_id#13178,d_date#13179,d_month_seq#13180,d_week_seq#13181,d_quarter_seq#13182,d_year#13183,d_dow#13184,d_moy#13185,d_dom#13186,d_qoy#13187,d_fy_year#13188,d_fy_quarter_seq#13189,d_fy_week_seq#13190,d_day_name#13191,d_quarter_name#13192,d_holiday#13193,d_weekend#13194,d_following_holiday#13195,d_first_dom#13196,d_last_dom#13197,d_same_day_ly#13198,d_same_day_lq#13199,d_current_day#13200,... 4 more fields] parquet
                     :     +- Project [t_time_sk#13205]
                     :        +- Filter ((isnotnull(t_time#13207) AND ((t_time#13207 >= 49530) AND (t_time#13207 <= 78330))) AND isnotnull(t_time_sk#13205))
                     :           +- Relation [t_time_sk#13205,t_time_id#13206,t_time#13207,t_hour#13208,t_minute#13209,t_second#13210,t_am_pm#13211,t_shift#13212,t_sub_shift#13213,t_meal_time#13214] parquet
                     +- Project [sm_ship_mode_sk#13215]
                        +- Filter (sm_carrier#13219 IN (DIAMOND,AIRBORNE) AND isnotnull(sm_ship_mode_sk#13215))
                           +- Relation [sm_ship_mode_sk#13215,sm_ship_mode_id#13216,sm_type#13217,sm_code#13218,sm_carrier#13219,sm_contract#13220] parquet
