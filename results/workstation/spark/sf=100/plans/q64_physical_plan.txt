AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   *(150) Project [product_name#14414, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s11#14406, s21#14407, s31#14408, s12#14409, s22#14410, s32#14411, syear#14539, cnt#14542L]
   +- *(150) Sort [product_name#14414 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, cnt#14542L ASC NULLS FIRST, s1#14430 ASC NULLS FIRST, s1#14543 ASC NULLS FIRST], true, 0
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 100
            +- Exchange rangepartitioning(product_name#14414 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, cnt#14542L ASC NULLS FIRST, s1#14430 ASC NULLS FIRST, s1#14543 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#207402]
               +- *(149) Project [product_name#14414, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s1#14430 AS s11#14406, s2#14431 AS s21#14407, s3#14432 AS s31#14408, s1#14543 AS s12#14409, s2#14544 AS s22#14410, s3#14545 AS s32#14411, syear#14539, cnt#14542L, s1#14430, s1#14543]
                  +- *(149) SortMergeJoin [item_sk#14415, store_name#14416, store_zip#14417], [item_sk#14528, store_name#14529, store_zip#14530], Inner, (cnt#14542L <= cnt#14429L)
                     :- *(147) Sort [item_sk#14415 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, store_zip#14417 ASC NULLS FIRST], false, 0
                     :  +- AQEShuffleRead coalesced
                     :     +- ShuffleQueryStage 99
                     :        +- Exchange hashpartitioning(item_sk#14415, store_name#14416, store_zip#14417, 200), ENSURE_REQUIREMENTS, [id=#207321]
                     :           +- *(146) HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#263)), sum(UnscaledValue(ss_list_price#264)), sum(UnscaledValue(ss_coupon_amt#271))], output=[product_name#14414, item_sk#14415, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s1#14430, s2#14431, s3#14432])
                     :              +- *(146) HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#263)), partial_sum(UnscaledValue(ss_list_price#264)), partial_sum(UnscaledValue(ss_coupon_amt#271))], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467, count#14926L, sum#14927L, sum#14928L, sum#14929L])
                     :                 +- *(146) Project [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#14439, d_year#14467, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, i_item_sk#668, i_product_name#689]
                     :                    +- *(146) SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
                     :                       :- *(144) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                     :                       :  +- AQEShuffleRead coalesced
                     :                       :     +- ShuffleQueryStage 97
                     :                       :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#207026]
                     :                       :           +- *(140) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
                     :                       :              +- *(140) SortMergeJoin [hd_income_band_sk#14499], [ib_income_band_sk#14516], Inner
                     :                       :                 :- *(138) Sort [hd_income_band_sk#14499 ASC NULLS FIRST], false, 0
                     :                       :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :     +- ShuffleQueryStage 94
                     :                       :                 :        +- Exchange hashpartitioning(hd_income_band_sk#14499, 200), ENSURE_REQUIREMENTS, [id=#206498]
                     :                       :                 :           +- *(131) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
                     :                       :                 :              +- *(131) SortMergeJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner
                     :                       :                 :                 :- *(129) Sort [hd_income_band_sk#89 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :     +- ShuffleQueryStage 92
                     :                       :                 :                 :        +- Exchange hashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#206039]
                     :                       :                 :                 :           +- *(125) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
                     :                       :                 :                 :              +- *(125) SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#14503], Inner
                     :                       :                 :                 :                 :- *(123) Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :     +- ShuffleQueryStage 90
                     :                       :                 :                 :                 :        +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#205496]
                     :                       :                 :                 :                 :           +- *(119) Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71]
                     :                       :                 :                 :                 :              +- *(119) SortMergeJoin [ss_addr_sk#258], [ca_address_sk#62], Inner
                     :                       :                 :                 :                 :                 :- *(117) Sort [ss_addr_sk#258 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :     +- ShuffleQueryStage 88
                     :                       :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#204869]
                     :                       :                 :                 :                 :                 :           +- *(113) Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499]
                     :                       :                 :                 :                 :                 :              +- *(113) SortMergeJoin [c_current_hdemo_sk#403], [hd_demo_sk#14498], Inner
                     :                       :                 :                 :                 :                 :                 :- *(111) Sort [c_current_hdemo_sk#403 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 86
                     :                       :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#204158]
                     :                       :                 :                 :                 :                 :                 :           +- *(107) Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89]
                     :                       :                 :                 :                 :                 :                 :              +- *(107) SortMergeJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner
                     :                       :                 :                 :                 :                 :                 :                 :- *(105) Sort [ss_hdemo_sk#257 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 84
                     :                       :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#203363]
                     :                       :                 :                 :                 :                 :                 :                 :           +- *(101) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
                     :                       :                 :                 :                 :                 :                 :                 :              +- *(101) SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :- *(99) Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 82
                     :                       :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#202484]
                     :                       :                 :                 :                 :                 :                 :                 :                 :           +- *(95) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
                     :                       :                 :                 :                 :                 :                 :                 :                 :              +- *(95) SortMergeJoin [c_current_cdemo_sk#402], [cd_demo_sk#14489], Inner, NOT (cd_marital_status#224 = cd_marital_status#14491)
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :- *(93) Sort [c_current_cdemo_sk#402 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 80
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#201521]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(89) Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467, cd_marital_status#224]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(89) SortMergeJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(87) Sort [ss_cdemo_sk#256 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 78
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#200474]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(83) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(83) SortMergeJoin [c_first_shipto_date_sk#405], [d_date_sk#14461], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(81) Sort [c_first_shipto_date_sk#405 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 76
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#199343]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(77) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#14439]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(77) SortMergeJoin [c_first_sales_date_sk#406], [d_date_sk#14433], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(75) Sort [c_first_sales_date_sk#406 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 74
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#198128]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(71) Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(71) SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(69) Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 72
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#196829]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(65) Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(65) SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(63) Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 70
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#195929]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(59) Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(59) SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(57) Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 67
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#194468]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(53) Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(53) SortMergeJoin [ss_item_sk#254], [cs_item_sk#559], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(51) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 61
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#186484]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(41) Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(41) SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(39) Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- ShuffleQueryStage 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#182797]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- *(1) Filter ((((((((isnotnull(ss_item_sk#254) AND isnotnull(ss_ticket_number#261L)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_customer_sk#255)) AND isnotnull(ss_cdemo_sk#256)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_hdemo_sk#257)) AND isnotnull(ss_addr_sk#258))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(1) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(40) Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- ShuffleQueryStage 1
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#182814]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- *(2) Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(2) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(52) Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- *(52) Project [cs_item_sk#559]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- *(52) Filter (isnotnull(sale#14412) AND (cast(sale#14412 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14413)), DecimalType(21,2), true)))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- *(52) HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#14412, refund#14413])
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- ShuffleQueryStage 64
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#188126]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                      +- *(47) HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#14933L, sum#14934, isEmpty#14935])
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                         +- *(47) Project [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                            +- *(47) SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :- *(45) Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :     +- ShuffleQueryStage 2
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :        +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#182835]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :           +- *(3) Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_order_number#561L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :              +- *(3) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               :                 +- FileScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                               +- *(46) Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                  +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                     +- ShuffleQueryStage 3
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                        +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#182852]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                           +- *(4) Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                              +- *(4) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                                                 +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(58) Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 4
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#182881]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(5) Filter ((isnotnull(d_year#618) AND (d_year#618 = 2001)) AND isnotnull(d_date_sk#612))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(5) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(64) Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 5
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#182902]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(6) Filter ((isnotnull(s_store_sk#712) AND isnotnull(s_store_name#717)) AND isnotnull(s_zip#737))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(6) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(70) Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 6
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#182923]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(7) Filter (((((isnotnull(c_customer_sk#400) AND isnotnull(c_first_sales_date_sk#406)) AND isnotnull(c_first_shipto_date_sk#405)) AND isnotnull(c_current_cdemo_sk#402)) AND isnotnull(c_current_hdemo_sk#403)) AND isnotnull(c_current_addr_sk#404))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(7) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(76) Sort [d_date_sk#14433 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 7
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#14433, 200), ENSURE_REQUIREMENTS, [id=#182944]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(8) Filter isnotnull(d_date_sk#14433)
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(8) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#14433,d_year#14439] Batched: true, DataFilters: [isnotnull(d_date_sk#14433)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(82) Sort [d_date_sk#14461 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 9
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#14461, d_year#14467], Exchange hashpartitioning(d_date_sk#14433, 200), ENSURE_REQUIREMENTS, [id=#182944]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(88) Sort [cd_demo_sk#222 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 10
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#182988]
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(10) Filter (isnotnull(cd_demo_sk#222) AND isnotnull(cd_marital_status#224))
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(10) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                     :                       :                 :                 :                 :                 :                 :                 :                 :                 +- *(94) Sort [cd_demo_sk#14489 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 12
                     :                       :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#14489, cd_marital_status#14491], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#182988]
                     :                       :                 :                 :                 :                 :                 :                 :                 +- *(100) Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 13
                     :                       :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#183032]
                     :                       :                 :                 :                 :                 :                 :                 :                             +- *(12) Filter isnotnull(p_promo_sk#98)
                     :                       :                 :                 :                 :                 :                 :                 :                                +- *(12) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                     :                       :                 :                 :                 :                 :                 :                 +- *(106) Sort [hd_demo_sk#88 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 14
                     :                       :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#183053]
                     :                       :                 :                 :                 :                 :                 :                             +- *(13) Filter (isnotnull(hd_demo_sk#88) AND isnotnull(hd_income_band_sk#89))
                     :                       :                 :                 :                 :                 :                 :                                +- *(13) ColumnarToRow
                     :                       :                 :                 :                 :                 :                 :                                   +- FileScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                     :                       :                 :                 :                 :                 :                 +- *(112) Sort [hd_demo_sk#14498 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                 :                       +- ShuffleQueryStage 16
                     :                       :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#14498, hd_income_band_sk#14499], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#183053]
                     :                       :                 :                 :                 :                 +- *(118) Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                 :                       +- ShuffleQueryStage 17
                     :                       :                 :                 :                 :                          +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#183097]
                     :                       :                 :                 :                 :                             +- *(15) Filter isnotnull(ca_address_sk#62)
                     :                       :                 :                 :                 :                                +- *(15) ColumnarToRow
                     :                       :                 :                 :                 :                                   +- FileScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                     :                       :                 :                 :                 +- *(124) Sort [ca_address_sk#14503 ASC NULLS FIRST], false, 0
                     :                       :                 :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                 :                       +- ShuffleQueryStage 19
                     :                       :                 :                 :                          +- ReusedExchange [ca_address_sk#14503, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#183097]
                     :                       :                 :                 +- *(130) Sort [ib_income_band_sk#240 ASC NULLS FIRST], false, 0
                     :                       :                 :                    +- AQEShuffleRead coalesced
                     :                       :                 :                       +- ShuffleQueryStage 20
                     :                       :                 :                          +- Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#183141]
                     :                       :                 :                             +- *(17) Filter isnotnull(ib_income_band_sk#240)
                     :                       :                 :                                +- *(17) ColumnarToRow
                     :                       :                 :                                   +- FileScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                     :                       :                 +- *(139) Sort [ib_income_band_sk#14516 ASC NULLS FIRST], false, 0
                     :                       :                    +- AQEShuffleRead coalesced
                     :                       :                       +- ShuffleQueryStage 22
                     :                       :                          +- ReusedExchange [ib_income_band_sk#14516], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#183141]
                     :                       +- *(145) Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
                     :                          +- AQEShuffleRead coalesced
                     :                             +- ShuffleQueryStage 23
                     :                                +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#183187]
                     :                                   +- *(19) Project [i_item_sk#668, i_product_name#689]
                     :                                      +- *(19) Filter ((((((isnotnull(i_current_price#673) AND i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#673 >= 75.00)) AND (i_current_price#673 <= 85.00)) AND (i_current_price#673 >= 76.00)) AND (i_current_price#673 <= 90.00)) AND isnotnull(i_item_sk#668))
                     :                                         +- *(19) ColumnarToRow
                     :                                            +- FileScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
                     +- *(148) Sort [item_sk#14528 ASC NULLS FIRST, store_name#14529 ASC NULLS FIRST, store_zip#14530 ASC NULLS FIRST], false, 0
                        +- AQEShuffleRead coalesced
                           +- ShuffleQueryStage 98
                              +- Exchange hashpartitioning(item_sk#14528, store_name#14529, store_zip#14530, 200), ENSURE_REQUIREMENTS, [id=#207168]
                                 +- *(143) HashAggregate(keys=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#14578)), sum(UnscaledValue(ss_list_price#14579)), sum(UnscaledValue(ss_coupon_amt#14586))], output=[item_sk#14528, store_name#14529, store_zip#14530, syear#14539, cnt#14542L, s1#14543, s2#14544, s3#14545])
                                    +- *(143) HashAggregate(keys=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#14578)), partial_sum(UnscaledValue(ss_list_price#14579)), partial_sum(UnscaledValue(ss_coupon_amt#14586))], output=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733, count#14926L, sum#14939L, sum#14940L, sum#14941L])
                                       +- *(143) Project [ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, d_year#14705, d_year#14733, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, i_item_sk#14881, i_product_name#14902]
                                          +- *(143) SortMergeJoin [ss_item_sk#14569], [i_item_sk#14881], Inner
                                             :- *(141) Sort [ss_item_sk#14569 ASC NULLS FIRST], false, 0
                                             :  +- AQEShuffleRead coalesced
                                             :     +- ShuffleQueryStage 96
                                             :        +- Exchange hashpartitioning(ss_item_sk#14569, 200), ENSURE_REQUIREMENTS, [id=#206873]
                                             :           +- *(137) Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                             :              +- *(137) SortMergeJoin [hd_income_band_sk#14845], [ib_income_band_sk#14878], Inner
                                             :                 :- *(135) Sort [hd_income_band_sk#14845 ASC NULLS FIRST], false, 0
                                             :                 :  +- AQEShuffleRead coalesced
                                             :                 :     +- ShuffleQueryStage 95
                                             :                 :        +- Exchange hashpartitioning(hd_income_band_sk#14845, 200), ENSURE_REQUIREMENTS, [id=#206693]
                                             :                 :           +- *(134) Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                             :                 :              +- *(134) SortMergeJoin [hd_income_band_sk#14840], [ib_income_band_sk#14875], Inner
                                             :                 :                 :- *(132) Sort [hd_income_band_sk#14840 ASC NULLS FIRST], false, 0
                                             :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :     +- ShuffleQueryStage 93
                                             :                 :                 :        +- Exchange hashpartitioning(hd_income_band_sk#14840, 200), ENSURE_REQUIREMENTS, [id=#206276]
                                             :                 :                 :           +- *(128) Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                             :                 :                 :              +- *(128) SortMergeJoin [c_current_addr_sk#14788], [ca_address_sk#14862], Inner
                                             :                 :                 :                 :- *(126) Sort [c_current_addr_sk#14788 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :     +- ShuffleQueryStage 91
                                             :                 :                 :                 :        +- Exchange hashpartitioning(c_current_addr_sk#14788, 200), ENSURE_REQUIREMENTS, [id=#205775]
                                             :                 :                 :                 :           +- *(122) Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858]
                                             :                 :                 :                 :              +- *(122) SortMergeJoin [ss_addr_sk#14573], [ca_address_sk#14849], Inner
                                             :                 :                 :                 :                 :- *(120) Sort [ss_addr_sk#14573 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :     +- ShuffleQueryStage 89
                                             :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_addr_sk#14573, 200), ENSURE_REQUIREMENTS, [id=#205190]
                                             :                 :                 :                 :                 :           +- *(116) Project [ss_item_sk#14569, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845]
                                             :                 :                 :                 :                 :              +- *(116) SortMergeJoin [c_current_hdemo_sk#14787], [hd_demo_sk#14844], Inner
                                             :                 :                 :                 :                 :                 :- *(114) Sort [c_current_hdemo_sk#14787 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 87
                                             :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_hdemo_sk#14787, 200), ENSURE_REQUIREMENTS, [id=#204521]
                                             :                 :                 :                 :                 :                 :           +- *(110) Project [ss_item_sk#14569, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840]
                                             :                 :                 :                 :                 :                 :              +- *(110) SortMergeJoin [ss_hdemo_sk#14572], [hd_demo_sk#14839], Inner
                                             :                 :                 :                 :                 :                 :                 :- *(108) Sort [ss_hdemo_sk#14572 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 85
                                             :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_hdemo_sk#14572, 200), ENSURE_REQUIREMENTS, [id=#203768]
                                             :                 :                 :                 :                 :                 :                 :           +- *(104) Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                             :                 :                 :                 :                 :                 :                 :              +- *(104) SortMergeJoin [ss_promo_sk#14575], [p_promo_sk#14820], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :- *(102) Sort [ss_promo_sk#14575 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 83
                                             :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_promo_sk#14575, 200), ENSURE_REQUIREMENTS, [id=#202931]
                                             :                 :                 :                 :                 :                 :                 :                 :           +- *(98) Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                             :                 :                 :                 :                 :                 :                 :                 :              +- *(98) SortMergeJoin [c_current_cdemo_sk#14786], [cd_demo_sk#14811], Inner, NOT (cd_marital_status#14804 = cd_marital_status#14813)
                                             :                 :                 :                 :                 :                 :                 :                 :                 :- *(96) Sort [c_current_cdemo_sk#14786 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 81
                                             :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_current_cdemo_sk#14786, 200), ENSURE_REQUIREMENTS, [id=#202010]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(92) Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733, cd_marital_status#14804]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(92) SortMergeJoin [ss_cdemo_sk#14571], [cd_demo_sk#14802], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(90) Sort [ss_cdemo_sk#14571 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 79
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_cdemo_sk#14571, 200), ENSURE_REQUIREMENTS, [id=#201005]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(86) Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(86) SortMergeJoin [c_first_shipto_date_sk#14789], [d_date_sk#14727], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(84) Sort [c_first_shipto_date_sk#14789 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 77
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_shipto_date_sk#14789, 200), ENSURE_REQUIREMENTS, [id=#199916]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(80) Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, c_first_shipto_date_sk#14789, d_year#14705]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(80) SortMergeJoin [c_first_sales_date_sk#14790], [d_date_sk#14699], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(78) Sort [c_first_sales_date_sk#14790 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 75
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(c_first_sales_date_sk#14790, 200), ENSURE_REQUIREMENTS, [id=#198743]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(74) Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, c_first_shipto_date_sk#14789, c_first_sales_date_sk#14790]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(74) SortMergeJoin [ss_customer_sk#14570], [c_customer_sk#14784], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(72) Sort [ss_customer_sk#14570 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 73
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_customer_sk#14570, 200), ENSURE_REQUIREMENTS, [id=#197486]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(68) Project [ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(68) SortMergeJoin [ss_store_sk#14574], [s_store_sk#14755], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(66) Sort [ss_store_sk#14574 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 71
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- Exchange hashpartitioning(ss_store_sk#14574, 200), ENSURE_REQUIREMENTS, [id=#196027]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :           +- *(62) Project [ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_store_sk#14574, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :              +- *(62) SortMergeJoin [ss_sold_date_sk#14567], [d_date_sk#14671], Inner
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :- *(60) Sort [ss_sold_date_sk#14567 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :  +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :     +- ShuffleQueryStage 69
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :        +- ReusedExchange [ss_sold_date_sk#14567, ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_store_sk#14574, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586], Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#194468]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(61) Sort [d_date_sk#14671 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 32
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- Exchange hashpartitioning(d_date_sk#14671, 200), ENSURE_REQUIREMENTS, [id=#183304]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                             +- *(24) Filter ((isnotnull(d_year#14677) AND (d_year#14677 = 2002)) AND isnotnull(d_date_sk#14671))
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                +- *(24) ColumnarToRow
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                                   +- FileScan parquet [d_date_sk#14671,d_year#14677] Batched: true, DataFilters: [isnotnull(d_year#14677), (d_year#14677 = 2002), isnotnull(d_date_sk#14671)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(67) Sort [s_store_sk#14755 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 34
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [s_store_sk#14755, s_store_name#14760, s_zip#14780], Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#182902]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(73) Sort [c_customer_sk#14784 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 36
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [c_customer_sk#14784, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, c_first_shipto_date_sk#14789, c_first_sales_date_sk#14790], Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#182923]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(79) Sort [d_date_sk#14699 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 38
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#14699, d_year#14705], Exchange hashpartitioning(d_date_sk#14433, 200), ENSURE_REQUIREMENTS, [id=#182944]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(85) Sort [d_date_sk#14727 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 40
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [d_date_sk#14727, d_year#14733], Exchange hashpartitioning(d_date_sk#14433, 200), ENSURE_REQUIREMENTS, [id=#182944]
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                 +- *(91) Sort [cd_demo_sk#14802 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 42
                                             :                 :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#14802, cd_marital_status#14804], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#182988]
                                             :                 :                 :                 :                 :                 :                 :                 :                 +- *(97) Sort [cd_demo_sk#14811 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 44
                                             :                 :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [cd_demo_sk#14811, cd_marital_status#14813], Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#182988]
                                             :                 :                 :                 :                 :                 :                 :                 +- *(103) Sort [p_promo_sk#14820 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 46
                                             :                 :                 :                 :                 :                 :                 :                          +- ReusedExchange [p_promo_sk#14820], Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#183032]
                                             :                 :                 :                 :                 :                 :                 +- *(109) Sort [hd_demo_sk#14839 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                 :                       +- ShuffleQueryStage 48
                                             :                 :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#14839, hd_income_band_sk#14840], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#183053]
                                             :                 :                 :                 :                 :                 +- *(115) Sort [hd_demo_sk#14844 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                 :                       +- ShuffleQueryStage 50
                                             :                 :                 :                 :                 :                          +- ReusedExchange [hd_demo_sk#14844, hd_income_band_sk#14845], Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#183053]
                                             :                 :                 :                 :                 +- *(121) Sort [ca_address_sk#14849 ASC NULLS FIRST], false, 0
                                             :                 :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                 :                       +- ShuffleQueryStage 52
                                             :                 :                 :                 :                          +- ReusedExchange [ca_address_sk#14849, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#183097]
                                             :                 :                 :                 +- *(127) Sort [ca_address_sk#14862 ASC NULLS FIRST], false, 0
                                             :                 :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                 :                       +- ShuffleQueryStage 54
                                             :                 :                 :                          +- ReusedExchange [ca_address_sk#14862, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871], Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#183097]
                                             :                 :                 +- *(133) Sort [ib_income_band_sk#14875 ASC NULLS FIRST], false, 0
                                             :                 :                    +- AQEShuffleRead coalesced
                                             :                 :                       +- ShuffleQueryStage 56
                                             :                 :                          +- ReusedExchange [ib_income_band_sk#14875], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#183141]
                                             :                 +- *(136) Sort [ib_income_band_sk#14878 ASC NULLS FIRST], false, 0
                                             :                    +- AQEShuffleRead coalesced
                                             :                       +- ShuffleQueryStage 58
                                             :                          +- ReusedExchange [ib_income_band_sk#14878], Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#183141]
                                             +- *(142) Sort [i_item_sk#14881 ASC NULLS FIRST], false, 0
                                                +- AQEShuffleRead coalesced
                                                   +- ShuffleQueryStage 60
                                                      +- ReusedExchange [i_item_sk#14881, i_product_name#14902], Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#183187]
+- == Initial Plan ==
   Project [product_name#14414, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s11#14406, s21#14407, s31#14408, s12#14409, s22#14410, s32#14411, syear#14539, cnt#14542L]
   +- Sort [product_name#14414 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, cnt#14542L ASC NULLS FIRST, s1#14430 ASC NULLS FIRST, s1#14543 ASC NULLS FIRST], true, 0
      +- Exchange rangepartitioning(product_name#14414 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, cnt#14542L ASC NULLS FIRST, s1#14430 ASC NULLS FIRST, s1#14543 ASC NULLS FIRST, 200), ENSURE_REQUIREMENTS, [id=#182199]
         +- Project [product_name#14414, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s1#14430 AS s11#14406, s2#14431 AS s21#14407, s3#14432 AS s31#14408, s1#14543 AS s12#14409, s2#14544 AS s22#14410, s3#14545 AS s32#14411, syear#14539, cnt#14542L, s1#14430, s1#14543]
            +- SortMergeJoin [item_sk#14415, store_name#14416, store_zip#14417], [item_sk#14528, store_name#14529, store_zip#14530], Inner, (cnt#14542L <= cnt#14429L)
               :- Sort [item_sk#14415 ASC NULLS FIRST, store_name#14416 ASC NULLS FIRST, store_zip#14417 ASC NULLS FIRST], false, 0
               :  +- Exchange hashpartitioning(item_sk#14415, store_name#14416, store_zip#14417, 200), ENSURE_REQUIREMENTS, [id=#182192]
               :     +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#263)), sum(UnscaledValue(ss_list_price#264)), sum(UnscaledValue(ss_coupon_amt#271))], output=[product_name#14414, item_sk#14415, store_name#14416, store_zip#14417, b_street_number#14418, b_street_name#14419, b_city#14420, b_zip#14421, c_street_number#14422, c_street_name#14423, c_city#14424, c_zip#14425, syear#14426, cnt#14429L, s1#14430, s2#14431, s3#14432])
               :        +- HashAggregate(keys=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#263)), partial_sum(UnscaledValue(ss_list_price#264)), partial_sum(UnscaledValue(ss_coupon_amt#271))], output=[i_product_name#689, i_item_sk#668, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, d_year#618, d_year#14439, d_year#14467, count#14926L, sum#14927L, sum#14928L, sum#14929L])
               :           +- Project [ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, d_year#14439, d_year#14467, s_store_name#717, s_zip#737, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512, i_item_sk#668, i_product_name#689]
               :              +- SortMergeJoin [ss_item_sk#254], [i_item_sk#668], Inner
               :                 :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#182033]
               :                 :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
               :                 :        +- SortMergeJoin [hd_income_band_sk#14499], [ib_income_band_sk#14516], Inner
               :                 :           :- Sort [hd_income_band_sk#14499 ASC NULLS FIRST], false, 0
               :                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#14499, 200), ENSURE_REQUIREMENTS, [id=#182025]
               :                 :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
               :                 :           :        +- SortMergeJoin [hd_income_band_sk#89], [ib_income_band_sk#240], Inner
               :                 :           :           :- Sort [hd_income_band_sk#89 ASC NULLS FIRST], false, 0
               :                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#89, 200), ENSURE_REQUIREMENTS, [id=#182017]
               :                 :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71, ca_street_number#14505, ca_street_name#14506, ca_city#14509, ca_zip#14512]
               :                 :           :           :        +- SortMergeJoin [c_current_addr_sk#404], [ca_address_sk#14503], Inner
               :                 :           :           :           :- Sort [c_current_addr_sk#404 ASC NULLS FIRST], false, 0
               :                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#404, 200), ENSURE_REQUIREMENTS, [id=#182009]
               :                 :           :           :           :     +- Project [ss_item_sk#254, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499, ca_street_number#64, ca_street_name#65, ca_city#68, ca_zip#71]
               :                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#258], [ca_address_sk#62], Inner
               :                 :           :           :           :           :- Sort [ss_addr_sk#258 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#258, 200), ENSURE_REQUIREMENTS, [id=#182001]
               :                 :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89, hd_income_band_sk#14499]
               :                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#403], [hd_demo_sk#14498], Inner
               :                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#403 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#403, 200), ENSURE_REQUIREMENTS, [id=#181993]
               :                 :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467, hd_income_band_sk#89]
               :                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#257], [hd_demo_sk#88], Inner
               :                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#257 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#257, 200), ENSURE_REQUIREMENTS, [id=#181985]
               :                 :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
               :                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#260], [p_promo_sk#98], Inner
               :                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#260 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#260, 200), ENSURE_REQUIREMENTS, [id=#181977]
               :                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
               :                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#402], [cd_demo_sk#14489], Inner, NOT (cd_marital_status#224 = cd_marital_status#14491)
               :                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#402 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#402, 200), ENSURE_REQUIREMENTS, [id=#181969]
               :                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467, cd_marital_status#224]
               :                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#256], [cd_demo_sk#222], Inner
               :                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#256 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#256, 200), ENSURE_REQUIREMENTS, [id=#181961]
               :                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, d_year#14439, d_year#14467]
               :                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#405], [d_date_sk#14461], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#405 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#405, 200), ENSURE_REQUIREMENTS, [id=#181953]
               :                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, d_year#14439]
               :                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#406], [d_date_sk#14433], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#406 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#406, 200), ENSURE_REQUIREMENTS, [id=#181945]
               :                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737, c_current_cdemo_sk#402, c_current_hdemo_sk#403, c_current_addr_sk#404, c_first_shipto_date_sk#405, c_first_sales_date_sk#406]
               :                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#255], [c_customer_sk#400], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#255 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#255, 200), ENSURE_REQUIREMENTS, [id=#181937]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618, s_store_name#717, s_zip#737]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#259], [s_store_sk#712], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#259 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#259, 200), ENSURE_REQUIREMENTS, [id=#181929]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271, d_year#618]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#181921]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254], [cs_item_sk#559], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#181914]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#252, ss_item_sk#254, ss_customer_sk#255, ss_cdemo_sk#256, ss_hdemo_sk#257, ss_addr_sk#258, ss_store_sk#259, ss_promo_sk#260, ss_wholesale_cost#263, ss_list_price#264, ss_coupon_amt#271]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#254, ss_ticket_number#261L], [sr_item_sk#138, sr_ticket_number#145L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#254 ASC NULLS FIRST, ss_ticket_number#261L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#254, ss_ticket_number#261L, 200), ENSURE_REQUIREMENTS, [id=#181893]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#254) AND isnotnull(ss_ticket_number#261L)) AND isnotnull(ss_sold_date_sk#252)) AND isnotnull(ss_store_sk#259)) AND isnotnull(ss_customer_sk#255)) AND isnotnull(ss_cdemo_sk#256)) AND isnotnull(ss_promo_sk#260)) AND isnotnull(ss_hdemo_sk#257)) AND isnotnull(ss_addr_sk#258))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254,ss_customer_sk#255,ss_cdemo_sk#256,ss_hdemo_sk#257,ss_addr_sk#258,ss_store_sk#259,ss_promo_sk#260,ss_ticket_number#261L,ss_wholesale_cost#263,ss_list_price#264,ss_coupon_amt#271] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_ticket_number#261L), isnotnull(ss_sold_date_sk#252), isn..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#138 ASC NULLS FIRST, sr_ticket_number#145L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#138, sr_ticket_number#145L, 200), ENSURE_REQUIREMENTS, [id=#181894]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_ticket_number#145L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#138,sr_ticket_number#145L] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_ticket_number#145L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#559]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#14412) AND (cast(sale#14412 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14413)), DecimalType(21,2), true)))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#559], functions=[sum(UnscaledValue(cs_ext_list_price#569)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sale#14412, refund#14413])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#181908]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#559], functions=[partial_sum(UnscaledValue(cs_ext_list_price#569)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#369 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#370 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#371 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#559, sum#14933L, sum#14934, isEmpty#14935])
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#559, cs_ext_list_price#569, cr_refunded_cash#369, cr_reversed_charge#370, cr_store_credit#371]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#559, cs_order_number#561L], [cr_item_sk#348, cr_order_number#362L], Inner
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#559 ASC NULLS FIRST, cs_order_number#561L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#559, cs_order_number#561L, 200), ENSURE_REQUIREMENTS, [id=#181900]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_order_number#561L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#559,cs_order_number#561L,cs_ext_list_price#569] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_order_number#561L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#348 ASC NULLS FIRST, cr_order_number#362L ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#348, cr_order_number#362L, 200), ENSURE_REQUIREMENTS, [id=#181901]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_order_number#362L))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#348,cr_order_number#362L,cr_refunded_cash#369,cr_reversed_charge#370,cr_store_credit#371] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_order_number#362L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#181922]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2001)) AND isnotnull(d_date_sk#612))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 = 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2001), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#712 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#712, 200), ENSURE_REQUIREMENTS, [id=#181930]
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#712) AND isnotnull(s_store_name#717)) AND isnotnull(s_zip#737))
               :                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#712,s_store_name#717,s_zip#737] Batched: true, DataFilters: [isnotnull(s_store_sk#712), isnotnull(s_store_name#717), isnotnull(s_zip#737)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
               :                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#400 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#400, 200), ENSURE_REQUIREMENTS, [id=#181938]
               :                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#400) AND isnotnull(c_first_sales_date_sk#406)) AND isnotnull(c_first_shipto_date_sk#405)) AND isnotnull(c_current_cdemo_sk#402)) AND isnotnull(c_current_hdemo_sk#403)) AND isnotnull(c_current_addr_sk#404))
               :                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#400,c_current_cdemo_sk#402,c_current_hdemo_sk#403,c_current_addr_sk#404,c_first_shipto_date_sk#405,c_first_sales_date_sk#406] Batched: true, DataFilters: [isnotnull(c_customer_sk#400), isnotnull(c_first_sales_date_sk#406), isnotnull(c_first_shipto_dat..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
               :                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#14433 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#14433, 200), ENSURE_REQUIREMENTS, [id=#181946]
               :                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#14433)
               :                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#14433,d_year#14439] Batched: true, DataFilters: [isnotnull(d_date_sk#14433)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#14461 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#14461, 200), ENSURE_REQUIREMENTS, [id=#181954]
               :                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#14461)
               :                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#14461,d_year#14467] Batched: true, DataFilters: [isnotnull(d_date_sk#14461)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
               :                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#222 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#222, 200), ENSURE_REQUIREMENTS, [id=#181962]
               :                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#222) AND isnotnull(cd_marital_status#224))
               :                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#222,cd_marital_status#224] Batched: true, DataFilters: [isnotnull(cd_demo_sk#222), isnotnull(cd_marital_status#224)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#14489 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#14489, 200), ENSURE_REQUIREMENTS, [id=#181970]
               :                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#14489) AND isnotnull(cd_marital_status#14491))
               :                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#14489,cd_marital_status#14491] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14489), isnotnull(cd_marital_status#14491)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
               :                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#98 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#98, 200), ENSURE_REQUIREMENTS, [id=#181978]
               :                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#98)
               :                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#98] Batched: true, DataFilters: [isnotnull(p_promo_sk#98)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
               :                 :           :           :           :           :           :           +- Sort [hd_demo_sk#88 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#88, 200), ENSURE_REQUIREMENTS, [id=#181986]
               :                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#88) AND isnotnull(hd_income_band_sk#89))
               :                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#88,hd_income_band_sk#89] Batched: true, DataFilters: [isnotnull(hd_demo_sk#88), isnotnull(hd_income_band_sk#89)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           :           +- Sort [hd_demo_sk#14498 ASC NULLS FIRST], false, 0
               :                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#14498, 200), ENSURE_REQUIREMENTS, [id=#181994]
               :                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#14498) AND isnotnull(hd_income_band_sk#14499))
               :                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#14498,hd_income_band_sk#14499] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14498), isnotnull(hd_income_band_sk#14499)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
               :                 :           :           :           :           +- Sort [ca_address_sk#62 ASC NULLS FIRST], false, 0
               :                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#62, 200), ENSURE_REQUIREMENTS, [id=#182002]
               :                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#62)
               :                 :           :           :           :                    +- FileScan parquet [ca_address_sk#62,ca_street_number#64,ca_street_name#65,ca_city#68,ca_zip#71] Batched: true, DataFilters: [isnotnull(ca_address_sk#62)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           :           +- Sort [ca_address_sk#14503 ASC NULLS FIRST], false, 0
               :                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#14503, 200), ENSURE_REQUIREMENTS, [id=#182010]
               :                 :           :           :                 +- Filter isnotnull(ca_address_sk#14503)
               :                 :           :           :                    +- FileScan parquet [ca_address_sk#14503,ca_street_number#14505,ca_street_name#14506,ca_city#14509,ca_zip#14512] Batched: true, DataFilters: [isnotnull(ca_address_sk#14503)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
               :                 :           :           +- Sort [ib_income_band_sk#240 ASC NULLS FIRST], false, 0
               :                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#240, 200), ENSURE_REQUIREMENTS, [id=#182018]
               :                 :           :                 +- Filter isnotnull(ib_income_band_sk#240)
               :                 :           :                    +- FileScan parquet [ib_income_band_sk#240] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#240)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 :           +- Sort [ib_income_band_sk#14516 ASC NULLS FIRST], false, 0
               :                 :              +- Exchange hashpartitioning(ib_income_band_sk#14516, 200), ENSURE_REQUIREMENTS, [id=#182026]
               :                 :                 +- Filter isnotnull(ib_income_band_sk#14516)
               :                 :                    +- FileScan parquet [ib_income_band_sk#14516] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14516)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
               :                 +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
               :                    +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#182034]
               :                       +- Project [i_item_sk#668, i_product_name#689]
               :                          +- Filter ((((((isnotnull(i_current_price#673) AND i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#673 >= 75.00)) AND (i_current_price#673 <= 85.00)) AND (i_current_price#673 >= 76.00)) AND (i_current_price#673 <= 90.00)) AND isnotnull(i_item_sk#668))
               :                             +- FileScan parquet [i_item_sk#668,i_current_price#673,i_color#685,i_product_name#689] Batched: true, DataFilters: [isnotnull(i_current_price#673), i_color#685 IN (chocolate,lime,sienna,drab,goldenrod,navajo), (i..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
               +- Sort [item_sk#14528 ASC NULLS FIRST, store_name#14529 ASC NULLS FIRST, store_zip#14530 ASC NULLS FIRST], false, 0
                  +- Exchange hashpartitioning(item_sk#14528, store_name#14529, store_zip#14530, 200), ENSURE_REQUIREMENTS, [id=#182193]
                     +- HashAggregate(keys=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733], functions=[count(1), sum(UnscaledValue(ss_wholesale_cost#14578)), sum(UnscaledValue(ss_list_price#14579)), sum(UnscaledValue(ss_coupon_amt#14586))], output=[item_sk#14528, store_name#14529, store_zip#14530, syear#14539, cnt#14542L, s1#14543, s2#14544, s3#14545])
                        +- HashAggregate(keys=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733], functions=[partial_count(1), partial_sum(UnscaledValue(ss_wholesale_cost#14578)), partial_sum(UnscaledValue(ss_list_price#14579)), partial_sum(UnscaledValue(ss_coupon_amt#14586))], output=[i_product_name#14902, i_item_sk#14881, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, d_year#14677, d_year#14705, d_year#14733, count#14926L, sum#14939L, sum#14940L, sum#14941L])
                           +- Project [ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, d_year#14705, d_year#14733, s_store_name#14760, s_zip#14780, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871, i_item_sk#14881, i_product_name#14902]
                              +- SortMergeJoin [ss_item_sk#14569], [i_item_sk#14881], Inner
                                 :- Sort [ss_item_sk#14569 ASC NULLS FIRST], false, 0
                                 :  +- Exchange hashpartitioning(ss_item_sk#14569, 200), ENSURE_REQUIREMENTS, [id=#182182]
                                 :     +- Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                 :        +- SortMergeJoin [hd_income_band_sk#14845], [ib_income_band_sk#14878], Inner
                                 :           :- Sort [hd_income_band_sk#14845 ASC NULLS FIRST], false, 0
                                 :           :  +- Exchange hashpartitioning(hd_income_band_sk#14845, 200), ENSURE_REQUIREMENTS, [id=#182174]
                                 :           :     +- Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                 :           :        +- SortMergeJoin [hd_income_band_sk#14840], [ib_income_band_sk#14875], Inner
                                 :           :           :- Sort [hd_income_band_sk#14840 ASC NULLS FIRST], false, 0
                                 :           :           :  +- Exchange hashpartitioning(hd_income_band_sk#14840, 200), ENSURE_REQUIREMENTS, [id=#182166]
                                 :           :           :     +- Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858, ca_street_number#14864, ca_street_name#14865, ca_city#14868, ca_zip#14871]
                                 :           :           :        +- SortMergeJoin [c_current_addr_sk#14788], [ca_address_sk#14862], Inner
                                 :           :           :           :- Sort [c_current_addr_sk#14788 ASC NULLS FIRST], false, 0
                                 :           :           :           :  +- Exchange hashpartitioning(c_current_addr_sk#14788, 200), ENSURE_REQUIREMENTS, [id=#182158]
                                 :           :           :           :     +- Project [ss_item_sk#14569, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845, ca_street_number#14851, ca_street_name#14852, ca_city#14855, ca_zip#14858]
                                 :           :           :           :        +- SortMergeJoin [ss_addr_sk#14573], [ca_address_sk#14849], Inner
                                 :           :           :           :           :- Sort [ss_addr_sk#14573 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :  +- Exchange hashpartitioning(ss_addr_sk#14573, 200), ENSURE_REQUIREMENTS, [id=#182150]
                                 :           :           :           :           :     +- Project [ss_item_sk#14569, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840, hd_income_band_sk#14845]
                                 :           :           :           :           :        +- SortMergeJoin [c_current_hdemo_sk#14787], [hd_demo_sk#14844], Inner
                                 :           :           :           :           :           :- Sort [c_current_hdemo_sk#14787 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_hdemo_sk#14787, 200), ENSURE_REQUIREMENTS, [id=#182142]
                                 :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733, hd_income_band_sk#14840]
                                 :           :           :           :           :           :        +- SortMergeJoin [ss_hdemo_sk#14572], [hd_demo_sk#14839], Inner
                                 :           :           :           :           :           :           :- Sort [ss_hdemo_sk#14572 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_hdemo_sk#14572, 200), ENSURE_REQUIREMENTS, [id=#182134]
                                 :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                 :           :           :           :           :           :           :        +- SortMergeJoin [ss_promo_sk#14575], [p_promo_sk#14820], Inner
                                 :           :           :           :           :           :           :           :- Sort [ss_promo_sk#14575 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_promo_sk#14575, 200), ENSURE_REQUIREMENTS, [id=#182126]
                                 :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                 :           :           :           :           :           :           :           :        +- SortMergeJoin [c_current_cdemo_sk#14786], [cd_demo_sk#14811], Inner, NOT (cd_marital_status#14804 = cd_marital_status#14813)
                                 :           :           :           :           :           :           :           :           :- Sort [c_current_cdemo_sk#14786 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_current_cdemo_sk#14786, 200), ENSURE_REQUIREMENTS, [id=#182118]
                                 :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733, cd_marital_status#14804]
                                 :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_cdemo_sk#14571], [cd_demo_sk#14802], Inner
                                 :           :           :           :           :           :           :           :           :           :- Sort [ss_cdemo_sk#14571 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_cdemo_sk#14571, 200), ENSURE_REQUIREMENTS, [id=#182110]
                                 :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, d_year#14705, d_year#14733]
                                 :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_shipto_date_sk#14789], [d_date_sk#14727], Inner
                                 :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_shipto_date_sk#14789 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_shipto_date_sk#14789, 200), ENSURE_REQUIREMENTS, [id=#182102]
                                 :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, c_first_shipto_date_sk#14789, d_year#14705]
                                 :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [c_first_sales_date_sk#14790], [d_date_sk#14699], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :- Sort [c_first_sales_date_sk#14790 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(c_first_sales_date_sk#14790, 200), ENSURE_REQUIREMENTS, [id=#182094]
                                 :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780, c_current_cdemo_sk#14786, c_current_hdemo_sk#14787, c_current_addr_sk#14788, c_first_shipto_date_sk#14789, c_first_sales_date_sk#14790]
                                 :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_customer_sk#14570], [c_customer_sk#14784], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_customer_sk#14570 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_customer_sk#14570, 200), ENSURE_REQUIREMENTS, [id=#182086]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677, s_store_name#14760, s_zip#14780]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_store_sk#14574], [s_store_sk#14755], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_store_sk#14574 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_store_sk#14574, 200), ENSURE_REQUIREMENTS, [id=#182078]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_store_sk#14574, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586, d_year#14677]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_sold_date_sk#14567], [d_date_sk#14671], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_sold_date_sk#14567 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_sold_date_sk#14567, 200), ENSURE_REQUIREMENTS, [id=#182070]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#14567, ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_store_sk#14574, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#14569], [cs_item_sk#14625], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#14569 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#14569, 200), ENSURE_REQUIREMENTS, [id=#182063]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Project [ss_sold_date_sk#14567, ss_item_sk#14569, ss_customer_sk#14570, ss_cdemo_sk#14571, ss_hdemo_sk#14572, ss_addr_sk#14573, ss_store_sk#14574, ss_promo_sk#14575, ss_wholesale_cost#14578, ss_list_price#14579, ss_coupon_amt#14586]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- SortMergeJoin [ss_item_sk#14569, ss_ticket_number#14576L], [sr_item_sk#14592, sr_ticket_number#14599L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :- Sort [ss_item_sk#14569 ASC NULLS FIRST, ss_ticket_number#14576L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :  +- Exchange hashpartitioning(ss_item_sk#14569, ss_ticket_number#14576L, 200), ENSURE_REQUIREMENTS, [id=#182042]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :     +- Filter ((((((((isnotnull(ss_item_sk#14569) AND isnotnull(ss_ticket_number#14576L)) AND isnotnull(ss_sold_date_sk#14567)) AND isnotnull(ss_store_sk#14574)) AND isnotnull(ss_customer_sk#14570)) AND isnotnull(ss_cdemo_sk#14571)) AND isnotnull(ss_promo_sk#14575)) AND isnotnull(ss_hdemo_sk#14572)) AND isnotnull(ss_addr_sk#14573))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :        +- FileScan parquet [ss_sold_date_sk#14567,ss_item_sk#14569,ss_customer_sk#14570,ss_cdemo_sk#14571,ss_hdemo_sk#14572,ss_addr_sk#14573,ss_store_sk#14574,ss_promo_sk#14575,ss_ticket_number#14576L,ss_wholesale_cost#14578,ss_list_price#14579,ss_coupon_amt#14586] Batched: true, DataFilters: [isnotnull(ss_item_sk#14569), isnotnull(ss_ticket_number#14576L), isnotnull(ss_sold_date_sk#14567..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_ticket_number), IsNotNull(ss_sold_date_sk), IsNotNull(ss_sto..., ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_customer_sk:int,ss_cdemo_sk:int,ss_hdemo_sk:int,ss_a...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [sr_item_sk#14592 ASC NULLS FIRST, sr_ticket_number#14599L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(sr_item_sk#14592, sr_ticket_number#14599L, 200), ENSURE_REQUIREMENTS, [id=#182043]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sr_item_sk#14592) AND isnotnull(sr_ticket_number#14599L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [sr_item_sk#14592,sr_ticket_number#14599L] Batched: true, DataFilters: [isnotnull(sr_item_sk#14592), isnotnull(sr_ticket_number#14599L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_ticket_number)], ReadSchema: struct<sr_item_sk:int,sr_ticket_number:bigint>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [cs_item_sk#14625 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Project [cs_item_sk#14625]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(sale#14412) AND (cast(sale#14412 as decimal(21,2)) > CheckOverflow((2.00 * promote_precision(refund#14413)), DecimalType(21,2), true)))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- HashAggregate(keys=[cs_item_sk#14625], functions=[sum(UnscaledValue(cs_ext_list_price#14635)), sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#14667 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#14668 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#14669 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14625, sale#14412, refund#14413])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                       +- Exchange hashpartitioning(cs_item_sk#14625, 200), ENSURE_REQUIREMENTS, [id=#182057]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                          +- HashAggregate(keys=[cs_item_sk#14625], functions=[partial_sum(UnscaledValue(cs_ext_list_price#14635)), partial_sum(CheckOverflow((promote_precision(cast(CheckOverflow((promote_precision(cast(cr_refunded_cash#14667 as decimal(8,2))) + promote_precision(cast(cr_reversed_charge#14668 as decimal(8,2)))), DecimalType(8,2), true) as decimal(9,2))) + promote_precision(cast(cr_store_credit#14669 as decimal(9,2)))), DecimalType(9,2), true))], output=[cs_item_sk#14625, sum#14945L, sum#14946, isEmpty#14947])
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                             +- Project [cs_item_sk#14625, cs_ext_list_price#14635, cr_refunded_cash#14667, cr_reversed_charge#14668, cr_store_credit#14669]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                +- SortMergeJoin [cs_item_sk#14625, cs_order_number#14627L], [cr_item_sk#14646, cr_order_number#14660L], Inner
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :- Sort [cs_item_sk#14625 ASC NULLS FIRST, cs_order_number#14627L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :  +- Exchange hashpartitioning(cs_item_sk#14625, cs_order_number#14627L, 200), ENSURE_REQUIREMENTS, [id=#182049]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :     +- Filter (isnotnull(cs_item_sk#14625) AND isnotnull(cs_order_number#14627L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   :        +- FileScan parquet [cs_item_sk#14625,cs_order_number#14627L,cs_ext_list_price#14635] Batched: true, DataFilters: [isnotnull(cs_item_sk#14625), isnotnull(cs_order_number#14627L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_order_number)], ReadSchema: struct<cs_item_sk:int,cs_order_number:bigint,cs_ext_list_price:decimal(7,2)>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                   +- Sort [cr_item_sk#14646 ASC NULLS FIRST, cr_order_number#14660L ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                      +- Exchange hashpartitioning(cr_item_sk#14646, cr_order_number#14660L, 200), ENSURE_REQUIREMENTS, [id=#182050]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                         +- Filter (isnotnull(cr_item_sk#14646) AND isnotnull(cr_order_number#14660L))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           :                                            +- FileScan parquet [cr_item_sk#14646,cr_order_number#14660L,cr_refunded_cash#14667,cr_reversed_charge#14668,cr_store_credit#14669] Batched: true, DataFilters: [isnotnull(cr_item_sk#14646), isnotnull(cr_order_number#14660L)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_order_number)], ReadSchema: struct<cr_item_sk:int,cr_order_number:bigint,cr_refunded_cash:decimal(7,2),cr_reversed_charge:dec...
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#14671 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#14671, 200), ENSURE_REQUIREMENTS, [id=#182071]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(d_year#14677) AND (d_year#14677 = 2002)) AND isnotnull(d_date_sk#14671))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#14671,d_year#14677] Batched: true, DataFilters: [isnotnull(d_year#14677), (d_year#14677 = 2002), isnotnull(d_date_sk#14671)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), EqualTo(d_year,2002), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [s_store_sk#14755 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(s_store_sk#14755, 200), ENSURE_REQUIREMENTS, [id=#182079]
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter ((isnotnull(s_store_sk#14755) AND isnotnull(s_store_name#14760)) AND isnotnull(s_zip#14780))
                                 :           :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [s_store_sk#14755,s_store_name#14760,s_zip#14780] Batched: true, DataFilters: [isnotnull(s_store_sk#14755), isnotnull(s_store_name#14760), isnotnull(s_zip#14780)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(s_store_sk), IsNotNull(s_store_name), IsNotNull(s_zip)], ReadSchema: struct<s_store_sk:int,s_store_name:string,s_zip:string>
                                 :           :           :           :           :           :           :           :           :           :           :           :           +- Sort [c_customer_sk#14784 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(c_customer_sk#14784, 200), ENSURE_REQUIREMENTS, [id=#182087]
                                 :           :           :           :           :           :           :           :           :           :           :           :                 +- Filter (((((isnotnull(c_customer_sk#14784) AND isnotnull(c_first_sales_date_sk#14790)) AND isnotnull(c_first_shipto_date_sk#14789)) AND isnotnull(c_current_cdemo_sk#14786)) AND isnotnull(c_current_hdemo_sk#14787)) AND isnotnull(c_current_addr_sk#14788))
                                 :           :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [c_customer_sk#14784,c_current_cdemo_sk#14786,c_current_hdemo_sk#14787,c_current_addr_sk#14788,c_first_shipto_date_sk#14789,c_first_sales_date_sk#14790] Batched: true, DataFilters: [isnotnull(c_customer_sk#14784), isnotnull(c_first_sales_date_sk#14790), isnotnull(c_first_shipto..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(c_customer_sk), IsNotNull(c_first_sales_date_sk), IsNotNull(c_first_shipto_date_sk), I..., ReadSchema: struct<c_customer_sk:int,c_current_cdemo_sk:int,c_current_hdemo_sk:int,c_current_addr_sk:int,c_fi...
                                 :           :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#14699 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#14699, 200), ENSURE_REQUIREMENTS, [id=#182095]
                                 :           :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#14699)
                                 :           :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#14699,d_year#14705] Batched: true, DataFilters: [isnotnull(d_date_sk#14699)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           :           +- Sort [d_date_sk#14727 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(d_date_sk#14727, 200), ENSURE_REQUIREMENTS, [id=#182103]
                                 :           :           :           :           :           :           :           :           :           :                 +- Filter isnotnull(d_date_sk#14727)
                                 :           :           :           :           :           :           :           :           :           :                    +- FileScan parquet [d_date_sk#14727,d_year#14733] Batched: true, DataFilters: [isnotnull(d_date_sk#14727)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :           :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#14802 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#14802, 200), ENSURE_REQUIREMENTS, [id=#182111]
                                 :           :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#14802) AND isnotnull(cd_marital_status#14804))
                                 :           :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#14802,cd_marital_status#14804] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14802), isnotnull(cd_marital_status#14804)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           :           +- Sort [cd_demo_sk#14811 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :           :              +- Exchange hashpartitioning(cd_demo_sk#14811, 200), ENSURE_REQUIREMENTS, [id=#182119]
                                 :           :           :           :           :           :           :           :                 +- Filter (isnotnull(cd_demo_sk#14811) AND isnotnull(cd_marital_status#14813))
                                 :           :           :           :           :           :           :           :                    +- FileScan parquet [cd_demo_sk#14811,cd_marital_status#14813] Batched: true, DataFilters: [isnotnull(cd_demo_sk#14811), isnotnull(cd_marital_status#14813)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cd_demo_sk), IsNotNull(cd_marital_status)], ReadSchema: struct<cd_demo_sk:int,cd_marital_status:string>
                                 :           :           :           :           :           :           :           +- Sort [p_promo_sk#14820 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :           :              +- Exchange hashpartitioning(p_promo_sk#14820, 200), ENSURE_REQUIREMENTS, [id=#182127]
                                 :           :           :           :           :           :           :                 +- Filter isnotnull(p_promo_sk#14820)
                                 :           :           :           :           :           :           :                    +- FileScan parquet [p_promo_sk#14820] Batched: true, DataFilters: [isnotnull(p_promo_sk#14820)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/promotion.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(p_promo_sk)], ReadSchema: struct<p_promo_sk:int>
                                 :           :           :           :           :           :           +- Sort [hd_demo_sk#14839 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#14839, 200), ENSURE_REQUIREMENTS, [id=#182135]
                                 :           :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#14839) AND isnotnull(hd_income_band_sk#14840))
                                 :           :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#14839,hd_income_band_sk#14840] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14839), isnotnull(hd_income_band_sk#14840)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           :           +- Sort [hd_demo_sk#14844 ASC NULLS FIRST], false, 0
                                 :           :           :           :           :              +- Exchange hashpartitioning(hd_demo_sk#14844, 200), ENSURE_REQUIREMENTS, [id=#182143]
                                 :           :           :           :           :                 +- Filter (isnotnull(hd_demo_sk#14844) AND isnotnull(hd_income_band_sk#14845))
                                 :           :           :           :           :                    +- FileScan parquet [hd_demo_sk#14844,hd_income_band_sk#14845] Batched: true, DataFilters: [isnotnull(hd_demo_sk#14844), isnotnull(hd_income_band_sk#14845)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/household_demographics.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(hd_demo_sk), IsNotNull(hd_income_band_sk)], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int>
                                 :           :           :           :           +- Sort [ca_address_sk#14849 ASC NULLS FIRST], false, 0
                                 :           :           :           :              +- Exchange hashpartitioning(ca_address_sk#14849, 200), ENSURE_REQUIREMENTS, [id=#182151]
                                 :           :           :           :                 +- Filter isnotnull(ca_address_sk#14849)
                                 :           :           :           :                    +- FileScan parquet [ca_address_sk#14849,ca_street_number#14851,ca_street_name#14852,ca_city#14855,ca_zip#14858] Batched: true, DataFilters: [isnotnull(ca_address_sk#14849)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           :           +- Sort [ca_address_sk#14862 ASC NULLS FIRST], false, 0
                                 :           :           :              +- Exchange hashpartitioning(ca_address_sk#14862, 200), ENSURE_REQUIREMENTS, [id=#182159]
                                 :           :           :                 +- Filter isnotnull(ca_address_sk#14862)
                                 :           :           :                    +- FileScan parquet [ca_address_sk#14862,ca_street_number#14864,ca_street_name#14865,ca_city#14868,ca_zip#14871] Batched: true, DataFilters: [isnotnull(ca_address_sk#14862)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/customer_address.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ca_address_sk)], ReadSchema: struct<ca_address_sk:int,ca_street_number:string,ca_street_name:string,ca_city:string,ca_zip:string>
                                 :           :           +- Sort [ib_income_band_sk#14875 ASC NULLS FIRST], false, 0
                                 :           :              +- Exchange hashpartitioning(ib_income_band_sk#14875, 200), ENSURE_REQUIREMENTS, [id=#182167]
                                 :           :                 +- Filter isnotnull(ib_income_band_sk#14875)
                                 :           :                    +- FileScan parquet [ib_income_band_sk#14875] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14875)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 :           +- Sort [ib_income_band_sk#14878 ASC NULLS FIRST], false, 0
                                 :              +- Exchange hashpartitioning(ib_income_band_sk#14878, 200), ENSURE_REQUIREMENTS, [id=#182175]
                                 :                 +- Filter isnotnull(ib_income_band_sk#14878)
                                 :                    +- FileScan parquet [ib_income_band_sk#14878] Batched: true, DataFilters: [isnotnull(ib_income_band_sk#14878)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/income_band.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ib_income_band_sk)], ReadSchema: struct<ib_income_band_sk:int>
                                 +- Sort [i_item_sk#14881 ASC NULLS FIRST], false, 0
                                    +- Exchange hashpartitioning(i_item_sk#14881, 200), ENSURE_REQUIREMENTS, [id=#182183]
                                       +- Project [i_item_sk#14881, i_product_name#14902]
                                          +- Filter ((((((isnotnull(i_current_price#14886) AND i_color#14898 IN (chocolate,lime,sienna,drab,goldenrod,navajo)) AND (i_current_price#14886 >= 75.00)) AND (i_current_price#14886 <= 85.00)) AND (i_current_price#14886 >= 76.00)) AND (i_current_price#14886 <= 90.00)) AND isnotnull(i_item_sk#14881))
                                             +- FileScan parquet [i_item_sk#14881,i_current_price#14886,i_color#14898,i_product_name#14902] Batched: true, DataFilters: [isnotnull(i_current_price#14886), i_color#14898 IN (chocolate,lime,sienna,drab,goldenrod,navajo)..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_current_price), In(i_color, [chocolate,drab,goldenrod,lime,navajo,sienna]), GreaterT..., ReadSchema: struct<i_item_sk:int,i_current_price:decimal(7,2),i_color:string,i_product_name:string>
