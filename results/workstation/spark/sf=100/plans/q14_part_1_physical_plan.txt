AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#5222 ASC NULLS FIRST,i_brand_id#5223 ASC NULLS FIRST,i_class_id#5224 ASC NULLS FIRST,i_category_id#5225 ASC NULLS FIRST], output=[channel#5222,i_brand_id#5223,i_class_id#5224,i_category_id#5225,sum(sales)#5212,sum(number_sales)#5213L])
   +- *(272) HashAggregate(keys=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L], functions=[sum(sales#4628), sum(number_sales#4629L)], output=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, sum(sales)#5212, sum(number_sales)#5213L])
      +- AQEShuffleRead coalesced
         +- ShuffleQueryStage 243
            +- Exchange hashpartitioning(channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L, 200), ENSURE_REQUIREMENTS, [id=#61167]
               +- *(271) HashAggregate(keys=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L], functions=[partial_sum(sales#4628), partial_sum(number_sales#4629L)], output=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L, sum#5246, isEmpty#5247, sum#5248L])
                  +- *(271) Expand [[sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, i_class_id#4982, i_category_id#4984, 0], [sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, i_class_id#4982, null, 1], [sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, null, null, 3], [sales#4628, number_sales#4629L, channel#5217, null, null, null, 7], [sales#4628, number_sales#4629L, null, null, null, null, 15]], [sales#4628, number_sales#4629L, channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L]
                     +- Union
                        :- *(268) Project [sales#4628, number_sales#4629L, store AS channel#5217, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                        :  +- *(268) Filter (isnotnull(sales#4628) AND (cast(sales#4628 as decimal(32,6)) > cast(Subquery subquery#4631, [id=#27156] as decimal(32,6))))
                        :     :  +- Subquery subquery#4631, [id=#27156]
                        :     :     +- AdaptiveSparkPlan isFinalPlan=true
                                    +- == Final Plan ==
                                       *(17) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                                       +- ShuffleQueryStage 9
                                          +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#61670]
                                             +- *(16) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                                                +- Union
                                                   :- *(9) Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                                                   :  +- *(9) SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                                                   :     :- *(7) Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                                                   :     :  +- AQEShuffleRead coalesced
                                                   :     :     +- ShuffleQueryStage 0
                                                   :     :        +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#61254]
                                                   :     :           +- *(1) Filter isnotnull(ss_sold_date_sk#4775)
                                                   :     :              +- *(1) ColumnarToRow
                                                   :     :                 +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                   :     +- *(8) Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                                                   :        +- AQEShuffleRead coalesced
                                                   :           +- ShuffleQueryStage 2
                                                   :              +- ReusedExchange [d_date_sk#4798], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                                                   :- *(12) Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                                                   :  +- *(12) SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                                                   :     :- *(10) Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                                                   :     :  +- AQEShuffleRead coalesced
                                                   :     :     +- ShuffleQueryStage 3
                                                   :     :        +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#61296]
                                                   :     :           +- *(3) Filter isnotnull(cs_sold_date_sk#4826)
                                                   :     :              +- *(3) ColumnarToRow
                                                   :     :                 +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                   :     +- *(11) Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                                                   :        +- AQEShuffleRead coalesced
                                                   :           +- ShuffleQueryStage 5
                                                   :              +- ReusedExchange [d_date_sk#4860], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                                                   +- *(15) Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                                                      +- *(15) SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                                                         :- *(13) Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                                                         :  +- AQEShuffleRead coalesced
                                                         :     +- ShuffleQueryStage 6
                                                         :        +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#61338]
                                                         :           +- *(5) Filter isnotnull(ws_sold_date_sk#4888)
                                                         :              +- *(5) ColumnarToRow
                                                         :                 +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                         +- *(14) Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                                                            +- AQEShuffleRead coalesced
                                                               +- ShuffleQueryStage 8
                                                                  +- ReusedExchange [d_date_sk#4922], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                                    +- == Initial Plan ==
                                       HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                                       +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#27154]
                                          +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                                             +- Union
                                                :- Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                                                :  +- SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                                                :     :- Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                                                :     :  +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#27131]
                                                :     :     +- Filter isnotnull(ss_sold_date_sk#4775)
                                                :     :        +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                                :     +- Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                                                :        +- Exchange hashpartitioning(d_date_sk#4798, 200), ENSURE_REQUIREMENTS, [id=#27132]
                                                :           +- Project [d_date_sk#4798]
                                                :              +- Filter (((isnotnull(d_year#4804) AND (d_year#4804 >= 1999)) AND (d_year#4804 <= 2001)) AND isnotnull(d_date_sk#4798))
                                                :                 +- FileScan parquet [d_date_sk#4798,d_year#4804] Batched: true, DataFilters: [isnotnull(d_year#4804), (d_year#4804 >= 1999), (d_year#4804 <= 2001), isnotnull(d_date_sk#4798)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                :- Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                                                :  +- SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                                                :     :- Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                                                :     :  +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#27138]
                                                :     :     +- Filter isnotnull(cs_sold_date_sk#4826)
                                                :     :        +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                                :     +- Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                                                :        +- Exchange hashpartitioning(d_date_sk#4860, 200), ENSURE_REQUIREMENTS, [id=#27139]
                                                :           +- Project [d_date_sk#4860]
                                                :              +- Filter (((isnotnull(d_year#4866) AND (d_year#4866 >= 1999)) AND (d_year#4866 <= 2001)) AND isnotnull(d_date_sk#4860))
                                                :                 +- FileScan parquet [d_date_sk#4860,d_year#4866] Batched: true, DataFilters: [isnotnull(d_year#4866), (d_year#4866 >= 1999), (d_year#4866 <= 2001), isnotnull(d_date_sk#4860)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                                +- Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                                                   +- SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                                                      :- Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                                                      :  +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#27145]
                                                      :     +- Filter isnotnull(ws_sold_date_sk#4888)
                                                      :        +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                      +- Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                                                         +- Exchange hashpartitioning(d_date_sk#4922, 200), ENSURE_REQUIREMENTS, [id=#27146]
                                                            +- Project [d_date_sk#4922]
                                                               +- Filter (((isnotnull(d_year#4928) AND (d_year#4928 >= 1999)) AND (d_year#4928 <= 2001)) AND isnotnull(d_date_sk#4922))
                                                                  +- FileScan parquet [d_date_sk#4922,d_year#4928] Batched: true, DataFilters: [isnotnull(d_year#4928), (d_year#4928 >= 1999), (d_year#4928 <= 2001), isnotnull(d_date_sk#4922)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :     +- *(268) HashAggregate(keys=[i_brand_id#4980, i_class_id#4982, i_category_id#4984], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4960 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4962 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4980, i_class_id#4982, i_category_id#4984, sales#4628, number_sales#4629L])
                        :        +- AQEShuffleRead coalesced
                        :           +- ShuffleQueryStage 240
                        :              +- Exchange hashpartitioning(i_brand_id#4980, i_class_id#4982, i_category_id#4984, 200), ENSURE_REQUIREMENTS, [id=#60617]
                        :                 +- *(261) HashAggregate(keys=[i_brand_id#4980, i_class_id#4982, i_category_id#4984], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4960 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4962 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4980, i_class_id#4982, i_category_id#4984, sum#5252, isEmpty#5253, count#5254L])
                        :                    +- *(261) Project [ss_quantity#4960, ss_list_price#4962, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                        :                       +- *(261) SortMergeJoin [ss_sold_date_sk#4950], [d_date_sk#4995], Inner
                        :                          :- *(259) Sort [ss_sold_date_sk#4950 ASC NULLS FIRST], false, 0
                        :                          :  +- AQEShuffleRead coalesced
                        :                          :     +- ShuffleQueryStage 237
                        :                          :        +- Exchange hashpartitioning(ss_sold_date_sk#4950, 200), ENSURE_REQUIREMENTS, [id=#60187]
                        :                          :           +- *(244) Project [ss_sold_date_sk#4950, ss_quantity#4960, ss_list_price#4962, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                        :                          :              +- *(244) SortMergeJoin [ss_item_sk#4952], [i_item_sk#4973], Inner
                        :                          :                 :- *(240) SortMergeJoin [ss_item_sk#4952], [ss_item_sk#4645], LeftSemi
                        :                          :                 :  :- *(238) Sort [ss_item_sk#4952 ASC NULLS FIRST], false, 0
                        :                          :                 :  :  +- AQEShuffleRead coalesced
                        :                          :                 :  :     +- ShuffleQueryStage 0
                        :                          :                 :  :        +- Exchange hashpartitioning(ss_item_sk#4952, 200), ENSURE_REQUIREMENTS, [id=#29287]
                        :                          :                 :  :           +- *(1) Filter (isnotnull(ss_item_sk#4952) AND isnotnull(ss_sold_date_sk#4950))
                        :                          :                 :  :              +- *(1) ColumnarToRow
                        :                          :                 :  :                 +- FileScan parquet [ss_sold_date_sk#4950,ss_item_sk#4952,ss_quantity#4960,ss_list_price#4962] Batched: true, DataFilters: [isnotnull(ss_item_sk#4952), isnotnull(ss_sold_date_sk#4950)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                          :                 :  +- *(239) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                        :                          :                 :     +- AQEShuffleRead coalesced
                        :                          :                 :        +- ShuffleQueryStage 226
                        :                          :                 :           +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                        :                          :                 :              +- *(222) Project [i_item_sk#668 AS ss_item_sk#4645]
                        :                          :                 :                 +- *(222) SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                        :                          :                 :                    :- *(220) Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                        :                          :                 :                    :  +- AQEShuffleRead coalesced
                        :                          :                 :                    :     +- ShuffleQueryStage 1
                        :                          :                 :                    :        +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#29304]
                        :                          :                 :                    :           +- *(2) Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                        :                          :                 :                    :              +- *(2) ColumnarToRow
                        :                          :                 :                    :                 +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :                 :                    +- *(221) Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                        :                          :                 :                       +- *(221) HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                        :                          :                 :                          +- AQEShuffleRead coalesced
                        :                          :                 :                             +- ShuffleQueryStage 215
                        :                          :                 :                                +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#58522]
                        :                          :                 :                                   +- *(204) HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                        :                          :                 :                                      +- *(204) SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                        :                          :                 :                                         :- *(202) Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :     +- ShuffleQueryStage 204
                        :                          :                 :                                         :        +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#57254]
                        :                          :                 :                                         :           +- *(196) HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                        :                          :                 :                                         :              +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                 +- ShuffleQueryStage 193
                        :                          :                 :                                         :                    +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#56225]
                        :                          :                 :                                         :                       +- *(180) HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                        :                          :                 :                                         :                          +- *(180) Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                        :                          :                 :                                         :                             +- *(180) SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                        :                          :                 :                                         :                                :- *(178) Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :     +- ShuffleQueryStage 182
                        :                          :                 :                                         :                                :        +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#54976]
                        :                          :                 :                                         :                                :           +- *(162) Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                        :                          :                 :                                         :                                :              +- *(162) SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                        :                          :                 :                                         :                                :                 :- *(160) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                 :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                 :     +- ShuffleQueryStage 2
                        :                          :                 :                                         :                                :                 :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#29321]
                        :                          :                 :                                         :                                :                 :           +- *(3) Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                        :                          :                 :                                         :                                :                 :              +- *(3) ColumnarToRow
                        :                          :                 :                                         :                                :                 :                 +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                        :                          :                 :                                         :                                :                 +- *(161) Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                    +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                       +- ShuffleQueryStage 171
                        :                          :                 :                                         :                                :                          +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#52275]
                        :                          :                 :                                         :                                :                             +- *(144) SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                        :                          :                 :                                         :                                :                                :- *(142) Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                :     +- ShuffleQueryStage 3
                        :                          :                 :                                         :                                :                                :        +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#29338]
                        :                          :                 :                                         :                                :                                :           +- *(4) Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                        :                          :                 :                                         :                                :                                :              +- *(4) ColumnarToRow
                        :                          :                 :                                         :                                :                                :                 +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :                 :                                         :                                :                                +- *(143) Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                   +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                      +- ShuffleQueryStage 149
                        :                          :                 :                                         :                                :                                         +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#48580]
                        :                          :                 :                                         :                                :                                            +- *(108) Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                        :                          :                 :                                         :                                :                                               +- *(108) SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                        :                          :                 :                                         :                                :                                                  :- *(106) Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                                  :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                                  :     +- ShuffleQueryStage 127
                        :                          :                 :                                         :                                :                                                  :        +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#42411]
                        :                          :                 :                                         :                                :                                                  :           +- *(72) Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                        :                          :                 :                                         :                                :                                                  :              +- *(72) SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                        :                          :                 :                                         :                                :                                                  :                 :- *(70) Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                                  :                 :  +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                                  :                 :     +- ShuffleQueryStage 4
                        :                          :                 :                                         :                                :                                                  :                 :        +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#29355]
                        :                          :                 :                                         :                                :                                                  :                 :           +- *(5) Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                        :                          :                 :                                         :                                :                                                  :                 :              +- *(5) ColumnarToRow
                        :                          :                 :                                         :                                :                                                  :                 :                 +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                        :                          :                 :                                         :                                :                                                  :                 +- *(71) Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                                  :                    +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                                  :                       +- ShuffleQueryStage 5
                        :                          :                 :                                         :                                :                                                  :                          +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#29372]
                        :                          :                 :                                         :                                :                                                  :                             +- *(6) Filter isnotnull(i_item_sk#4675)
                        :                          :                 :                                         :                                :                                                  :                                +- *(6) ColumnarToRow
                        :                          :                 :                                         :                                :                                                  :                                   +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                        :                          :                 :                                         :                                :                                                  +- *(107) Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                :                                                     +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                :                                                        +- ShuffleQueryStage 6
                        :                          :                 :                                         :                                :                                                           +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                        :                          :                 :                                         :                                :                                                              +- *(7) Project [d_date_sk#4697]
                        :                          :                 :                                         :                                :                                                                 +- *(7) Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                        :                          :                 :                                         :                                :                                                                    +- *(7) ColumnarToRow
                        :                          :                 :                                         :                                :                                                                       +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                          :                 :                                         :                                +- *(179) Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                        :                          :                 :                                         :                                   +- AQEShuffleRead coalesced
                        :                          :                 :                                         :                                      +- ShuffleQueryStage 8
                        :                          :                 :                                         :                                         +- ReusedExchange [d_date_sk#612], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                        :                          :                 :                                         +- *(203) Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                        :                          :                 :                                            +- AQEShuffleRead coalesced
                        :                          :                 :                                               +- ShuffleQueryStage 160
                        :                          :                 :                                                  +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#51000]
                        :                          :                 :                                                     +- *(126) Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                        :                          :                 :                                                        +- *(126) SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                        :                          :                 :                                                           :- *(124) Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                        :                          :                 :                                                           :  +- AQEShuffleRead coalesced
                        :                          :                 :                                                           :     +- ShuffleQueryStage 138
                        :                          :                 :                                                           :        +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#45263]
                        :                          :                 :                                                           :           +- *(90) Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                        :                          :                 :                                                           :              +- *(90) SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                        :                          :                 :                                                           :                 :- *(88) Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                        :                          :                 :                                                           :                 :  +- AQEShuffleRead coalesced
                        :                          :                 :                                                           :                 :     +- ShuffleQueryStage 9
                        :                          :                 :                                                           :                 :        +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#29455]
                        :                          :                 :                                                           :                 :           +- *(9) Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                        :                          :                 :                                                           :                 :              +- *(9) ColumnarToRow
                        :                          :                 :                                                           :                 :                 +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                        :                          :                 :                                                           :                 +- *(89) Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                        :                          :                 :                                                           :                    +- AQEShuffleRead coalesced
                        :                          :                 :                                                           :                       +- ShuffleQueryStage 11
                        :                          :                 :                                                           :                          +- ReusedExchange [i_item_sk#4725, i_brand_id#4732, i_class_id#4734, i_category_id#4736], Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#29372]
                        :                          :                 :                                                           +- *(125) Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                        :                          :                 :                                                              +- AQEShuffleRead coalesced
                        :                          :                 :                                                                 +- ShuffleQueryStage 13
                        :                          :                 :                                                                    +- ReusedExchange [d_date_sk#4747], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                        :                          :                 +- *(243) SortMergeJoin [i_item_sk#4973], [ss_item_sk#4645], LeftSemi
                        :                          :                    :- *(241) Sort [i_item_sk#4973 ASC NULLS FIRST], false, 0
                        :                          :                    :  +- AQEShuffleRead coalesced
                        :                          :                    :     +- ShuffleQueryStage 15
                        :                          :                    :        +- ReusedExchange [i_item_sk#4973, i_brand_id#4980, i_class_id#4982, i_category_id#4984], Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#29372]
                        :                          :                    +- *(242) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                        :                          :                       +- AQEShuffleRead coalesced
                        :                          :                          +- ShuffleQueryStage 228
                        :                          :                             +- ReusedExchange [ss_item_sk#4645], Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                        :                          +- *(260) Sort [d_date_sk#4995 ASC NULLS FIRST], false, 0
                        :                             +- AQEShuffleRead coalesced
                        :                                +- ShuffleQueryStage 36
                        :                                   +- Exchange hashpartitioning(d_date_sk#4995, 200), ENSURE_REQUIREMENTS, [id=#29799]
                        :                                      +- *(23) Project [d_date_sk#4995]
                        :                                         +- *(23) Filter ((((isnotnull(d_year#5001) AND isnotnull(d_moy#5003)) AND (d_year#5001 = 2001)) AND (d_moy#5003 = 11)) AND isnotnull(d_date_sk#4995))
                        :                                            +- *(23) ColumnarToRow
                        :                                               +- FileScan parquet [d_date_sk#4995,d_year#5001,d_moy#5003] Batched: true, DataFilters: [isnotnull(d_year#5001), isnotnull(d_moy#5003), (d_year#5001 = 2001), (d_moy#5003 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                        :- *(269) Project [sales#4633, number_sales#4634L, catalog AS channel#5235, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                        :  +- *(269) Filter (isnotnull(sales#4633) AND (cast(sales#4633 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#4631, [id=#27156] as decimal(32,6))))
                        :     :  +- ReusedSubquery Subquery subquery#4631, [id=#27156]
                        :     +- *(269) HashAggregate(keys=[i_brand_id#5064, i_class_id#5066, i_category_id#5068], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#5041 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#5043 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5064, i_class_id#5066, i_category_id#5068, sales#4633, number_sales#4634L])
                        :        +- AQEShuffleRead coalesced
                        :           +- ShuffleQueryStage 241
                        :              +- Exchange hashpartitioning(i_brand_id#5064, i_class_id#5066, i_category_id#5068, 200), ENSURE_REQUIREMENTS, [id=#60784]
                        :                 +- *(264) HashAggregate(keys=[i_brand_id#5064, i_class_id#5066, i_category_id#5068], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#5041 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#5043 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5064, i_class_id#5066, i_category_id#5068, sum#5258, isEmpty#5259, count#5260L])
                        :                    +- *(264) Project [cs_quantity#5041, cs_list_price#5043, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                        :                       +- *(264) SortMergeJoin [cs_sold_date_sk#5023], [d_date_sk#5079], Inner
                        :                          :- *(262) Sort [cs_sold_date_sk#5023 ASC NULLS FIRST], false, 0
                        :                          :  +- AQEShuffleRead coalesced
                        :                          :     +- ShuffleQueryStage 238
                        :                          :        +- Exchange hashpartitioning(cs_sold_date_sk#5023, 200), ENSURE_REQUIREMENTS, [id=#60274]
                        :                          :           +- *(251) Project [cs_sold_date_sk#5023, cs_quantity#5041, cs_list_price#5043, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                        :                          :              +- *(251) SortMergeJoin [cs_item_sk#5038], [i_item_sk#5057], Inner
                        :                          :                 :- *(247) SortMergeJoin [cs_item_sk#5038], [ss_item_sk#4645], LeftSemi
                        :                          :                 :  :- *(245) Sort [cs_item_sk#5038 ASC NULLS FIRST], false, 0
                        :                          :                 :  :  +- AQEShuffleRead coalesced
                        :                          :                 :  :     +- ShuffleQueryStage 37
                        :                          :                 :  :        +- Exchange hashpartitioning(cs_item_sk#5038, 200), ENSURE_REQUIREMENTS, [id=#29825]
                        :                          :                 :  :           +- *(24) Filter (isnotnull(cs_item_sk#5038) AND isnotnull(cs_sold_date_sk#5023))
                        :                          :                 :  :              +- *(24) ColumnarToRow
                        :                          :                 :  :                 +- FileScan parquet [cs_sold_date_sk#5023,cs_item_sk#5038,cs_quantity#5041,cs_list_price#5043] Batched: true, DataFilters: [isnotnull(cs_item_sk#5038), isnotnull(cs_sold_date_sk#5023)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                          :                 :  +- *(246) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                        :                          :                 :     +- AQEShuffleRead coalesced
                        :                          :                 :        +- ShuffleQueryStage 230
                        :                          :                 :           +- ReusedExchange [ss_item_sk#4645], Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                        :                          :                 +- *(250) SortMergeJoin [i_item_sk#5057], [ss_item_sk#4645], LeftSemi
                        :                          :                    :- *(248) Sort [i_item_sk#5057 ASC NULLS FIRST], false, 0
                        :                          :                    :  +- AQEShuffleRead coalesced
                        :                          :                    :     +- ShuffleQueryStage 59
                        :                          :                    :        +- ReusedExchange [i_item_sk#5057, i_brand_id#5064, i_class_id#5066, i_category_id#5068], Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#29372]
                        :                          :                    +- *(249) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                        :                          :                       +- AQEShuffleRead coalesced
                        :                          :                          +- ShuffleQueryStage 232
                        :                          :                             +- ReusedExchange [ss_item_sk#4645], Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                        :                          +- *(263) Sort [d_date_sk#5079 ASC NULLS FIRST], false, 0
                        :                             +- AQEShuffleRead coalesced
                        :                                +- ShuffleQueryStage 81
                        :                                   +- ReusedExchange [d_date_sk#5079], Exchange hashpartitioning(d_date_sk#4995, 200), ENSURE_REQUIREMENTS, [id=#29799]
                        +- *(270) Project [sales#4638, number_sales#4639L, web AS channel#5239, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                           +- *(270) Filter (isnotnull(sales#4638) AND (cast(sales#4638 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#4631, [id=#27156] as decimal(32,6))))
                              :  +- ReusedSubquery Subquery subquery#4631, [id=#27156]
                              +- *(270) HashAggregate(keys=[i_brand_id#5148, i_class_id#5150, i_category_id#5152], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5125 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5127 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5148, i_class_id#5150, i_category_id#5152, sales#4638, number_sales#4639L])
                                 +- AQEShuffleRead coalesced
                                    +- ShuffleQueryStage 242
                                       +- Exchange hashpartitioning(i_brand_id#5148, i_class_id#5150, i_category_id#5152, 200), ENSURE_REQUIREMENTS, [id=#60927]
                                          +- *(267) HashAggregate(keys=[i_brand_id#5148, i_class_id#5150, i_category_id#5152], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5125 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5127 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5148, i_class_id#5150, i_category_id#5152, sum#5264, isEmpty#5265, count#5266L])
                                             +- *(267) Project [ws_quantity#5125, ws_list_price#5127, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                                                +- *(267) SortMergeJoin [ws_sold_date_sk#5107], [d_date_sk#5163], Inner
                                                   :- *(265) Sort [ws_sold_date_sk#5107 ASC NULLS FIRST], false, 0
                                                   :  +- AQEShuffleRead coalesced
                                                   :     +- ShuffleQueryStage 239
                                                   :        +- Exchange hashpartitioning(ws_sold_date_sk#5107, 200), ENSURE_REQUIREMENTS, [id=#60361]
                                                   :           +- *(258) Project [ws_sold_date_sk#5107, ws_quantity#5125, ws_list_price#5127, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                                                   :              +- *(258) SortMergeJoin [ws_item_sk#5110], [i_item_sk#5141], Inner
                                                   :                 :- *(254) SortMergeJoin [ws_item_sk#5110], [ss_item_sk#4645], LeftSemi
                                                   :                 :  :- *(252) Sort [ws_item_sk#5110 ASC NULLS FIRST], false, 0
                                                   :                 :  :  +- AQEShuffleRead coalesced
                                                   :                 :  :     +- ShuffleQueryStage 82
                                                   :                 :  :        +- Exchange hashpartitioning(ws_item_sk#5110, 200), ENSURE_REQUIREMENTS, [id=#30379]
                                                   :                 :  :           +- *(47) Filter (isnotnull(ws_item_sk#5110) AND isnotnull(ws_sold_date_sk#5107))
                                                   :                 :  :              +- *(47) ColumnarToRow
                                                   :                 :  :                 +- FileScan parquet [ws_sold_date_sk#5107,ws_item_sk#5110,ws_quantity#5125,ws_list_price#5127] Batched: true, DataFilters: [isnotnull(ws_item_sk#5110), isnotnull(ws_sold_date_sk#5107)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                   :                 :  +- *(253) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                                                   :                 :     +- AQEShuffleRead coalesced
                                                   :                 :        +- ShuffleQueryStage 234
                                                   :                 :           +- ReusedExchange [ss_item_sk#4645], Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                                                   :                 +- *(257) SortMergeJoin [i_item_sk#5141], [ss_item_sk#4645], LeftSemi
                                                   :                    :- *(255) Sort [i_item_sk#5141 ASC NULLS FIRST], false, 0
                                                   :                    :  +- AQEShuffleRead coalesced
                                                   :                    :     +- ShuffleQueryStage 104
                                                   :                    :        +- ReusedExchange [i_item_sk#5141, i_brand_id#5148, i_class_id#5150, i_category_id#5152], Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#29372]
                                                   :                    +- *(256) Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                                                   :                       +- AQEShuffleRead coalesced
                                                   :                          +- ShuffleQueryStage 236
                                                   :                             +- ReusedExchange [ss_item_sk#4645], Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#59315]
                                                   +- *(266) Sort [d_date_sk#5163 ASC NULLS FIRST], false, 0
                                                      +- AQEShuffleRead coalesced
                                                         +- ShuffleQueryStage 126
                                                            +- ReusedExchange [d_date_sk#5163], Exchange hashpartitioning(d_date_sk#4995, 200), ENSURE_REQUIREMENTS, [id=#29799]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[channel#5222 ASC NULLS FIRST,i_brand_id#5223 ASC NULLS FIRST,i_class_id#5224 ASC NULLS FIRST,i_category_id#5225 ASC NULLS FIRST], output=[channel#5222,i_brand_id#5223,i_class_id#5224,i_category_id#5225,sum(sales)#5212,sum(number_sales)#5213L])
   +- HashAggregate(keys=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L], functions=[sum(sales#4628), sum(number_sales#4629L)], output=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, sum(sales)#5212, sum(number_sales)#5213L])
      +- Exchange hashpartitioning(channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L, 200), ENSURE_REQUIREMENTS, [id=#28055]
         +- HashAggregate(keys=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L], functions=[partial_sum(sales#4628), partial_sum(number_sales#4629L)], output=[channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L, sum#5246, isEmpty#5247, sum#5248L])
            +- Expand [[sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, i_class_id#4982, i_category_id#4984, 0], [sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, i_class_id#4982, null, 1], [sales#4628, number_sales#4629L, channel#5217, i_brand_id#4980, null, null, 3], [sales#4628, number_sales#4629L, channel#5217, null, null, null, 7], [sales#4628, number_sales#4629L, null, null, null, null, 15]], [sales#4628, number_sales#4629L, channel#5222, i_brand_id#5223, i_class_id#5224, i_category_id#5225, spark_grouping_id#5221L]
               +- Union
                  :- Project [sales#4628, number_sales#4629L, store AS channel#5217, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                  :  +- Filter (isnotnull(sales#4628) AND (cast(sales#4628 as decimal(32,6)) > cast(Subquery subquery#4631, [id=#27156] as decimal(32,6))))
                  :     :  +- Subquery subquery#4631, [id=#27156]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=true
                              +- == Final Plan ==
                                 *(17) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                                 +- ShuffleQueryStage 9
                                    +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#61670]
                                       +- *(16) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                                          +- Union
                                             :- *(9) Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                                             :  +- *(9) SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                                             :     :- *(7) Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                                             :     :  +- AQEShuffleRead coalesced
                                             :     :     +- ShuffleQueryStage 0
                                             :     :        +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#61254]
                                             :     :           +- *(1) Filter isnotnull(ss_sold_date_sk#4775)
                                             :     :              +- *(1) ColumnarToRow
                                             :     :                 +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                             :     +- *(8) Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                                             :        +- AQEShuffleRead coalesced
                                             :           +- ShuffleQueryStage 2
                                             :              +- ReusedExchange [d_date_sk#4798], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                                             :- *(12) Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                                             :  +- *(12) SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                                             :     :- *(10) Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                                             :     :  +- AQEShuffleRead coalesced
                                             :     :     +- ShuffleQueryStage 3
                                             :     :        +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#61296]
                                             :     :           +- *(3) Filter isnotnull(cs_sold_date_sk#4826)
                                             :     :              +- *(3) ColumnarToRow
                                             :     :                 +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                             :     +- *(11) Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                                             :        +- AQEShuffleRead coalesced
                                             :           +- ShuffleQueryStage 5
                                             :              +- ReusedExchange [d_date_sk#4860], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                                             +- *(15) Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                                                +- *(15) SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                                                   :- *(13) Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                                                   :  +- AQEShuffleRead coalesced
                                                   :     +- ShuffleQueryStage 6
                                                   :        +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#61338]
                                                   :           +- *(5) Filter isnotnull(ws_sold_date_sk#4888)
                                                   :              +- *(5) ColumnarToRow
                                                   :                 +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                   +- *(14) Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                                                      +- AQEShuffleRead coalesced
                                                         +- ShuffleQueryStage 8
                                                            +- ReusedExchange [d_date_sk#4922], Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#29395]
                              +- == Initial Plan ==
                                 HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                                 +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#27154]
                                    +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                                       +- Union
                                          :- Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                                          :  +- SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                                          :     :- Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#27131]
                                          :     :     +- Filter isnotnull(ss_sold_date_sk#4775)
                                          :     :        +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#4798, 200), ENSURE_REQUIREMENTS, [id=#27132]
                                          :           +- Project [d_date_sk#4798]
                                          :              +- Filter (((isnotnull(d_year#4804) AND (d_year#4804 >= 1999)) AND (d_year#4804 <= 2001)) AND isnotnull(d_date_sk#4798))
                                          :                 +- FileScan parquet [d_date_sk#4798,d_year#4804] Batched: true, DataFilters: [isnotnull(d_year#4804), (d_year#4804 >= 1999), (d_year#4804 <= 2001), isnotnull(d_date_sk#4798)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          :- Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                                          :  +- SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                                          :     :- Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                                          :     :  +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#27138]
                                          :     :     +- Filter isnotnull(cs_sold_date_sk#4826)
                                          :     :        +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                          :     +- Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                                          :        +- Exchange hashpartitioning(d_date_sk#4860, 200), ENSURE_REQUIREMENTS, [id=#27139]
                                          :           +- Project [d_date_sk#4860]
                                          :              +- Filter (((isnotnull(d_year#4866) AND (d_year#4866 >= 1999)) AND (d_year#4866 <= 2001)) AND isnotnull(d_date_sk#4860))
                                          :                 +- FileScan parquet [d_date_sk#4860,d_year#4866] Batched: true, DataFilters: [isnotnull(d_year#4866), (d_year#4866 >= 1999), (d_year#4866 <= 2001), isnotnull(d_date_sk#4860)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                          +- Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                                             +- SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                                                :- Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                                                :  +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#27145]
                                                :     +- Filter isnotnull(ws_sold_date_sk#4888)
                                                :        +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                                +- Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                                                   +- Exchange hashpartitioning(d_date_sk#4922, 200), ENSURE_REQUIREMENTS, [id=#27146]
                                                      +- Project [d_date_sk#4922]
                                                         +- Filter (((isnotnull(d_year#4928) AND (d_year#4928 >= 1999)) AND (d_year#4928 <= 2001)) AND isnotnull(d_date_sk#4922))
                                                            +- FileScan parquet [d_date_sk#4922,d_year#4928] Batched: true, DataFilters: [isnotnull(d_year#4928), (d_year#4928 >= 1999), (d_year#4928 <= 2001), isnotnull(d_date_sk#4922)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#4980, i_class_id#4982, i_category_id#4984], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4960 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4962 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#4980, i_class_id#4982, i_category_id#4984, sales#4628, number_sales#4629L])
                  :        +- Exchange hashpartitioning(i_brand_id#4980, i_class_id#4982, i_category_id#4984, 200), ENSURE_REQUIREMENTS, [id=#27685]
                  :           +- HashAggregate(keys=[i_brand_id#4980, i_class_id#4982, i_category_id#4984], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#4960 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#4962 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#4980, i_class_id#4982, i_category_id#4984, sum#5252, isEmpty#5253, count#5254L])
                  :              +- Project [ss_quantity#4960, ss_list_price#4962, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                  :                 +- SortMergeJoin [ss_sold_date_sk#4950], [d_date_sk#4995], Inner
                  :                    :- Sort [ss_sold_date_sk#4950 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#4950, 200), ENSURE_REQUIREMENTS, [id=#27677]
                  :                    :     +- Project [ss_sold_date_sk#4950, ss_quantity#4960, ss_list_price#4962, i_brand_id#4980, i_class_id#4982, i_category_id#4984]
                  :                    :        +- SortMergeJoin [ss_item_sk#4952], [i_item_sk#4973], Inner
                  :                    :           :- SortMergeJoin [ss_item_sk#4952], [ss_item_sk#4645], LeftSemi
                  :                    :           :  :- Sort [ss_item_sk#4952 ASC NULLS FIRST], false, 0
                  :                    :           :  :  +- Exchange hashpartitioning(ss_item_sk#4952, 200), ENSURE_REQUIREMENTS, [id=#27585]
                  :                    :           :  :     +- Filter (isnotnull(ss_item_sk#4952) AND isnotnull(ss_sold_date_sk#4950))
                  :                    :           :  :        +- FileScan parquet [ss_sold_date_sk#4950,ss_item_sk#4952,ss_quantity#4960,ss_list_price#4962] Batched: true, DataFilters: [isnotnull(ss_item_sk#4952), isnotnull(ss_sold_date_sk#4950)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :                    :           :  +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                  :                    :           :     +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#27586]
                  :                    :           :        +- Project [i_item_sk#668 AS ss_item_sk#4645]
                  :                    :           :           +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                  :                    :           :              :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :           :              :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#27578]
                  :                    :           :              :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :           :              :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :              +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                  :                    :           :                 +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                    +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27574]
                  :                    :           :                       +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                          +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                  :                    :           :                             :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                  :                    :           :                             :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#27567]
                  :                    :           :                             :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                             :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27548]
                  :                    :           :                             :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                             :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                  :                    :           :                             :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :           :                             :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27540]
                  :                    :           :                             :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                  :                    :           :                             :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                  :                    :           :                             :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27532]
                  :                    :           :                             :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :           :                             :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                             :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27533]
                  :                    :           :                             :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                  :                    :           :                             :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27525]
                  :                    :           :                             :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                  :                    :           :                             :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                             :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27526]
                  :                    :           :                             :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :           :                             :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                  :                    :           :                             :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27517]
                  :                    :           :                             :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :           :                             :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                  :                    :           :                             :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27509]
                  :                    :           :                             :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                  :                    :           :                             :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                             :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27510]
                  :                    :           :                             :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                  :                    :           :                             :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                             :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27518]
                  :                    :           :                             :                    :                                      +- Project [d_date_sk#4697]
                  :                    :           :                             :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                  :                    :           :                             :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                             :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27541]
                  :                    :           :                             :                          +- Project [d_date_sk#612]
                  :                    :           :                             :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :           :                             :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                             +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                  :                    :           :                                +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#27568]
                  :                    :           :                                   +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :           :                                      +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                  :                    :           :                                         :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#27559]
                  :                    :           :                                         :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :           :                                         :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                  :                    :           :                                         :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27551]
                  :                    :           :                                         :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                  :                    :           :                                         :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                         :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27552]
                  :                    :           :                                         :                 +- Filter isnotnull(i_item_sk#4725)
                  :                    :           :                                         :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                         +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                  :                    :           :                                            +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#27560]
                  :                    :           :                                               +- Project [d_date_sk#4747]
                  :                    :           :                                                  +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                  :                    :           :                                                     +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           +- SortMergeJoin [i_item_sk#4973], [ss_item_sk#4645], LeftSemi
                  :                    :              :- Sort [i_item_sk#4973 ASC NULLS FIRST], false, 0
                  :                    :              :  +- Exchange hashpartitioning(i_item_sk#4973, 200), ENSURE_REQUIREMENTS, [id=#27667]
                  :                    :              :     +- Filter isnotnull(i_item_sk#4973)
                  :                    :              :        +- FileScan parquet [i_item_sk#4973,i_brand_id#4980,i_class_id#4982,i_category_id#4984] Batched: true, DataFilters: [isnotnull(i_item_sk#4973)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :              +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                  :                    :                 +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#27668]
                  :                    :                    +- Project [i_item_sk#668 AS ss_item_sk#4645]
                  :                    :                       +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                  :                    :                          :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :                          :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#27660]
                  :                    :                          :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :                          :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                          +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                  :                    :                             +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27656]
                  :                    :                                   +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                      +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                  :                    :                                         :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                  :                    :                                         :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#27649]
                  :                    :                                         :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                         :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27630]
                  :                    :                                         :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                         :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                  :                    :                                         :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :                                         :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27622]
                  :                    :                                         :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                  :                    :                                         :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                  :                    :                                         :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27614]
                  :                    :                                         :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :                                         :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                         :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27615]
                  :                    :                                         :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                  :                    :                                         :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27607]
                  :                    :                                         :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                  :                    :                                         :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                         :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27608]
                  :                    :                                         :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :                                         :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                  :                    :                                         :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27599]
                  :                    :                                         :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :                                         :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                  :                    :                                         :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27591]
                  :                    :                                         :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                  :                    :                                         :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                         :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27592]
                  :                    :                                         :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                  :                    :                                         :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                         :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27600]
                  :                    :                                         :                    :                                      +- Project [d_date_sk#4697]
                  :                    :                                         :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                  :                    :                                         :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                         :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :                                         :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27623]
                  :                    :                                         :                          +- Project [d_date_sk#612]
                  :                    :                                         :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :                                         :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                         +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                  :                    :                                            +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#27650]
                  :                    :                                               +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :                                                  +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                  :                    :                                                     :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :                                                     :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#27641]
                  :                    :                                                     :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :                                                     :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                  :                    :                                                     :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :                                                     :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27633]
                  :                    :                                                     :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                  :                    :                                                     :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                                     :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                  :                    :                                                     :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27634]
                  :                    :                                                     :                 +- Filter isnotnull(i_item_sk#4725)
                  :                    :                                                     :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                                     +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                  :                    :                                                        +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#27642]
                  :                    :                                                           +- Project [d_date_sk#4747]
                  :                    :                                                              +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                  :                    :                                                                 +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- Sort [d_date_sk#4995 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(d_date_sk#4995, 200), ENSURE_REQUIREMENTS, [id=#27678]
                  :                          +- Project [d_date_sk#4995]
                  :                             +- Filter ((((isnotnull(d_year#5001) AND isnotnull(d_moy#5003)) AND (d_year#5001 = 2001)) AND (d_moy#5003 = 11)) AND isnotnull(d_date_sk#4995))
                  :                                +- FileScan parquet [d_date_sk#4995,d_year#5001,d_moy#5003] Batched: true, DataFilters: [isnotnull(d_year#5001), isnotnull(d_moy#5003), (d_year#5001 = 2001), (d_moy#5003 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  :- Project [sales#4633, number_sales#4634L, catalog AS channel#5235, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                  :  +- Filter (isnotnull(sales#4633) AND (cast(sales#4633 as decimal(32,6)) > cast(Subquery subquery#4636, [id=#27248] as decimal(32,6))))
                  :     :  +- Subquery subquery#4636, [id=#27248]
                  :     :     +- AdaptiveSparkPlan isFinalPlan=false
                  :     :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                  :     :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#27246]
                  :     :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                  :     :                 +- Union
                  :     :                    :- Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                  :     :                    :  +- SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                  :     :                    :     :- Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#27223]
                  :     :                    :     :     +- Filter isnotnull(ss_sold_date_sk#4775)
                  :     :                    :     :        +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#4798, 200), ENSURE_REQUIREMENTS, [id=#27224]
                  :     :                    :           +- Project [d_date_sk#4798]
                  :     :                    :              +- Filter (((isnotnull(d_year#4804) AND (d_year#4804 >= 1999)) AND (d_year#4804 <= 2001)) AND isnotnull(d_date_sk#4798))
                  :     :                    :                 +- FileScan parquet [d_date_sk#4798,d_year#4804] Batched: true, DataFilters: [isnotnull(d_year#4804), (d_year#4804 >= 1999), (d_year#4804 <= 2001), isnotnull(d_date_sk#4798)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    :- Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                  :     :                    :  +- SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                  :     :                    :     :- Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                  :     :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#27230]
                  :     :                    :     :     +- Filter isnotnull(cs_sold_date_sk#4826)
                  :     :                    :     :        +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :     :                    :     +- Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                  :     :                    :        +- Exchange hashpartitioning(d_date_sk#4860, 200), ENSURE_REQUIREMENTS, [id=#27231]
                  :     :                    :           +- Project [d_date_sk#4860]
                  :     :                    :              +- Filter (((isnotnull(d_year#4866) AND (d_year#4866 >= 1999)) AND (d_year#4866 <= 2001)) AND isnotnull(d_date_sk#4860))
                  :     :                    :                 +- FileScan parquet [d_date_sk#4860,d_year#4866] Batched: true, DataFilters: [isnotnull(d_year#4866), (d_year#4866 >= 1999), (d_year#4866 <= 2001), isnotnull(d_date_sk#4860)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     :                    +- Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                  :     :                       +- SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                  :     :                          :- Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                  :     :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#27237]
                  :     :                          :     +- Filter isnotnull(ws_sold_date_sk#4888)
                  :     :                          :        +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                  :     :                          +- Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                  :     :                             +- Exchange hashpartitioning(d_date_sk#4922, 200), ENSURE_REQUIREMENTS, [id=#27238]
                  :     :                                +- Project [d_date_sk#4922]
                  :     :                                   +- Filter (((isnotnull(d_year#4928) AND (d_year#4928 >= 1999)) AND (d_year#4928 <= 2001)) AND isnotnull(d_date_sk#4922))
                  :     :                                      +- FileScan parquet [d_date_sk#4922,d_year#4928] Batched: true, DataFilters: [isnotnull(d_year#4928), (d_year#4928 >= 1999), (d_year#4928 <= 2001), isnotnull(d_date_sk#4922)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :     +- HashAggregate(keys=[i_brand_id#5064, i_class_id#5066, i_category_id#5068], functions=[sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#5041 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#5043 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5064, i_class_id#5066, i_category_id#5068, sales#4633, number_sales#4634L])
                  :        +- Exchange hashpartitioning(i_brand_id#5064, i_class_id#5066, i_category_id#5068, 200), ENSURE_REQUIREMENTS, [id=#27866]
                  :           +- HashAggregate(keys=[i_brand_id#5064, i_class_id#5066, i_category_id#5068], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(cs_quantity#5041 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(cs_list_price#5043 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5064, i_class_id#5066, i_category_id#5068, sum#5258, isEmpty#5259, count#5260L])
                  :              +- Project [cs_quantity#5041, cs_list_price#5043, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                  :                 +- SortMergeJoin [cs_sold_date_sk#5023], [d_date_sk#5079], Inner
                  :                    :- Sort [cs_sold_date_sk#5023 ASC NULLS FIRST], false, 0
                  :                    :  +- Exchange hashpartitioning(cs_sold_date_sk#5023, 200), ENSURE_REQUIREMENTS, [id=#27858]
                  :                    :     +- Project [cs_sold_date_sk#5023, cs_quantity#5041, cs_list_price#5043, i_brand_id#5064, i_class_id#5066, i_category_id#5068]
                  :                    :        +- SortMergeJoin [cs_item_sk#5038], [i_item_sk#5057], Inner
                  :                    :           :- SortMergeJoin [cs_item_sk#5038], [ss_item_sk#4645], LeftSemi
                  :                    :           :  :- Sort [cs_item_sk#5038 ASC NULLS FIRST], false, 0
                  :                    :           :  :  +- Exchange hashpartitioning(cs_item_sk#5038, 200), ENSURE_REQUIREMENTS, [id=#27766]
                  :                    :           :  :     +- Filter (isnotnull(cs_item_sk#5038) AND isnotnull(cs_sold_date_sk#5023))
                  :                    :           :  :        +- FileScan parquet [cs_sold_date_sk#5023,cs_item_sk#5038,cs_quantity#5041,cs_list_price#5043] Batched: true, DataFilters: [isnotnull(cs_item_sk#5038), isnotnull(cs_sold_date_sk#5023)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                  :                    :           :  +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                  :                    :           :     +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#27767]
                  :                    :           :        +- Project [i_item_sk#668 AS ss_item_sk#4645]
                  :                    :           :           +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                  :                    :           :              :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :           :              :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#27759]
                  :                    :           :              :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :           :              :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :              +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                  :                    :           :                 +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                    +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27755]
                  :                    :           :                       +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                          +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                  :                    :           :                             :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                  :                    :           :                             :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#27748]
                  :                    :           :                             :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                             :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27729]
                  :                    :           :                             :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :           :                             :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                  :                    :           :                             :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :           :                             :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27721]
                  :                    :           :                             :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                  :                    :           :                             :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                  :                    :           :                             :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27713]
                  :                    :           :                             :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :           :                             :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :           :                             :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27714]
                  :                    :           :                             :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                  :                    :           :                             :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27706]
                  :                    :           :                             :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                  :                    :           :                             :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                             :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27707]
                  :                    :           :                             :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :           :                             :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                  :                    :           :                             :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27698]
                  :                    :           :                             :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :           :                             :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                  :                    :           :                             :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27690]
                  :                    :           :                             :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                  :                    :           :                             :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :           :                             :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27691]
                  :                    :           :                             :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                  :                    :           :                             :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                             :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27699]
                  :                    :           :                             :                    :                                      +- Project [d_date_sk#4697]
                  :                    :           :                             :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                  :                    :           :                             :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                             :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :           :                             :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27722]
                  :                    :           :                             :                          +- Project [d_date_sk#612]
                  :                    :           :                             :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :           :                             :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           :                             +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                  :                    :           :                                +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#27749]
                  :                    :           :                                   +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :           :                                      +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                  :                    :           :                                         :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#27740]
                  :                    :           :                                         :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :           :                                         :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                  :                    :           :                                         :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27732]
                  :                    :           :                                         :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                  :                    :           :                                         :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :           :                                         :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                  :                    :           :                                         :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27733]
                  :                    :           :                                         :                 +- Filter isnotnull(i_item_sk#4725)
                  :                    :           :                                         :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :           :                                         +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                  :                    :           :                                            +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#27741]
                  :                    :           :                                               +- Project [d_date_sk#4747]
                  :                    :           :                                                  +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                  :                    :           :                                                     +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :           +- SortMergeJoin [i_item_sk#5057], [ss_item_sk#4645], LeftSemi
                  :                    :              :- Sort [i_item_sk#5057 ASC NULLS FIRST], false, 0
                  :                    :              :  +- Exchange hashpartitioning(i_item_sk#5057, 200), ENSURE_REQUIREMENTS, [id=#27848]
                  :                    :              :     +- Filter isnotnull(i_item_sk#5057)
                  :                    :              :        +- FileScan parquet [i_item_sk#5057,i_brand_id#5064,i_class_id#5066,i_category_id#5068] Batched: true, DataFilters: [isnotnull(i_item_sk#5057)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :              +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                  :                    :                 +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#27849]
                  :                    :                    +- Project [i_item_sk#668 AS ss_item_sk#4645]
                  :                    :                       +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                  :                    :                          :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                  :                    :                          :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#27841]
                  :                    :                          :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                  :                    :                          :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                          +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                  :                    :                             +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27837]
                  :                    :                                   +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                      +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                  :                    :                                         :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                  :                    :                                         :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#27830]
                  :                    :                                         :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                         :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27811]
                  :                    :                                         :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                  :                    :                                         :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                  :                    :                                         :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                  :                    :                                         :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27803]
                  :                    :                                         :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                  :                    :                                         :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                  :                    :                                         :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27795]
                  :                    :                                         :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                  :                    :                                         :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                  :                    :                                         :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27796]
                  :                    :                                         :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                  :                    :                                         :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27788]
                  :                    :                                         :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                  :                    :                                         :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                         :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27789]
                  :                    :                                         :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :                                         :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                  :                    :                                         :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27780]
                  :                    :                                         :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                  :                    :                                         :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                  :                    :                                         :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27772]
                  :                    :                                         :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                  :                    :                                         :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                  :                    :                                         :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27773]
                  :                    :                                         :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                  :                    :                                         :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                         :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                  :                    :                                         :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27781]
                  :                    :                                         :                    :                                      +- Project [d_date_sk#4697]
                  :                    :                                         :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                  :                    :                                         :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                         :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                  :                    :                                         :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27804]
                  :                    :                                         :                          +- Project [d_date_sk#612]
                  :                    :                                         :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                  :                    :                                         :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    :                                         +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                  :                    :                                            +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#27831]
                  :                    :                                               +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :                                                  +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                  :                    :                                                     :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                  :                    :                                                     :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#27822]
                  :                    :                                                     :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                  :                    :                                                     :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                  :                    :                                                     :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                  :                    :                                                     :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27814]
                  :                    :                                                     :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                  :                    :                                                     :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                  :                    :                                                     :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                  :                    :                                                     :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27815]
                  :                    :                                                     :                 +- Filter isnotnull(i_item_sk#4725)
                  :                    :                                                     :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                  :                    :                                                     +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                  :                    :                                                        +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#27823]
                  :                    :                                                           +- Project [d_date_sk#4747]
                  :                    :                                                              +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                  :                    :                                                                 +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                  :                    +- Sort [d_date_sk#5079 ASC NULLS FIRST], false, 0
                  :                       +- Exchange hashpartitioning(d_date_sk#5079, 200), ENSURE_REQUIREMENTS, [id=#27859]
                  :                          +- Project [d_date_sk#5079]
                  :                             +- Filter ((((isnotnull(d_year#5085) AND isnotnull(d_moy#5087)) AND (d_year#5085 = 2001)) AND (d_moy#5087 = 11)) AND isnotnull(d_date_sk#5079))
                  :                                +- FileScan parquet [d_date_sk#5079,d_year#5085,d_moy#5087] Batched: true, DataFilters: [isnotnull(d_year#5085), isnotnull(d_moy#5087), (d_year#5085 = 2001), (d_moy#5087 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
                  +- Project [sales#4638, number_sales#4639L, web AS channel#5239, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                     +- Filter (isnotnull(sales#4638) AND (cast(sales#4638 as decimal(32,6)) > cast(Subquery subquery#4641, [id=#27340] as decimal(32,6))))
                        :  +- Subquery subquery#4641, [id=#27340]
                        :     +- AdaptiveSparkPlan isFinalPlan=false
                        :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#4652])
                        :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#27338]
                        :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#4646 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#4647 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#5269, count#5270L])
                        :                 +- Union
                        :                    :- Project [ss_quantity#4785 AS quantity#4646, ss_list_price#4787 AS list_price#4647]
                        :                    :  +- SortMergeJoin [ss_sold_date_sk#4775], [d_date_sk#4798], Inner
                        :                    :     :- Sort [ss_sold_date_sk#4775 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#4775, 200), ENSURE_REQUIREMENTS, [id=#27315]
                        :                    :     :     +- Filter isnotnull(ss_sold_date_sk#4775)
                        :                    :     :        +- FileScan parquet [ss_sold_date_sk#4775,ss_quantity#4785,ss_list_price#4787] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#4775)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#4798 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#4798, 200), ENSURE_REQUIREMENTS, [id=#27316]
                        :                    :           +- Project [d_date_sk#4798]
                        :                    :              +- Filter (((isnotnull(d_year#4804) AND (d_year#4804 >= 1999)) AND (d_year#4804 <= 2001)) AND isnotnull(d_date_sk#4798))
                        :                    :                 +- FileScan parquet [d_date_sk#4798,d_year#4804] Batched: true, DataFilters: [isnotnull(d_year#4804), (d_year#4804 >= 1999), (d_year#4804 <= 2001), isnotnull(d_date_sk#4798)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    :- Project [cs_quantity#4844 AS quantity#4648, cs_list_price#4846 AS list_price#4649]
                        :                    :  +- SortMergeJoin [cs_sold_date_sk#4826], [d_date_sk#4860], Inner
                        :                    :     :- Sort [cs_sold_date_sk#4826 ASC NULLS FIRST], false, 0
                        :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#4826, 200), ENSURE_REQUIREMENTS, [id=#27322]
                        :                    :     :     +- Filter isnotnull(cs_sold_date_sk#4826)
                        :                    :     :        +- FileScan parquet [cs_sold_date_sk#4826,cs_quantity#4844,cs_list_price#4846] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#4826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                        :                    :     +- Sort [d_date_sk#4860 ASC NULLS FIRST], false, 0
                        :                    :        +- Exchange hashpartitioning(d_date_sk#4860, 200), ENSURE_REQUIREMENTS, [id=#27323]
                        :                    :           +- Project [d_date_sk#4860]
                        :                    :              +- Filter (((isnotnull(d_year#4866) AND (d_year#4866 >= 1999)) AND (d_year#4866 <= 2001)) AND isnotnull(d_date_sk#4860))
                        :                    :                 +- FileScan parquet [d_date_sk#4860,d_year#4866] Batched: true, DataFilters: [isnotnull(d_year#4866), (d_year#4866 >= 1999), (d_year#4866 <= 2001), isnotnull(d_date_sk#4860)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        :                    +- Project [ws_quantity#4906 AS quantity#4650, ws_list_price#4908 AS list_price#4651]
                        :                       +- SortMergeJoin [ws_sold_date_sk#4888], [d_date_sk#4922], Inner
                        :                          :- Sort [ws_sold_date_sk#4888 ASC NULLS FIRST], false, 0
                        :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#4888, 200), ENSURE_REQUIREMENTS, [id=#27329]
                        :                          :     +- Filter isnotnull(ws_sold_date_sk#4888)
                        :                          :        +- FileScan parquet [ws_sold_date_sk#4888,ws_quantity#4906,ws_list_price#4908] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#4888)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                        :                          +- Sort [d_date_sk#4922 ASC NULLS FIRST], false, 0
                        :                             +- Exchange hashpartitioning(d_date_sk#4922, 200), ENSURE_REQUIREMENTS, [id=#27330]
                        :                                +- Project [d_date_sk#4922]
                        :                                   +- Filter (((isnotnull(d_year#4928) AND (d_year#4928 >= 1999)) AND (d_year#4928 <= 2001)) AND isnotnull(d_date_sk#4922))
                        :                                      +- FileScan parquet [d_date_sk#4922,d_year#4928] Batched: true, DataFilters: [isnotnull(d_year#4928), (d_year#4928 >= 1999), (d_year#4928 <= 2001), isnotnull(d_date_sk#4922)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                        +- HashAggregate(keys=[i_brand_id#5148, i_class_id#5150, i_category_id#5152], functions=[sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5125 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5127 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5148, i_class_id#5150, i_category_id#5152, sales#4638, number_sales#4639L])
                           +- Exchange hashpartitioning(i_brand_id#5148, i_class_id#5150, i_category_id#5152, 200), ENSURE_REQUIREMENTS, [id=#28047]
                              +- HashAggregate(keys=[i_brand_id#5148, i_class_id#5150, i_category_id#5152], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ws_quantity#5125 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ws_list_price#5127 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5148, i_class_id#5150, i_category_id#5152, sum#5264, isEmpty#5265, count#5266L])
                                 +- Project [ws_quantity#5125, ws_list_price#5127, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                                    +- SortMergeJoin [ws_sold_date_sk#5107], [d_date_sk#5163], Inner
                                       :- Sort [ws_sold_date_sk#5107 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_sold_date_sk#5107, 200), ENSURE_REQUIREMENTS, [id=#28039]
                                       :     +- Project [ws_sold_date_sk#5107, ws_quantity#5125, ws_list_price#5127, i_brand_id#5148, i_class_id#5150, i_category_id#5152]
                                       :        +- SortMergeJoin [ws_item_sk#5110], [i_item_sk#5141], Inner
                                       :           :- SortMergeJoin [ws_item_sk#5110], [ss_item_sk#4645], LeftSemi
                                       :           :  :- Sort [ws_item_sk#5110 ASC NULLS FIRST], false, 0
                                       :           :  :  +- Exchange hashpartitioning(ws_item_sk#5110, 200), ENSURE_REQUIREMENTS, [id=#27947]
                                       :           :  :     +- Filter (isnotnull(ws_item_sk#5110) AND isnotnull(ws_sold_date_sk#5107))
                                       :           :  :        +- FileScan parquet [ws_sold_date_sk#5107,ws_item_sk#5110,ws_quantity#5125,ws_list_price#5127] Batched: true, DataFilters: [isnotnull(ws_item_sk#5110), isnotnull(ws_sold_date_sk#5107)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       :           :  +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                                       :           :     +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#27948]
                                       :           :        +- Project [i_item_sk#668 AS ss_item_sk#4645]
                                       :           :           +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                                       :           :              :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                                       :           :              :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#27940]
                                       :           :              :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                       :           :              :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :              +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                                       :           :                 +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :           :                    +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27936]
                                       :           :                       +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :           :                          +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                                       :           :                             :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                                       :           :                             :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#27929]
                                       :           :                             :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :           :                             :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27910]
                                       :           :                             :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :           :                             :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                                       :           :                             :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                                       :           :                             :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27902]
                                       :           :                             :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                                       :           :                             :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                                       :           :                             :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27894]
                                       :           :                             :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                       :           :                             :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :           :                             :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27895]
                                       :           :                             :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                                       :           :                             :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27887]
                                       :           :                             :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                                       :           :                             :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                             :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27888]
                                       :           :                             :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                                       :           :                             :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                                       :           :                             :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27879]
                                       :           :                             :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                                       :           :                             :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                                       :           :                             :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27871]
                                       :           :                             :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                                       :           :                             :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :           :                             :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27872]
                                       :           :                             :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                                       :           :                             :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                             :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                                       :           :                             :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27880]
                                       :           :                             :                    :                                      +- Project [d_date_sk#4697]
                                       :           :                             :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                                       :           :                             :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                             :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                                       :           :                             :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27903]
                                       :           :                             :                          +- Project [d_date_sk#612]
                                       :           :                             :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                                       :           :                             :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           :                             +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                                       :           :                                +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#27930]
                                       :           :                                   +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                                       :           :                                      +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                                       :           :                                         :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                       :           :                                         :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#27921]
                                       :           :                                         :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                                       :           :                                         :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                                       :           :                                         :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                       :           :                                         :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27913]
                                       :           :                                         :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                                       :           :                                         :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :           :                                         :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                                       :           :                                         :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27914]
                                       :           :                                         :                 +- Filter isnotnull(i_item_sk#4725)
                                       :           :                                         :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :           :                                         +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                                       :           :                                            +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#27922]
                                       :           :                                               +- Project [d_date_sk#4747]
                                       :           :                                                  +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                                       :           :                                                     +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :           +- SortMergeJoin [i_item_sk#5141], [ss_item_sk#4645], LeftSemi
                                       :              :- Sort [i_item_sk#5141 ASC NULLS FIRST], false, 0
                                       :              :  +- Exchange hashpartitioning(i_item_sk#5141, 200), ENSURE_REQUIREMENTS, [id=#28029]
                                       :              :     +- Filter isnotnull(i_item_sk#5141)
                                       :              :        +- FileScan parquet [i_item_sk#5141,i_brand_id#5148,i_class_id#5150,i_category_id#5152] Batched: true, DataFilters: [isnotnull(i_item_sk#5141)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :              +- Sort [ss_item_sk#4645 ASC NULLS FIRST], false, 0
                                       :                 +- Exchange hashpartitioning(ss_item_sk#4645, 200), ENSURE_REQUIREMENTS, [id=#28030]
                                       :                    +- Project [i_item_sk#668 AS ss_item_sk#4645]
                                       :                       +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#4642, class_id#4643, category_id#4644], Inner
                                       :                          :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                                       :                          :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#28022]
                                       :                          :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                                       :                          :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                          +- Sort [brand_id#4642 ASC NULLS FIRST, class_id#4643 ASC NULLS FIRST, category_id#4644 ASC NULLS FIRST], false, 0
                                       :                             +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :                                +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#28018]
                                       :                                   +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :                                      +- SortMergeJoin [coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644)], [coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736)], LeftSemi
                                       :                                         :- Sort [coalesce(brand_id#4642, 0) ASC NULLS FIRST, isnull(brand_id#4642) ASC NULLS FIRST, coalesce(class_id#4643, 0) ASC NULLS FIRST, isnull(class_id#4643) ASC NULLS FIRST, coalesce(category_id#4644, 0) ASC NULLS FIRST, isnull(category_id#4644) ASC NULLS FIRST], false, 0
                                       :                                         :  +- Exchange hashpartitioning(coalesce(brand_id#4642, 0), isnull(brand_id#4642), coalesce(class_id#4643, 0), isnull(class_id#4643), coalesce(category_id#4644, 0), isnull(category_id#4644), 200), ENSURE_REQUIREMENTS, [id=#28011]
                                       :                                         :     +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :                                         :        +- Exchange hashpartitioning(brand_id#4642, class_id#4643, category_id#4644, 200), ENSURE_REQUIREMENTS, [id=#27992]
                                       :                                         :           +- HashAggregate(keys=[brand_id#4642, class_id#4643, category_id#4644], functions=[], output=[brand_id#4642, class_id#4643, category_id#4644])
                                       :                                         :              +- Project [i_brand_id#4660 AS brand_id#4642, i_class_id#4662 AS class_id#4643, i_category_id#4664 AS category_id#4644]
                                       :                                         :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                                       :                                         :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                                       :                                         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#27984]
                                       :                                         :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#4660, i_class_id#4662, i_category_id#4664]
                                       :                                         :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#4653], Inner
                                       :                                         :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                                       :                                         :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#27976]
                                       :                                         :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                                       :                                         :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                                       :                                         :                    :           +- Sort [i_item_sk#4653 ASC NULLS FIRST], false, 0
                                       :                                         :                    :              +- Exchange hashpartitioning(i_item_sk#4653, 200), ENSURE_REQUIREMENTS, [id=#27977]
                                       :                                         :                    :                 +- SortMergeJoin [coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664)], [coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686)], LeftSemi
                                       :                                         :                    :                    :- Sort [coalesce(i_brand_id#4660, 0) ASC NULLS FIRST, isnull(i_brand_id#4660) ASC NULLS FIRST, coalesce(i_class_id#4662, 0) ASC NULLS FIRST, isnull(i_class_id#4662) ASC NULLS FIRST, coalesce(i_category_id#4664, 0) ASC NULLS FIRST, isnull(i_category_id#4664) ASC NULLS FIRST], false, 0
                                       :                                         :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#4660, 0), isnull(i_brand_id#4660), coalesce(i_class_id#4662, 0), isnull(i_class_id#4662), coalesce(i_category_id#4664, 0), isnull(i_category_id#4664), 200), ENSURE_REQUIREMENTS, [id=#27969]
                                       :                                         :                    :                    :     +- Filter (((isnotnull(i_item_sk#4653) AND isnotnull(i_brand_id#4660)) AND isnotnull(i_class_id#4662)) AND isnotnull(i_category_id#4664))
                                       :                                         :                    :                    :        +- FileScan parquet [i_item_sk#4653,i_brand_id#4660,i_class_id#4662,i_category_id#4664] Batched: true, DataFilters: [isnotnull(i_item_sk#4653), isnotnull(i_brand_id#4660), isnotnull(i_class_id#4662), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                         :                    :                    +- Sort [coalesce(i_brand_id#4682, 0) ASC NULLS FIRST, isnull(i_brand_id#4682) ASC NULLS FIRST, coalesce(i_class_id#4684, 0) ASC NULLS FIRST, isnull(i_class_id#4684) ASC NULLS FIRST, coalesce(i_category_id#4686, 0) ASC NULLS FIRST, isnull(i_category_id#4686) ASC NULLS FIRST], false, 0
                                       :                                         :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#4682, 0), isnull(i_brand_id#4682), coalesce(i_class_id#4684, 0), isnull(i_class_id#4684), coalesce(i_category_id#4686, 0), isnull(i_category_id#4686), 200), ENSURE_REQUIREMENTS, [id=#27970]
                                       :                                         :                    :                          +- Project [i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                                       :                                         :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#4697], Inner
                                       :                                         :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                                       :                                         :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#27961]
                                       :                                         :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#4682, i_class_id#4684, i_category_id#4686]
                                       :                                         :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#4675], Inner
                                       :                                         :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                                       :                                         :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#27953]
                                       :                                         :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                                       :                                         :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                                       :                                         :                    :                                :           +- Sort [i_item_sk#4675 ASC NULLS FIRST], false, 0
                                       :                                         :                    :                                :              +- Exchange hashpartitioning(i_item_sk#4675, 200), ENSURE_REQUIREMENTS, [id=#27954]
                                       :                                         :                    :                                :                 +- Filter isnotnull(i_item_sk#4675)
                                       :                                         :                    :                                :                    +- FileScan parquet [i_item_sk#4675,i_brand_id#4682,i_class_id#4684,i_category_id#4686] Batched: true, DataFilters: [isnotnull(i_item_sk#4675)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                         :                    :                                +- Sort [d_date_sk#4697 ASC NULLS FIRST], false, 0
                                       :                                         :                    :                                   +- Exchange hashpartitioning(d_date_sk#4697, 200), ENSURE_REQUIREMENTS, [id=#27962]
                                       :                                         :                    :                                      +- Project [d_date_sk#4697]
                                       :                                         :                    :                                         +- Filter (((isnotnull(d_year#4703) AND (d_year#4703 >= 1999)) AND (d_year#4703 <= 2001)) AND isnotnull(d_date_sk#4697))
                                       :                                         :                    :                                            +- FileScan parquet [d_date_sk#4697,d_year#4703] Batched: true, DataFilters: [isnotnull(d_year#4703), (d_year#4703 >= 1999), (d_year#4703 <= 2001), isnotnull(d_date_sk#4697)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                         :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                                       :                                         :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#27985]
                                       :                                         :                          +- Project [d_date_sk#612]
                                       :                                         :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                                       :                                         :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       :                                         +- Sort [coalesce(i_brand_id#4732, 0) ASC NULLS FIRST, isnull(i_brand_id#4732) ASC NULLS FIRST, coalesce(i_class_id#4734, 0) ASC NULLS FIRST, isnull(i_class_id#4734) ASC NULLS FIRST, coalesce(i_category_id#4736, 0) ASC NULLS FIRST, isnull(i_category_id#4736) ASC NULLS FIRST], false, 0
                                       :                                            +- Exchange hashpartitioning(coalesce(i_brand_id#4732, 0), isnull(i_brand_id#4732), coalesce(i_class_id#4734, 0), isnull(i_class_id#4734), coalesce(i_category_id#4736, 0), isnull(i_category_id#4736), 200), ENSURE_REQUIREMENTS, [id=#28012]
                                       :                                               +- Project [i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                                       :                                                  +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#4747], Inner
                                       :                                                     :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                                       :                                                     :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#28003]
                                       :                                                     :     +- Project [ws_sold_date_sk#476, i_brand_id#4732, i_class_id#4734, i_category_id#4736]
                                       :                                                     :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#4725], Inner
                                       :                                                     :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                                       :                                                     :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#27995]
                                       :                                                     :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                                       :                                                     :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                                       :                                                     :           +- Sort [i_item_sk#4725 ASC NULLS FIRST], false, 0
                                       :                                                     :              +- Exchange hashpartitioning(i_item_sk#4725, 200), ENSURE_REQUIREMENTS, [id=#27996]
                                       :                                                     :                 +- Filter isnotnull(i_item_sk#4725)
                                       :                                                     :                    +- FileScan parquet [i_item_sk#4725,i_brand_id#4732,i_class_id#4734,i_category_id#4736] Batched: true, DataFilters: [isnotnull(i_item_sk#4725)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                                       :                                                     +- Sort [d_date_sk#4747 ASC NULLS FIRST], false, 0
                                       :                                                        +- Exchange hashpartitioning(d_date_sk#4747, 200), ENSURE_REQUIREMENTS, [id=#28004]
                                       :                                                           +- Project [d_date_sk#4747]
                                       :                                                              +- Filter (((isnotnull(d_year#4753) AND (d_year#4753 >= 1999)) AND (d_year#4753 <= 2001)) AND isnotnull(d_date_sk#4747))
                                       :                                                                 +- FileScan parquet [d_date_sk#4747,d_year#4753] Batched: true, DataFilters: [isnotnull(d_year#4753), (d_year#4753 >= 1999), (d_year#4753 <= 2001), isnotnull(d_date_sk#4747)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                       +- Sort [d_date_sk#5163 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date_sk#5163, 200), ENSURE_REQUIREMENTS, [id=#28040]
                                             +- Project [d_date_sk#5163]
                                                +- Filter ((((isnotnull(d_year#5169) AND isnotnull(d_moy#5171)) AND (d_year#5169 = 2001)) AND (d_moy#5171 = 11)) AND isnotnull(d_date_sk#5163))
                                                   +- FileScan parquet [d_date_sk#5163,d_year#5169,d_moy#5171] Batched: true, DataFilters: [isnotnull(d_year#5169), isnotnull(d_moy#5171), (d_year#5169 = 2001), (d_moy#5171 = 11), isnotnul..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), EqualTo(d_year,2001), EqualTo(d_moy,11), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_year:int,d_moy:int>
