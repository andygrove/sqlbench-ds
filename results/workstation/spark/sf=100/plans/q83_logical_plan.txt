GlobalLimit 100
+- LocalLimit 100
   +- Sort [item_id#20813 ASC NULLS FIRST, sr_item_qty#20814L ASC NULLS FIRST], true
      +- Project [item_id#20813, sr_item_qty#20814L, (((cast(sr_item_qty#20814L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS sr_dev#20809, cr_item_qty#20818L, (((cast(cr_item_qty#20818L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS cr_dev#20810, wr_item_qty#20822L, (((cast(wr_item_qty#20822L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS wr_dev#20811, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as decimal(20,0)) as decimal(21,1))) / 3.0), DecimalType(27,6), true) AS average#20812]
         +- Join Inner, (item_id#20813 = item_id#20821)
            :- Project [item_id#20813, sr_item_qty#20814L, cr_item_qty#20818L]
            :  +- Join Inner, (item_id#20813 = item_id#20817)
            :     :- Aggregate [i_item_id#669], [i_item_id#669 AS item_id#20813, sum(sr_return_quantity#146) AS sr_item_qty#20814L]
            :     :  +- Project [sr_return_quantity#146, i_item_id#669]
            :     :     +- Join Inner, (sr_returned_date_sk#136 = d_date_sk#612)
            :     :        :- Project [sr_returned_date_sk#136, sr_return_quantity#146, i_item_id#669]
            :     :        :  +- Join Inner, (sr_item_sk#138 = i_item_sk#668)
            :     :        :     :- Project [sr_returned_date_sk#136, sr_item_sk#138, sr_return_quantity#146]
            :     :        :     :  +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_returned_date_sk#136))
            :     :        :     :     +- Relation [sr_returned_date_sk#136,sr_return_time_sk#137,sr_item_sk#138,sr_customer_sk#139,sr_cdemo_sk#140,sr_hdemo_sk#141,sr_addr_sk#142,sr_store_sk#143,sr_reason_sk#144,sr_ticket_number#145L,sr_return_quantity#146,sr_return_amt#147,sr_return_tax#148,sr_return_amt_inc_tax#149,sr_fee#150,sr_return_ship_cost#151,sr_refunded_cash#152,sr_reversed_charge#153,sr_store_credit#154,sr_net_loss#155] parquet
            :     :        :     +- Project [i_item_sk#668, i_item_id#669]
            :     :        :        +- Filter (isnotnull(i_item_sk#668) AND isnotnull(i_item_id#669))
            :     :        :           +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
            :     :        +- Project [d_date_sk#612]
            :     :           +- Join LeftSemi, (d_date#614 = d_date#21011)
            :     :              :- Project [d_date_sk#612, d_date#614]
            :     :              :  +- Filter isnotnull(d_date_sk#612)
            :     :              :     +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :     :              +- Project [d_date#21011]
            :     :                 +- Join LeftSemi, (d_week_seq#21013 = d_week_seq#20929)
            :     :                    :- Project [d_date#21011, d_week_seq#21013]
            :     :                    :  +- Relation [d_date_sk#21009,d_date_id#21010,d_date#21011,d_month_seq#21012,d_week_seq#21013,d_quarter_seq#21014,d_year#21015,d_dow#21016,d_moy#21017,d_dom#21018,d_qoy#21019,d_fy_year#21020,d_fy_quarter_seq#21021,d_fy_week_seq#21022,d_day_name#21023,d_quarter_name#21024,d_holiday#21025,d_weekend#21026,d_following_holiday#21027,d_first_dom#21028,d_last_dom#21029,d_same_day_ly#21030,d_same_day_lq#21031,d_current_day#21032,... 4 more fields] parquet
            :     :                    +- Project [d_week_seq#20929]
            :     :                       +- Filter cast(d_date#20927 as string) IN (1998-02-24,1998-10-12,1998-11-22)
            :     :                          +- Relation [d_date_sk#20925,d_date_id#20926,d_date#20927,d_month_seq#20928,d_week_seq#20929,d_quarter_seq#20930,d_year#20931,d_dow#20932,d_moy#20933,d_dom#20934,d_qoy#20935,d_fy_year#20936,d_fy_quarter_seq#20937,d_fy_week_seq#20938,d_day_name#20939,d_quarter_name#20940,d_holiday#20941,d_weekend#20942,d_following_holiday#20943,d_first_dom#20944,d_last_dom#20945,d_same_day_ly#20946,d_same_day_lq#20947,d_current_day#20948,... 4 more fields] parquet
            :     +- Aggregate [i_item_id#20826], [i_item_id#20826 AS item_id#20817, sum(cr_return_quantity#363) AS cr_item_qty#20818L]
            :        +- Project [cr_return_quantity#363, i_item_id#20826]
            :           +- Join Inner, (cr_returned_date_sk#346 = d_date_sk#20847)
            :              :- Project [cr_returned_date_sk#346, cr_return_quantity#363, i_item_id#20826]
            :              :  +- Join Inner, (cr_item_sk#348 = i_item_sk#20825)
            :              :     :- Project [cr_returned_date_sk#346, cr_item_sk#348, cr_return_quantity#363]
            :              :     :  +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_returned_date_sk#346))
            :              :     :     +- Relation [cr_returned_date_sk#346,cr_returned_time_sk#347,cr_item_sk#348,cr_refunded_customer_sk#349,cr_refunded_cdemo_sk#350,cr_refunded_hdemo_sk#351,cr_refunded_addr_sk#352,cr_returning_customer_sk#353,cr_returning_cdemo_sk#354,cr_returning_hdemo_sk#355,cr_returning_addr_sk#356,cr_call_center_sk#357,cr_catalog_page_sk#358,cr_ship_mode_sk#359,cr_warehouse_sk#360,cr_reason_sk#361,cr_order_number#362L,cr_return_quantity#363,cr_return_amount#364,cr_return_tax#365,cr_return_amt_inc_tax#366,cr_fee#367,cr_return_ship_cost#368,cr_refunded_cash#369,... 3 more fields] parquet
            :              :     +- Project [i_item_sk#20825, i_item_id#20826]
            :              :        +- Filter (isnotnull(i_item_sk#20825) AND isnotnull(i_item_id#20826))
            :              :           +- Relation [i_item_sk#20825,i_item_id#20826,i_rec_start_date#20827,i_rec_end_date#20828,i_item_desc#20829,i_current_price#20830,i_wholesale_cost#20831,i_brand_id#20832,i_brand#20833,i_class_id#20834,i_class#20835,i_category_id#20836,i_category#20837,i_manufact_id#20838,i_manufact#20839,i_size#20840,i_formulation#20841,i_color#20842,i_units#20843,i_container#20844,i_manager_id#20845,i_product_name#20846] parquet
            :              +- Project [d_date_sk#20847]
            :                 +- Join LeftSemi, (d_date#20849 = d_date#21039)
            :                    :- Project [d_date_sk#20847, d_date#20849]
            :                    :  +- Filter isnotnull(d_date_sk#20847)
            :                    :     +- Relation [d_date_sk#20847,d_date_id#20848,d_date#20849,d_month_seq#20850,d_week_seq#20851,d_quarter_seq#20852,d_year#20853,d_dow#20854,d_moy#20855,d_dom#20856,d_qoy#20857,d_fy_year#20858,d_fy_quarter_seq#20859,d_fy_week_seq#20860,d_day_name#20861,d_quarter_name#20862,d_holiday#20863,d_weekend#20864,d_following_holiday#20865,d_first_dom#20866,d_last_dom#20867,d_same_day_ly#20868,d_same_day_lq#20869,d_current_day#20870,... 4 more fields] parquet
            :                    +- Project [d_date#21039]
            :                       +- Join LeftSemi, (d_week_seq#21041 = d_week_seq#20957)
            :                          :- Project [d_date#21039, d_week_seq#21041]
            :                          :  +- Relation [d_date_sk#21037,d_date_id#21038,d_date#21039,d_month_seq#21040,d_week_seq#21041,d_quarter_seq#21042,d_year#21043,d_dow#21044,d_moy#21045,d_dom#21046,d_qoy#21047,d_fy_year#21048,d_fy_quarter_seq#21049,d_fy_week_seq#21050,d_day_name#21051,d_quarter_name#21052,d_holiday#21053,d_weekend#21054,d_following_holiday#21055,d_first_dom#21056,d_last_dom#21057,d_same_day_ly#21058,d_same_day_lq#21059,d_current_day#21060,... 4 more fields] parquet
            :                          +- Project [d_week_seq#20957]
            :                             +- Filter cast(d_date#20955 as string) IN (1998-02-24,1998-10-12,1998-11-22)
            :                                +- Relation [d_date_sk#20953,d_date_id#20954,d_date#20955,d_month_seq#20956,d_week_seq#20957,d_quarter_seq#20958,d_year#20959,d_dow#20960,d_moy#20961,d_dom#20962,d_qoy#20963,d_fy_year#20964,d_fy_quarter_seq#20965,d_fy_week_seq#20966,d_day_name#20967,d_quarter_name#20968,d_holiday#20969,d_weekend#20970,d_following_holiday#20971,d_first_dom#20972,d_last_dom#20973,d_same_day_ly#20974,d_same_day_lq#20975,d_current_day#20976,... 4 more fields] parquet
            +- Aggregate [i_item_id#20876], [i_item_id#20876 AS item_id#20821, sum(wr_return_quantity#312) AS wr_item_qty#20822L]
               +- Project [wr_return_quantity#312, i_item_id#20876]
                  +- Join Inner, (wr_returned_date_sk#298 = d_date_sk#20897)
                     :- Project [wr_returned_date_sk#298, wr_return_quantity#312, i_item_id#20876]
                     :  +- Join Inner, (wr_item_sk#300 = i_item_sk#20875)
                     :     :- Project [wr_returned_date_sk#298, wr_item_sk#300, wr_return_quantity#312]
                     :     :  +- Filter (isnotnull(wr_item_sk#300) AND isnotnull(wr_returned_date_sk#298))
                     :     :     +- Relation [wr_returned_date_sk#298,wr_returned_time_sk#299,wr_item_sk#300,wr_refunded_customer_sk#301,wr_refunded_cdemo_sk#302,wr_refunded_hdemo_sk#303,wr_refunded_addr_sk#304,wr_returning_customer_sk#305,wr_returning_cdemo_sk#306,wr_returning_hdemo_sk#307,wr_returning_addr_sk#308,wr_web_page_sk#309,wr_reason_sk#310,wr_order_number#311L,wr_return_quantity#312,wr_return_amt#313,wr_return_tax#314,wr_return_amt_inc_tax#315,wr_fee#316,wr_return_ship_cost#317,wr_refunded_cash#318,wr_reversed_charge#319,wr_account_credit#320,wr_net_loss#321] parquet
                     :     +- Project [i_item_sk#20875, i_item_id#20876]
                     :        +- Filter (isnotnull(i_item_sk#20875) AND isnotnull(i_item_id#20876))
                     :           +- Relation [i_item_sk#20875,i_item_id#20876,i_rec_start_date#20877,i_rec_end_date#20878,i_item_desc#20879,i_current_price#20880,i_wholesale_cost#20881,i_brand_id#20882,i_brand#20883,i_class_id#20884,i_class#20885,i_category_id#20886,i_category#20887,i_manufact_id#20888,i_manufact#20889,i_size#20890,i_formulation#20891,i_color#20892,i_units#20893,i_container#20894,i_manager_id#20895,i_product_name#20896] parquet
                     +- Project [d_date_sk#20897]
                        +- Join LeftSemi, (d_date#20899 = d_date#21067)
                           :- Project [d_date_sk#20897, d_date#20899]
                           :  +- Filter isnotnull(d_date_sk#20897)
                           :     +- Relation [d_date_sk#20897,d_date_id#20898,d_date#20899,d_month_seq#20900,d_week_seq#20901,d_quarter_seq#20902,d_year#20903,d_dow#20904,d_moy#20905,d_dom#20906,d_qoy#20907,d_fy_year#20908,d_fy_quarter_seq#20909,d_fy_week_seq#20910,d_day_name#20911,d_quarter_name#20912,d_holiday#20913,d_weekend#20914,d_following_holiday#20915,d_first_dom#20916,d_last_dom#20917,d_same_day_ly#20918,d_same_day_lq#20919,d_current_day#20920,... 4 more fields] parquet
                           +- Project [d_date#21067]
                              +- Join LeftSemi, (d_week_seq#21069 = d_week_seq#20985)
                                 :- Project [d_date#21067, d_week_seq#21069]
                                 :  +- Relation [d_date_sk#21065,d_date_id#21066,d_date#21067,d_month_seq#21068,d_week_seq#21069,d_quarter_seq#21070,d_year#21071,d_dow#21072,d_moy#21073,d_dom#21074,d_qoy#21075,d_fy_year#21076,d_fy_quarter_seq#21077,d_fy_week_seq#21078,d_day_name#21079,d_quarter_name#21080,d_holiday#21081,d_weekend#21082,d_following_holiday#21083,d_first_dom#21084,d_last_dom#21085,d_same_day_ly#21086,d_same_day_lq#21087,d_current_day#21088,... 4 more fields] parquet
                                 +- Project [d_week_seq#20985]
                                    +- Filter cast(d_date#20983 as string) IN (1998-02-24,1998-10-12,1998-11-22)
                                       +- Relation [d_date_sk#20981,d_date_id#20982,d_date#20983,d_month_seq#20984,d_week_seq#20985,d_quarter_seq#20986,d_year#20987,d_dow#20988,d_moy#20989,d_dom#20990,d_qoy#20991,d_fy_year#20992,d_fy_quarter_seq#20993,d_fy_week_seq#20994,d_day_name#20995,d_quarter_name#20996,d_holiday#20997,d_weekend#20998,d_following_holiday#20999,d_first_dom#21000,d_last_dom#21001,d_same_day_ly#21002,d_same_day_lq#21003,d_current_day#21004,... 4 more fields] parquet
