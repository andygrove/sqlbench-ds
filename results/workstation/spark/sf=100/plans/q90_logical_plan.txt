Project [CheckOverflow((promote_precision(cast(amc#21939L as decimal(15,4))) / promote_precision(cast(pmc#21940L as decimal(15,4)))), DecimalType(35,20), true) AS am_pm_ratio#21941]
+- Join Inner
   :- Aggregate [count(1) AS amc#21939L]
   :  +- Project
   :     +- Join Inner, (ws_web_page_sk#488 = wp_web_page_sk#176)
   :        :- Project [ws_web_page_sk#488]
   :        :  +- Join Inner, (ws_sold_time_sk#477 = t_time_sk#456)
   :        :     :- Project [ws_sold_time_sk#477, ws_web_page_sk#488]
   :        :     :  +- Join Inner, (ws_ship_hdemo_sk#486 = hd_demo_sk#88)
   :        :     :     :- Project [ws_sold_time_sk#477, ws_ship_hdemo_sk#486, ws_web_page_sk#488]
   :        :     :     :  +- Filter (isnotnull(ws_ship_hdemo_sk#486) AND (isnotnull(ws_sold_time_sk#477) AND isnotnull(ws_web_page_sk#488)))
   :        :     :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
   :        :     :     +- Project [hd_demo_sk#88]
   :        :     :        +- Filter ((isnotnull(hd_dep_count#91) AND (hd_dep_count#91 = 6)) AND isnotnull(hd_demo_sk#88))
   :        :     :           +- Relation [hd_demo_sk#88,hd_income_band_sk#89,hd_buy_potential#90,hd_dep_count#91,hd_vehicle_count#92] parquet
   :        :     +- Project [t_time_sk#456]
   :        :        +- Filter ((isnotnull(t_hour#459) AND ((t_hour#459 >= 10) AND (t_hour#459 <= 11))) AND isnotnull(t_time_sk#456))
   :        :           +- Relation [t_time_sk#456,t_time_id#457,t_time#458,t_hour#459,t_minute#460,t_second#461,t_am_pm#462,t_shift#463,t_sub_shift#464,t_meal_time#465] parquet
   :        +- Project [wp_web_page_sk#176]
   :           +- Filter ((isnotnull(wp_char_count#186) AND ((wp_char_count#186 >= 5000) AND (wp_char_count#186 <= 5200))) AND isnotnull(wp_web_page_sk#176))
   :              +- Relation [wp_web_page_sk#176,wp_web_page_id#177,wp_rec_start_date#178,wp_rec_end_date#179,wp_creation_date_sk#180,wp_access_date_sk#181,wp_autogen_flag#182,wp_customer_sk#183,wp_url#184,wp_type#185,wp_char_count#186,wp_link_count#187,wp_image_count#188,wp_max_ad_count#189] parquet
   +- Aggregate [count(1) AS pmc#21940L]
      +- Project
         +- Join Inner, (ws_web_page_sk#21954 = wp_web_page_sk#21991)
            :- Project [ws_web_page_sk#21954]
            :  +- Join Inner, (ws_sold_time_sk#21943 = t_time_sk#21981)
            :     :- Project [ws_sold_time_sk#21943, ws_web_page_sk#21954]
            :     :  +- Join Inner, (ws_ship_hdemo_sk#21952 = hd_demo_sk#21976)
            :     :     :- Project [ws_sold_time_sk#21943, ws_ship_hdemo_sk#21952, ws_web_page_sk#21954]
            :     :     :  +- Filter (isnotnull(ws_ship_hdemo_sk#21952) AND (isnotnull(ws_sold_time_sk#21943) AND isnotnull(ws_web_page_sk#21954)))
            :     :     :     +- Relation [ws_sold_date_sk#21942,ws_sold_time_sk#21943,ws_ship_date_sk#21944,ws_item_sk#21945,ws_bill_customer_sk#21946,ws_bill_cdemo_sk#21947,ws_bill_hdemo_sk#21948,ws_bill_addr_sk#21949,ws_ship_customer_sk#21950,ws_ship_cdemo_sk#21951,ws_ship_hdemo_sk#21952,ws_ship_addr_sk#21953,ws_web_page_sk#21954,ws_web_site_sk#21955,ws_ship_mode_sk#21956,ws_warehouse_sk#21957,ws_promo_sk#21958,ws_order_number#21959L,ws_quantity#21960,ws_wholesale_cost#21961,ws_list_price#21962,ws_sales_price#21963,ws_ext_discount_amt#21964,ws_ext_sales_price#21965,... 10 more fields] parquet
            :     :     +- Project [hd_demo_sk#21976]
            :     :        +- Filter ((isnotnull(hd_dep_count#21979) AND (hd_dep_count#21979 = 6)) AND isnotnull(hd_demo_sk#21976))
            :     :           +- Relation [hd_demo_sk#21976,hd_income_band_sk#21977,hd_buy_potential#21978,hd_dep_count#21979,hd_vehicle_count#21980] parquet
            :     +- Project [t_time_sk#21981]
            :        +- Filter ((isnotnull(t_hour#21984) AND ((t_hour#21984 >= 18) AND (t_hour#21984 <= 19))) AND isnotnull(t_time_sk#21981))
            :           +- Relation [t_time_sk#21981,t_time_id#21982,t_time#21983,t_hour#21984,t_minute#21985,t_second#21986,t_am_pm#21987,t_shift#21988,t_sub_shift#21989,t_meal_time#21990] parquet
            +- Project [wp_web_page_sk#21991]
               +- Filter ((isnotnull(wp_char_count#22001) AND ((wp_char_count#22001 >= 5000) AND (wp_char_count#22001 <= 5200))) AND isnotnull(wp_web_page_sk#21991))
                  +- Relation [wp_web_page_sk#21991,wp_web_page_id#21992,wp_rec_start_date#21993,wp_rec_end_date#21994,wp_creation_date_sk#21995,wp_access_date_sk#21996,wp_autogen_flag#21997,wp_customer_sk#21998,wp_url#21999,wp_type#22000,wp_char_count#22001,wp_link_count#22002,wp_image_count#22003,wp_max_ad_count#22004] parquet
