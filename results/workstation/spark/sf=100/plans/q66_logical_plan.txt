GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#772 ASC NULLS FIRST], true
      +- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#15228, year#15229], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ship_carriers#15228, year#15229, sum(jan_sales#15230) AS jan_sales#15280, sum(feb_sales#15231) AS feb_sales#15281, sum(mar_sales#15232) AS mar_sales#15282, sum(apr_sales#15233) AS apr_sales#15283, sum(may_sales#15234) AS may_sales#15284, sum(jun_sales#15235) AS jun_sales#15285, sum(jul_sales#15236) AS jul_sales#15286, sum(aug_sales#15237) AS aug_sales#15287, sum(sep_sales#15238) AS sep_sales#15288, sum(oct_sales#15239) AS oct_sales#15289, sum(nov_sales#15240) AS nov_sales#15290, sum(dec_sales#15241) AS dec_sales#15291, sum(CheckOverflow((promote_precision(jan_sales#15230) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS jan_sales_per_sq_foot#15292, sum(CheckOverflow((promote_precision(feb_sales#15231) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS feb_sales_per_sq_foot#15293, sum(CheckOverflow((promote_precision(mar_sales#15232) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS mar_sales_per_sq_foot#15294, sum(CheckOverflow((promote_precision(apr_sales#15233) / promote_precision(cast(cast(w_warehouse_sq_ft#773 as decimal(10,0)) as decimal(28,2)))), DecimalType(38,12), true)) AS apr_sales_per_sq_foot#15295, ... 20 more fields]
         +- Union false, false
            :- Aggregate [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618], [w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, ZHOU,MSC AS ship_carriers#15228, d_year#618 AS year#15229, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#15230, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#15231, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#15232, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#15233, sum(CASE WHEN (d_moy#620 = 5) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#15234, sum(CASE WHEN (d_moy#620 = 6) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#15235, sum(CASE WHEN (d_moy#620 = 7) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#15236, sum(CASE WHEN (d_moy#620 = 8) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#15237, sum(CASE WHEN (d_moy#620 = 9) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#15238, sum(CASE WHEN (d_moy#620 = 10) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#15239, sum(CASE WHEN (d_moy#620 = 11) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#15240, sum(CASE WHEN (d_moy#620 = 12) THEN CheckOverflow((promote_precision(cast(ws_sales_price#497 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#15241, sum(CASE WHEN (d_moy#620 = 1) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#15242, sum(CASE WHEN (d_moy#620 = 2) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#15243, sum(CASE WHEN (d_moy#620 = 3) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#15244, sum(CASE WHEN (d_moy#620 = 4) THEN CheckOverflow((promote_precision(cast(ws_net_paid_inc_tax#506 as decimal(12,2))) * promote_precision(cast(cast(ws_quantity#494 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#15245, ... 8 more fields]
            :  +- Project [ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :     +- Join Inner, (ws_ship_mode_sk#490 = sm_ship_mode_sk#444)
            :        :- Project [ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :        :  +- Join Inner, (ws_sold_time_sk#477 = t_time_sk#456)
            :        :     :- Project [ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782, d_year#618, d_moy#620]
            :        :     :  +- Join Inner, (ws_sold_date_sk#476 = d_date_sk#612)
            :        :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :  +- Join Inner, (ws_warehouse_sk#491 = w_warehouse_sk#770)
            :        :     :     :     :- Project [ws_sold_date_sk#476, ws_sold_time_sk#477, ws_ship_mode_sk#490, ws_warehouse_sk#491, ws_quantity#494, ws_sales_price#497, ws_net_paid_inc_tax#506]
            :        :     :     :     :  +- Filter ((isnotnull(ws_warehouse_sk#491) AND isnotnull(ws_sold_date_sk#476)) AND (isnotnull(ws_sold_time_sk#477) AND isnotnull(ws_ship_mode_sk#490)))
            :        :     :     :     :     +- Relation [ws_sold_date_sk#476,ws_sold_time_sk#477,ws_ship_date_sk#478,ws_item_sk#479,ws_bill_customer_sk#480,ws_bill_cdemo_sk#481,ws_bill_hdemo_sk#482,ws_bill_addr_sk#483,ws_ship_customer_sk#484,ws_ship_cdemo_sk#485,ws_ship_hdemo_sk#486,ws_ship_addr_sk#487,ws_web_page_sk#488,ws_web_site_sk#489,ws_ship_mode_sk#490,ws_warehouse_sk#491,ws_promo_sk#492,ws_order_number#493L,ws_quantity#494,ws_wholesale_cost#495,ws_list_price#496,ws_sales_price#497,ws_ext_discount_amt#498,ws_ext_sales_price#499,... 10 more fields] parquet
            :        :     :     :     +- Project [w_warehouse_sk#770, w_warehouse_name#772, w_warehouse_sq_ft#773, w_city#778, w_county#779, w_state#780, w_country#782]
            :        :     :     :        +- Filter isnotnull(w_warehouse_sk#770)
            :        :     :     :           +- Relation [w_warehouse_sk#770,w_warehouse_id#771,w_warehouse_name#772,w_warehouse_sq_ft#773,w_street_number#774,w_street_name#775,w_street_type#776,w_suite_number#777,w_city#778,w_county#779,w_state#780,w_zip#781,w_country#782,w_gmt_offset#783] parquet
            :        :     :     +- Project [d_date_sk#612, d_year#618, d_moy#620]
            :        :     :        +- Filter ((isnotnull(d_year#618) AND (d_year#618 = 2000)) AND isnotnull(d_date_sk#612))
            :        :     :           +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
            :        :     +- Project [t_time_sk#456]
            :        :        +- Filter ((isnotnull(t_time#458) AND ((t_time#458 >= 12143) AND (t_time#458 <= 40943))) AND isnotnull(t_time_sk#456))
            :        :           +- Relation [t_time_sk#456,t_time_id#457,t_time#458,t_hour#459,t_minute#460,t_second#461,t_am_pm#462,t_shift#463,t_sub_shift#464,t_meal_time#465] parquet
            :        +- Project [sm_ship_mode_sk#444]
            :           +- Filter (sm_carrier#448 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#444))
            :              +- Relation [sm_ship_mode_sk#444,sm_ship_mode_id#445,sm_type#446,sm_code#447,sm_carrier#448,sm_contract#449] parquet
            +- Aggregate [w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328, d_year#15336], [w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328, ZHOU,MSC AS ship_carriers#15254, d_year#15336 AS year#15255, sum(CASE WHEN (d_moy#15338 = 1) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_sales#15256, sum(CASE WHEN (d_moy#15338 = 2) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_sales#15257, sum(CASE WHEN (d_moy#15338 = 3) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_sales#15258, sum(CASE WHEN (d_moy#15338 = 4) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_sales#15259, sum(CASE WHEN (d_moy#15338 = 5) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS may_sales#15260, sum(CASE WHEN (d_moy#15338 = 6) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jun_sales#15261, sum(CASE WHEN (d_moy#15338 = 7) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jul_sales#15262, sum(CASE WHEN (d_moy#15338 = 8) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS aug_sales#15263, sum(CASE WHEN (d_moy#15338 = 9) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS sep_sales#15264, sum(CASE WHEN (d_moy#15338 = 10) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS oct_sales#15265, sum(CASE WHEN (d_moy#15338 = 11) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS nov_sales#15266, sum(CASE WHEN (d_moy#15338 = 12) THEN CheckOverflow((promote_precision(cast(cs_ext_list_price#569 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS dec_sales#15267, sum(CASE WHEN (d_moy#15338 = 1) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS jan_net#15268, sum(CASE WHEN (d_moy#15338 = 2) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS feb_net#15269, sum(CASE WHEN (d_moy#15338 = 3) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS mar_net#15270, sum(CASE WHEN (d_moy#15338 = 4) THEN CheckOverflow((promote_precision(cast(cs_net_paid_inc_tax#574 as decimal(12,2))) * promote_precision(cast(cast(cs_quantity#562 as decimal(10,0)) as decimal(12,2)))), DecimalType(18,2), true) ELSE 0.00 END) AS apr_net#15271, ... 8 more fields]
               +- Project [cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328, d_year#15336, d_moy#15338]
                  +- Join Inner, (cs_ship_mode_sk#557 = sm_ship_mode_sk#15368)
                     :- Project [cs_ship_mode_sk#557, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328, d_year#15336, d_moy#15338]
                     :  +- Join Inner, (cs_sold_time_sk#545 = t_time_sk#15358)
                     :     :- Project [cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328, d_year#15336, d_moy#15338]
                     :     :  +- Join Inner, (cs_sold_date_sk#544 = d_date_sk#15330)
                     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574, w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328]
                     :     :     :  +- Join Inner, (cs_warehouse_sk#558 = w_warehouse_sk#15316)
                     :     :     :     :- Project [cs_sold_date_sk#544, cs_sold_time_sk#545, cs_ship_mode_sk#557, cs_warehouse_sk#558, cs_quantity#562, cs_ext_list_price#569, cs_net_paid_inc_tax#574]
                     :     :     :     :  +- Filter ((isnotnull(cs_warehouse_sk#558) AND isnotnull(cs_sold_date_sk#544)) AND (isnotnull(cs_sold_time_sk#545) AND isnotnull(cs_ship_mode_sk#557)))
                     :     :     :     :     +- Relation [cs_sold_date_sk#544,cs_sold_time_sk#545,cs_ship_date_sk#546,cs_bill_customer_sk#547,cs_bill_cdemo_sk#548,cs_bill_hdemo_sk#549,cs_bill_addr_sk#550,cs_ship_customer_sk#551,cs_ship_cdemo_sk#552,cs_ship_hdemo_sk#553,cs_ship_addr_sk#554,cs_call_center_sk#555,cs_catalog_page_sk#556,cs_ship_mode_sk#557,cs_warehouse_sk#558,cs_item_sk#559,cs_promo_sk#560,cs_order_number#561L,cs_quantity#562,cs_wholesale_cost#563,cs_list_price#564,cs_sales_price#565,cs_ext_discount_amt#566,cs_ext_sales_price#567,... 10 more fields] parquet
                     :     :     :     +- Project [w_warehouse_sk#15316, w_warehouse_name#15318, w_warehouse_sq_ft#15319, w_city#15324, w_county#15325, w_state#15326, w_country#15328]
                     :     :     :        +- Filter isnotnull(w_warehouse_sk#15316)
                     :     :     :           +- Relation [w_warehouse_sk#15316,w_warehouse_id#15317,w_warehouse_name#15318,w_warehouse_sq_ft#15319,w_street_number#15320,w_street_name#15321,w_street_type#15322,w_suite_number#15323,w_city#15324,w_county#15325,w_state#15326,w_zip#15327,w_country#15328,w_gmt_offset#15329] parquet
                     :     :     +- Project [d_date_sk#15330, d_year#15336, d_moy#15338]
                     :     :        +- Filter ((isnotnull(d_year#15336) AND (d_year#15336 = 2000)) AND isnotnull(d_date_sk#15330))
                     :     :           +- Relation [d_date_sk#15330,d_date_id#15331,d_date#15332,d_month_seq#15333,d_week_seq#15334,d_quarter_seq#15335,d_year#15336,d_dow#15337,d_moy#15338,d_dom#15339,d_qoy#15340,d_fy_year#15341,d_fy_quarter_seq#15342,d_fy_week_seq#15343,d_day_name#15344,d_quarter_name#15345,d_holiday#15346,d_weekend#15347,d_following_holiday#15348,d_first_dom#15349,d_last_dom#15350,d_same_day_ly#15351,d_same_day_lq#15352,d_current_day#15353,... 4 more fields] parquet
                     :     +- Project [t_time_sk#15358]
                     :        +- Filter ((isnotnull(t_time#15360) AND ((t_time#15360 >= 12143) AND (t_time#15360 <= 40943))) AND isnotnull(t_time_sk#15358))
                     :           +- Relation [t_time_sk#15358,t_time_id#15359,t_time#15360,t_hour#15361,t_minute#15362,t_second#15363,t_am_pm#15364,t_shift#15365,t_sub_shift#15366,t_meal_time#15367] parquet
                     +- Project [sm_ship_mode_sk#15368]
                        +- Filter (sm_carrier#15372 IN (ZHOU,MSC) AND isnotnull(sm_ship_mode_sk#15368))
                           +- Relation [sm_ship_mode_sk#15368,sm_ship_mode_id#15369,sm_type#15370,sm_code#15371,sm_carrier#15372,sm_contract#15373] parquet
