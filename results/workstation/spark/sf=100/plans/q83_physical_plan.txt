AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#20813 ASC NULLS FIRST,sr_item_qty#20814L ASC NULLS FIRST], output=[item_id#20813,sr_item_qty#20814L,sr_dev#20809,cr_item_qty#20818L,cr_dev#20810,wr_item_qty#20822L,wr_dev#20811,average#20812])
   +- *(56) Project [item_id#20813, sr_item_qty#20814L, (((cast(sr_item_qty#20814L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS sr_dev#20809, cr_item_qty#20818L, (((cast(cr_item_qty#20818L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS cr_dev#20810, wr_item_qty#20822L, (((cast(wr_item_qty#20822L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS wr_dev#20811, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as decimal(20,0)) as decimal(21,1))) / 3.0), DecimalType(27,6), true) AS average#20812]
      +- *(56) SortMergeJoin [item_id#20813], [item_id#20821], Inner
         :- *(54) Project [item_id#20813, sr_item_qty#20814L, cr_item_qty#20818L]
         :  +- *(54) SortMergeJoin [item_id#20813], [item_id#20817], Inner
         :     :- *(52) Sort [item_id#20813 ASC NULLS FIRST], false, 0
         :     :  +- *(52) HashAggregate(keys=[i_item_id#669], functions=[sum(sr_return_quantity#146)], output=[item_id#20813, sr_item_qty#20814L])
         :     :     +- AQEShuffleRead coalesced
         :     :        +- ShuffleQueryStage 36
         :     :           +- Exchange hashpartitioning(i_item_id#669, 200), ENSURE_REQUIREMENTS, [id=#256992]
         :     :              +- *(45) HashAggregate(keys=[i_item_id#669], functions=[partial_sum(sr_return_quantity#146)], output=[i_item_id#669, sum#21105L])
         :     :                 +- *(45) Project [sr_return_quantity#146, i_item_id#669]
         :     :                    +- *(45) SortMergeJoin [sr_returned_date_sk#136], [d_date_sk#612], Inner
         :     :                       :- *(43) Sort [sr_returned_date_sk#136 ASC NULLS FIRST], false, 0
         :     :                       :  +- AQEShuffleRead coalesced
         :     :                       :     +- ShuffleQueryStage 23
         :     :                       :        +- Exchange hashpartitioning(sr_returned_date_sk#136, 200), ENSURE_REQUIREMENTS, [id=#255348]
         :     :                       :           +- *(18) Project [sr_returned_date_sk#136, sr_return_quantity#146, i_item_id#669]
         :     :                       :              +- *(18) SortMergeJoin [sr_item_sk#138], [i_item_sk#668], Inner
         :     :                       :                 :- *(16) Sort [sr_item_sk#138 ASC NULLS FIRST], false, 0
         :     :                       :                 :  +- AQEShuffleRead coalesced
         :     :                       :                 :     +- ShuffleQueryStage 0
         :     :                       :                 :        +- Exchange hashpartitioning(sr_item_sk#138, 200), ENSURE_REQUIREMENTS, [id=#254289]
         :     :                       :                 :           +- *(1) Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_returned_date_sk#136))
         :     :                       :                 :              +- *(1) ColumnarToRow
         :     :                       :                 :                 +- FileScan parquet [sr_returned_date_sk#136,sr_item_sk#138,sr_return_quantity#146] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_returned_date_sk#136)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_returned_date_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_return_quantity:int>
         :     :                       :                 +- *(17) Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
         :     :                       :                    +- AQEShuffleRead coalesced
         :     :                       :                       +- ShuffleQueryStage 1
         :     :                       :                          +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#254306]
         :     :                       :                             +- *(2) Filter (isnotnull(i_item_sk#668) AND isnotnull(i_item_id#669))
         :     :                       :                                +- *(2) ColumnarToRow
         :     :                       :                                   +- FileScan parquet [i_item_sk#668,i_item_id#669] Batched: true, DataFilters: [isnotnull(i_item_sk#668), isnotnull(i_item_id#669)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                       +- *(44) Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :     :                          +- AQEShuffleRead coalesced
         :     :                             +- ShuffleQueryStage 31
         :     :                                +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#256415]
         :     :                                   +- *(36) Project [d_date_sk#612]
         :     :                                      +- *(36) SortMergeJoin [d_date#614], [d_date#21011], LeftSemi
         :     :                                         :- *(34) Sort [d_date#614 ASC NULLS FIRST], false, 0
         :     :                                         :  +- AQEShuffleRead coalesced
         :     :                                         :     +- ShuffleQueryStage 2
         :     :                                         :        +- Exchange hashpartitioning(d_date#614, 200), ENSURE_REQUIREMENTS, [id=#254327]
         :     :                                         :           +- *(3) Filter isnotnull(d_date_sk#612)
         :     :                                         :              +- *(3) ColumnarToRow
         :     :                                         :                 +- FileScan parquet [d_date_sk#612,d_date#614] Batched: true, DataFilters: [isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                                         +- *(35) Sort [d_date#21011 ASC NULLS FIRST], false, 0
         :     :                                            +- AQEShuffleRead coalesced
         :     :                                               +- ShuffleQueryStage 24
         :     :                                                  +- Exchange hashpartitioning(d_date#21011, 200), ENSURE_REQUIREMENTS, [id=#255624]
         :     :                                                     +- *(21) Project [d_date#21011]
         :     :                                                        +- *(21) SortMergeJoin [d_week_seq#21013], [d_week_seq#20929], LeftSemi
         :     :                                                           :- *(19) Sort [d_week_seq#21013 ASC NULLS FIRST], false, 0
         :     :                                                           :  +- AQEShuffleRead coalesced
         :     :                                                           :     +- ShuffleQueryStage 3
         :     :                                                           :        +- Exchange hashpartitioning(d_week_seq#21013, 200), ENSURE_REQUIREMENTS, [id=#254342]
         :     :                                                           :           +- *(4) ColumnarToRow
         :     :                                                           :              +- FileScan parquet [d_date#21011,d_week_seq#21013] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                                           +- *(20) Sort [d_week_seq#20929 ASC NULLS FIRST], false, 0
         :     :                                                              +- AQEShuffleRead coalesced
         :     :                                                                 +- ShuffleQueryStage 4
         :     :                                                                    +- Exchange hashpartitioning(d_week_seq#20929, 200), ENSURE_REQUIREMENTS, [id=#254359]
         :     :                                                                       +- *(5) Project [d_week_seq#20929]
         :     :                                                                          +- *(5) Filter cast(d_date#20927 as string) IN (1998-02-24,1998-10-12,1998-11-22)
         :     :                                                                             +- *(5) ColumnarToRow
         :     :                                                                                +- FileScan parquet [d_date#20927,d_week_seq#20929] Batched: true, DataFilters: [cast(d_date#20927 as string) IN (1998-02-24,1998-10-12,1998-11-22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- *(53) Sort [item_id#20817 ASC NULLS FIRST], false, 0
         :        +- *(53) HashAggregate(keys=[i_item_id#20826], functions=[sum(cr_return_quantity#363)], output=[item_id#20817, cr_item_qty#20818L])
         :           +- AQEShuffleRead coalesced
         :              +- ShuffleQueryStage 37
         :                 +- Exchange hashpartitioning(i_item_id#20826, 200), ENSURE_REQUIREMENTS, [id=#257037]
         :                    +- *(48) HashAggregate(keys=[i_item_id#20826], functions=[partial_sum(cr_return_quantity#363)], output=[i_item_id#20826, sum#21107L])
         :                       +- *(48) Project [cr_return_quantity#363, i_item_id#20826]
         :                          +- *(48) SortMergeJoin [cr_returned_date_sk#346], [d_date_sk#20847], Inner
         :                             :- *(46) Sort [cr_returned_date_sk#346 ASC NULLS FIRST], false, 0
         :                             :  +- AQEShuffleRead coalesced
         :                             :     +- ShuffleQueryStage 29
         :                             :        +- Exchange hashpartitioning(cr_returned_date_sk#346, 200), ENSURE_REQUIREMENTS, [id=#255989]
         :                             :           +- *(30) Project [cr_returned_date_sk#346, cr_return_quantity#363, i_item_id#20826]
         :                             :              +- *(30) SortMergeJoin [cr_item_sk#348], [i_item_sk#20825], Inner
         :                             :                 :- *(28) Sort [cr_item_sk#348 ASC NULLS FIRST], false, 0
         :                             :                 :  +- AQEShuffleRead coalesced
         :                             :                 :     +- ShuffleQueryStage 5
         :                             :                 :        +- Exchange hashpartitioning(cr_item_sk#348, 200), ENSURE_REQUIREMENTS, [id=#254459]
         :                             :                 :           +- *(6) Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_returned_date_sk#346))
         :                             :                 :              +- *(6) ColumnarToRow
         :                             :                 :                 +- FileScan parquet [cr_returned_date_sk#346,cr_item_sk#348,cr_return_quantity#363] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_returned_date_sk#346)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_item_sk:int,cr_return_quantity:int>
         :                             :                 +- *(29) Sort [i_item_sk#20825 ASC NULLS FIRST], false, 0
         :                             :                    +- AQEShuffleRead coalesced
         :                             :                       +- ShuffleQueryStage 7
         :                             :                          +- ReusedExchange [i_item_sk#20825, i_item_id#20826], Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#254306]
         :                             +- *(47) Sort [d_date_sk#20847 ASC NULLS FIRST], false, 0
         :                                +- AQEShuffleRead coalesced
         :                                   +- ShuffleQueryStage 33
         :                                      +- ReusedExchange [d_date_sk#20847], Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#256415]
         +- *(55) Sort [item_id#20821 ASC NULLS FIRST], false, 0
            +- *(55) HashAggregate(keys=[i_item_id#20876], functions=[sum(wr_return_quantity#312)], output=[item_id#20821, wr_item_qty#20822L])
               +- AQEShuffleRead coalesced
                  +- ShuffleQueryStage 38
                     +- Exchange hashpartitioning(i_item_id#20876, 200), ENSURE_REQUIREMENTS, [id=#257139]
                        +- *(51) HashAggregate(keys=[i_item_id#20876], functions=[partial_sum(wr_return_quantity#312)], output=[i_item_id#20876, sum#21109L])
                           +- *(51) Project [wr_return_quantity#312, i_item_id#20876]
                              +- *(51) SortMergeJoin [wr_returned_date_sk#298], [d_date_sk#20897], Inner
                                 :- *(49) Sort [wr_returned_date_sk#298 ASC NULLS FIRST], false, 0
                                 :  +- AQEShuffleRead coalesced
                                 :     +- ShuffleQueryStage 30
                                 :        +- Exchange hashpartitioning(wr_returned_date_sk#298, 200), ENSURE_REQUIREMENTS, [id=#256224]
                                 :           +- *(33) Project [wr_returned_date_sk#298, wr_return_quantity#312, i_item_id#20876]
                                 :              +- *(33) SortMergeJoin [wr_item_sk#300], [i_item_sk#20875], Inner
                                 :                 :- *(31) Sort [wr_item_sk#300 ASC NULLS FIRST], false, 0
                                 :                 :  +- AQEShuffleRead coalesced
                                 :                 :     +- ShuffleQueryStage 14
                                 :                 :        +- Exchange hashpartitioning(wr_item_sk#300, 200), ENSURE_REQUIREMENTS, [id=#254639]
                                 :                 :           +- *(11) Filter (isnotnull(wr_item_sk#300) AND isnotnull(wr_returned_date_sk#298))
                                 :                 :              +- *(11) ColumnarToRow
                                 :                 :                 +- FileScan parquet [wr_returned_date_sk#298,wr_item_sk#300,wr_return_quantity#312] Batched: true, DataFilters: [isnotnull(wr_item_sk#300), isnotnull(wr_returned_date_sk#298)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_return_quantity:int>
                                 :                 +- *(32) Sort [i_item_sk#20875 ASC NULLS FIRST], false, 0
                                 :                    +- AQEShuffleRead coalesced
                                 :                       +- ShuffleQueryStage 16
                                 :                          +- ReusedExchange [i_item_sk#20875, i_item_id#20876], Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#254306]
                                 +- *(50) Sort [d_date_sk#20897 ASC NULLS FIRST], false, 0
                                    +- AQEShuffleRead coalesced
                                       +- ShuffleQueryStage 35
                                          +- ReusedExchange [d_date_sk#20897], Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#256415]
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[item_id#20813 ASC NULLS FIRST,sr_item_qty#20814L ASC NULLS FIRST], output=[item_id#20813,sr_item_qty#20814L,sr_dev#20809,cr_item_qty#20818L,cr_dev#20810,wr_item_qty#20822L,wr_dev#20811,average#20812])
   +- Project [item_id#20813, sr_item_qty#20814L, (((cast(sr_item_qty#20814L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS sr_dev#20809, cr_item_qty#20818L, (((cast(cr_item_qty#20818L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS cr_dev#20810, wr_item_qty#20822L, (((cast(wr_item_qty#20822L as double) / cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as double)) / 3.0) * 100.0) AS wr_dev#20811, CheckOverflow((promote_precision(cast(cast(((sr_item_qty#20814L + cr_item_qty#20818L) + wr_item_qty#20822L) as decimal(20,0)) as decimal(21,1))) / 3.0), DecimalType(27,6), true) AS average#20812]
      +- SortMergeJoin [item_id#20813], [item_id#20821], Inner
         :- Project [item_id#20813, sr_item_qty#20814L, cr_item_qty#20818L]
         :  +- SortMergeJoin [item_id#20813], [item_id#20817], Inner
         :     :- Sort [item_id#20813 ASC NULLS FIRST], false, 0
         :     :  +- HashAggregate(keys=[i_item_id#669], functions=[sum(sr_return_quantity#146)], output=[item_id#20813, sr_item_qty#20814L])
         :     :     +- Exchange hashpartitioning(i_item_id#669, 200), ENSURE_REQUIREMENTS, [id=#254133]
         :     :        +- HashAggregate(keys=[i_item_id#669], functions=[partial_sum(sr_return_quantity#146)], output=[i_item_id#669, sum#21105L])
         :     :           +- Project [sr_return_quantity#146, i_item_id#669]
         :     :              +- SortMergeJoin [sr_returned_date_sk#136], [d_date_sk#612], Inner
         :     :                 :- Sort [sr_returned_date_sk#136 ASC NULLS FIRST], false, 0
         :     :                 :  +- Exchange hashpartitioning(sr_returned_date_sk#136, 200), ENSURE_REQUIREMENTS, [id=#254125]
         :     :                 :     +- Project [sr_returned_date_sk#136, sr_return_quantity#146, i_item_id#669]
         :     :                 :        +- SortMergeJoin [sr_item_sk#138], [i_item_sk#668], Inner
         :     :                 :           :- Sort [sr_item_sk#138 ASC NULLS FIRST], false, 0
         :     :                 :           :  +- Exchange hashpartitioning(sr_item_sk#138, 200), ENSURE_REQUIREMENTS, [id=#254102]
         :     :                 :           :     +- Filter (isnotnull(sr_item_sk#138) AND isnotnull(sr_returned_date_sk#136))
         :     :                 :           :        +- FileScan parquet [sr_returned_date_sk#136,sr_item_sk#138,sr_return_quantity#146] Batched: true, DataFilters: [isnotnull(sr_item_sk#138), isnotnull(sr_returned_date_sk#136)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(sr_item_sk), IsNotNull(sr_returned_date_sk)], ReadSchema: struct<sr_returned_date_sk:int,sr_item_sk:int,sr_return_quantity:int>
         :     :                 :           +- Sort [i_item_sk#668 ASC NULLS FIRST], false, 0
         :     :                 :              +- Exchange hashpartitioning(i_item_sk#668, 200), ENSURE_REQUIREMENTS, [id=#254103]
         :     :                 :                 +- Filter (isnotnull(i_item_sk#668) AND isnotnull(i_item_id#669))
         :     :                 :                    +- FileScan parquet [i_item_sk#668,i_item_id#669] Batched: true, DataFilters: [isnotnull(i_item_sk#668), isnotnull(i_item_id#669)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :     :                 +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :     :                    +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#254126]
         :     :                       +- Project [d_date_sk#612]
         :     :                          +- SortMergeJoin [d_date#614], [d_date#21011], LeftSemi
         :     :                             :- Sort [d_date#614 ASC NULLS FIRST], false, 0
         :     :                             :  +- Exchange hashpartitioning(d_date#614, 200), ENSURE_REQUIREMENTS, [id=#254117]
         :     :                             :     +- Filter isnotnull(d_date_sk#612)
         :     :                             :        +- FileScan parquet [d_date_sk#612,d_date#614] Batched: true, DataFilters: [isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :     :                             +- Sort [d_date#21011 ASC NULLS FIRST], false, 0
         :     :                                +- Exchange hashpartitioning(d_date#21011, 200), ENSURE_REQUIREMENTS, [id=#254118]
         :     :                                   +- Project [d_date#21011]
         :     :                                      +- SortMergeJoin [d_week_seq#21013], [d_week_seq#20929], LeftSemi
         :     :                                         :- Sort [d_week_seq#21013 ASC NULLS FIRST], false, 0
         :     :                                         :  +- Exchange hashpartitioning(d_week_seq#21013, 200), ENSURE_REQUIREMENTS, [id=#254109]
         :     :                                         :     +- FileScan parquet [d_date#21011,d_week_seq#21013] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     :                                         +- Sort [d_week_seq#20929 ASC NULLS FIRST], false, 0
         :     :                                            +- Exchange hashpartitioning(d_week_seq#20929, 200), ENSURE_REQUIREMENTS, [id=#254110]
         :     :                                               +- Project [d_week_seq#20929]
         :     :                                                  +- Filter cast(d_date#20927 as string) IN (1998-02-24,1998-10-12,1998-11-22)
         :     :                                                     +- FileScan parquet [d_date#20927,d_week_seq#20929] Batched: true, DataFilters: [cast(d_date#20927 as string) IN (1998-02-24,1998-10-12,1998-11-22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :     +- Sort [item_id#20817 ASC NULLS FIRST], false, 0
         :        +- HashAggregate(keys=[i_item_id#20826], functions=[sum(cr_return_quantity#363)], output=[item_id#20817, cr_item_qty#20818L])
         :           +- Exchange hashpartitioning(i_item_id#20826, 200), ENSURE_REQUIREMENTS, [id=#254167]
         :              +- HashAggregate(keys=[i_item_id#20826], functions=[partial_sum(cr_return_quantity#363)], output=[i_item_id#20826, sum#21107L])
         :                 +- Project [cr_return_quantity#363, i_item_id#20826]
         :                    +- SortMergeJoin [cr_returned_date_sk#346], [d_date_sk#20847], Inner
         :                       :- Sort [cr_returned_date_sk#346 ASC NULLS FIRST], false, 0
         :                       :  +- Exchange hashpartitioning(cr_returned_date_sk#346, 200), ENSURE_REQUIREMENTS, [id=#254159]
         :                       :     +- Project [cr_returned_date_sk#346, cr_return_quantity#363, i_item_id#20826]
         :                       :        +- SortMergeJoin [cr_item_sk#348], [i_item_sk#20825], Inner
         :                       :           :- Sort [cr_item_sk#348 ASC NULLS FIRST], false, 0
         :                       :           :  +- Exchange hashpartitioning(cr_item_sk#348, 200), ENSURE_REQUIREMENTS, [id=#254136]
         :                       :           :     +- Filter (isnotnull(cr_item_sk#348) AND isnotnull(cr_returned_date_sk#346))
         :                       :           :        +- FileScan parquet [cr_returned_date_sk#346,cr_item_sk#348,cr_return_quantity#363] Batched: true, DataFilters: [isnotnull(cr_item_sk#348), isnotnull(cr_returned_date_sk#346)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cr_item_sk), IsNotNull(cr_returned_date_sk)], ReadSchema: struct<cr_returned_date_sk:int,cr_item_sk:int,cr_return_quantity:int>
         :                       :           +- Sort [i_item_sk#20825 ASC NULLS FIRST], false, 0
         :                       :              +- Exchange hashpartitioning(i_item_sk#20825, 200), ENSURE_REQUIREMENTS, [id=#254137]
         :                       :                 +- Filter (isnotnull(i_item_sk#20825) AND isnotnull(i_item_id#20826))
         :                       :                    +- FileScan parquet [i_item_sk#20825,i_item_id#20826] Batched: true, DataFilters: [isnotnull(i_item_sk#20825), isnotnull(i_item_id#20826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
         :                       +- Sort [d_date_sk#20847 ASC NULLS FIRST], false, 0
         :                          +- Exchange hashpartitioning(d_date_sk#20847, 200), ENSURE_REQUIREMENTS, [id=#254160]
         :                             +- Project [d_date_sk#20847]
         :                                +- SortMergeJoin [d_date#20849], [d_date#21039], LeftSemi
         :                                   :- Sort [d_date#20849 ASC NULLS FIRST], false, 0
         :                                   :  +- Exchange hashpartitioning(d_date#20849, 200), ENSURE_REQUIREMENTS, [id=#254151]
         :                                   :     +- Filter isnotnull(d_date_sk#20847)
         :                                   :        +- FileScan parquet [d_date_sk#20847,d_date#20849] Batched: true, DataFilters: [isnotnull(d_date_sk#20847)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
         :                                   +- Sort [d_date#21039 ASC NULLS FIRST], false, 0
         :                                      +- Exchange hashpartitioning(d_date#21039, 200), ENSURE_REQUIREMENTS, [id=#254152]
         :                                         +- Project [d_date#21039]
         :                                            +- SortMergeJoin [d_week_seq#21041], [d_week_seq#20957], LeftSemi
         :                                               :- Sort [d_week_seq#21041 ASC NULLS FIRST], false, 0
         :                                               :  +- Exchange hashpartitioning(d_week_seq#21041, 200), ENSURE_REQUIREMENTS, [id=#254143]
         :                                               :     +- FileScan parquet [d_date#21039,d_week_seq#21041] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         :                                               +- Sort [d_week_seq#20957 ASC NULLS FIRST], false, 0
         :                                                  +- Exchange hashpartitioning(d_week_seq#20957, 200), ENSURE_REQUIREMENTS, [id=#254144]
         :                                                     +- Project [d_week_seq#20957]
         :                                                        +- Filter cast(d_date#20955 as string) IN (1998-02-24,1998-10-12,1998-11-22)
         :                                                           +- FileScan parquet [d_date#20955,d_week_seq#20957] Batched: true, DataFilters: [cast(d_date#20955 as string) IN (1998-02-24,1998-10-12,1998-11-22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
         +- Sort [item_id#20821 ASC NULLS FIRST], false, 0
            +- HashAggregate(keys=[i_item_id#20876], functions=[sum(wr_return_quantity#312)], output=[item_id#20821, wr_item_qty#20822L])
               +- Exchange hashpartitioning(i_item_id#20876, 200), ENSURE_REQUIREMENTS, [id=#254207]
                  +- HashAggregate(keys=[i_item_id#20876], functions=[partial_sum(wr_return_quantity#312)], output=[i_item_id#20876, sum#21109L])
                     +- Project [wr_return_quantity#312, i_item_id#20876]
                        +- SortMergeJoin [wr_returned_date_sk#298], [d_date_sk#20897], Inner
                           :- Sort [wr_returned_date_sk#298 ASC NULLS FIRST], false, 0
                           :  +- Exchange hashpartitioning(wr_returned_date_sk#298, 200), ENSURE_REQUIREMENTS, [id=#254199]
                           :     +- Project [wr_returned_date_sk#298, wr_return_quantity#312, i_item_id#20876]
                           :        +- SortMergeJoin [wr_item_sk#300], [i_item_sk#20875], Inner
                           :           :- Sort [wr_item_sk#300 ASC NULLS FIRST], false, 0
                           :           :  +- Exchange hashpartitioning(wr_item_sk#300, 200), ENSURE_REQUIREMENTS, [id=#254176]
                           :           :     +- Filter (isnotnull(wr_item_sk#300) AND isnotnull(wr_returned_date_sk#298))
                           :           :        +- FileScan parquet [wr_returned_date_sk#298,wr_item_sk#300,wr_return_quantity#312] Batched: true, DataFilters: [isnotnull(wr_item_sk#300), isnotnull(wr_returned_date_sk#298)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_returns.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(wr_item_sk), IsNotNull(wr_returned_date_sk)], ReadSchema: struct<wr_returned_date_sk:int,wr_item_sk:int,wr_return_quantity:int>
                           :           +- Sort [i_item_sk#20875 ASC NULLS FIRST], false, 0
                           :              +- Exchange hashpartitioning(i_item_sk#20875, 200), ENSURE_REQUIREMENTS, [id=#254177]
                           :                 +- Filter (isnotnull(i_item_sk#20875) AND isnotnull(i_item_id#20876))
                           :                    +- FileScan parquet [i_item_sk#20875,i_item_id#20876] Batched: true, DataFilters: [isnotnull(i_item_sk#20875), isnotnull(i_item_id#20876)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_item_id)], ReadSchema: struct<i_item_sk:int,i_item_id:string>
                           +- Sort [d_date_sk#20897 ASC NULLS FIRST], false, 0
                              +- Exchange hashpartitioning(d_date_sk#20897, 200), ENSURE_REQUIREMENTS, [id=#254200]
                                 +- Project [d_date_sk#20897]
                                    +- SortMergeJoin [d_date#20899], [d_date#21067], LeftSemi
                                       :- Sort [d_date#20899 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(d_date#20899, 200), ENSURE_REQUIREMENTS, [id=#254191]
                                       :     +- Filter isnotnull(d_date_sk#20897)
                                       :        +- FileScan parquet [d_date_sk#20897,d_date#20899] Batched: true, DataFilters: [isnotnull(d_date_sk#20897)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_date:date>
                                       +- Sort [d_date#21067 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date#21067, 200), ENSURE_REQUIREMENTS, [id=#254192]
                                             +- Project [d_date#21067]
                                                +- SortMergeJoin [d_week_seq#21069], [d_week_seq#20985], LeftSemi
                                                   :- Sort [d_week_seq#21069 ASC NULLS FIRST], false, 0
                                                   :  +- Exchange hashpartitioning(d_week_seq#21069, 200), ENSURE_REQUIREMENTS, [id=#254183]
                                                   :     +- FileScan parquet [d_date#21067,d_week_seq#21069] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
                                                   +- Sort [d_week_seq#20985 ASC NULLS FIRST], false, 0
                                                      +- Exchange hashpartitioning(d_week_seq#20985, 200), ENSURE_REQUIREMENTS, [id=#254184]
                                                         +- Project [d_week_seq#20985]
                                                            +- Filter cast(d_date#20983 as string) IN (1998-02-24,1998-10-12,1998-11-22)
                                                               +- FileScan parquet [d_date#20983,d_week_seq#20985] Batched: true, DataFilters: [cast(d_date#20983 as string) IN (1998-02-24,1998-10-12,1998-11-22)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<d_date:date,d_week_seq:int>
