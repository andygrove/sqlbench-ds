GlobalLimit 100
+- LocalLimit 100
   +- Sort [w_warehouse_name#772 ASC NULLS FIRST, i_item_id#669 ASC NULLS FIRST], true
      +- Filter ((isnotnull(inv_before#7217L) AND isnotnull(inv_after#7218L)) AND (((inv_before#7217L > 0) AND ((cast(inv_after#7218L as double) / cast(inv_before#7217L as double)) >= 0.666667)) AND ((cast(inv_after#7218L as double) / cast(inv_before#7217L as double)) <= 1.5)))
         +- Aggregate [w_warehouse_name#772, i_item_id#669], [w_warehouse_name#772, i_item_id#669, sum(CASE WHEN (d_date#614 < 2000-05-19) THEN inv_quantity_on_hand#439 ELSE 0 END) AS inv_before#7217L, sum(CASE WHEN (d_date#614 >= 2000-05-19) THEN inv_quantity_on_hand#439 ELSE 0 END) AS inv_after#7218L]
            +- Project [inv_quantity_on_hand#439, w_warehouse_name#772, i_item_id#669, d_date#614]
               +- Join Inner, (inv_date_sk#436 = d_date_sk#612)
                  :- Project [inv_date_sk#436, inv_quantity_on_hand#439, w_warehouse_name#772, i_item_id#669]
                  :  +- Join Inner, (i_item_sk#668 = inv_item_sk#437)
                  :     :- Project [inv_date_sk#436, inv_item_sk#437, inv_quantity_on_hand#439, w_warehouse_name#772]
                  :     :  +- Join Inner, (inv_warehouse_sk#438 = w_warehouse_sk#770)
                  :     :     :- Filter (isnotnull(inv_warehouse_sk#438) AND (isnotnull(inv_item_sk#437) AND isnotnull(inv_date_sk#436)))
                  :     :     :  +- Relation [inv_date_sk#436,inv_item_sk#437,inv_warehouse_sk#438,inv_quantity_on_hand#439] parquet
                  :     :     +- Project [w_warehouse_sk#770, w_warehouse_name#772]
                  :     :        +- Filter isnotnull(w_warehouse_sk#770)
                  :     :           +- Relation [w_warehouse_sk#770,w_warehouse_id#771,w_warehouse_name#772,w_warehouse_sq_ft#773,w_street_number#774,w_street_name#775,w_street_type#776,w_suite_number#777,w_city#778,w_county#779,w_state#780,w_zip#781,w_country#782,w_gmt_offset#783] parquet
                  :     +- Project [i_item_sk#668, i_item_id#669]
                  :        +- Filter ((isnotnull(i_current_price#673) AND ((i_current_price#673 >= 0.99) AND (i_current_price#673 <= 1.49))) AND isnotnull(i_item_sk#668))
                  :           +- Relation [i_item_sk#668,i_item_id#669,i_rec_start_date#670,i_rec_end_date#671,i_item_desc#672,i_current_price#673,i_wholesale_cost#674,i_brand_id#675,i_brand#676,i_class_id#677,i_class#678,i_category_id#679,i_category#680,i_manufact_id#681,i_manufact#682,i_size#683,i_formulation#684,i_color#685,i_units#686,i_container#687,i_manager_id#688,i_product_name#689] parquet
                  +- Project [d_date_sk#612, d_date#614]
                     +- Filter ((isnotnull(d_date#614) AND ((d_date#614 >= 2000-04-19) AND (d_date#614 <= 2000-06-18))) AND isnotnull(d_date_sk#612))
                        +- Relation [d_date_sk#612,d_date_id#613,d_date#614,d_month_seq#615,d_week_seq#616,d_quarter_seq#617,d_year#618,d_dow#619,d_moy#620,d_dom#621,d_qoy#622,d_fy_year#623,d_fy_quarter_seq#624,d_fy_week_seq#625,d_day_name#626,d_quarter_name#627,d_holiday#628,d_weekend#629,d_following_holiday#630,d_first_dom#631,d_last_dom#632,d_same_day_ly#633,d_same_day_lq#634,d_current_day#635,... 4 more fields] parquet
