AdaptiveSparkPlan isFinalPlan=true
+- == Final Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#5811 ASC NULLS FIRST,i_class_id#5813 ASC NULLS FIRST,i_category_id#5815 ASC NULLS FIRST], output=[ty_channel#5461,ty_brand#5462,ty_class#5463,ty_category#5464,ty_sales#5465,ty_number_sales#5466L,ly_channel#5467,ly_brand#5468,ly_class#5469,ly_category#5470,ly_sales#5471,ly_number_sales#5472L])
   +- *(181) Project [i_brand_id#5811 AS ty_brand#5462, i_class_id#5813 AS ty_class#5463, i_category_id#5815 AS ty_category#5464, sales#5450 AS ty_sales#5465, number_sales#5451L AS ty_number_sales#5466L, i_brand_id#5884 AS ly_brand#5468, i_class_id#5886 AS ly_class#5469, i_category_id#5888 AS ly_category#5470, sales#5456 AS ly_sales#5471, number_sales#5457L AS ly_number_sales#5472L, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
      +- *(181) SortMergeJoin [i_brand_id#5811, i_class_id#5813, i_category_id#5815], [i_brand_id#5884, i_class_id#5886, i_category_id#5888], Inner
         :- *(179) Sort [i_brand_id#5811 ASC NULLS FIRST, i_class_id#5813 ASC NULLS FIRST, i_category_id#5815 ASC NULLS FIRST], false, 0
         :  +- *(179) Filter (isnotnull(sales#5450) AND (cast(sales#5450 as decimal(32,6)) > cast(Subquery subquery#5454, [id=#62595] as decimal(32,6))))
         :     :  +- Subquery subquery#5454, [id=#62595]
         :     :     +- AdaptiveSparkPlan isFinalPlan=true
                     +- == Final Plan ==
                        *(17) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5483])
                        +- ShuffleQueryStage 9
                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#75935]
                              +- *(16) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6026, count#6027L])
                                 +- Union
                                    :- *(9) Project [ss_quantity#5616 AS quantity#5477, ss_list_price#5618 AS list_price#5478]
                                    :  +- *(9) SortMergeJoin [ss_sold_date_sk#5606], [d_date_sk#5629], Inner
                                    :     :- *(7) Sort [ss_sold_date_sk#5606 ASC NULLS FIRST], false, 0
                                    :     :  +- AQEShuffleRead coalesced
                                    :     :     +- ShuffleQueryStage 0
                                    :     :        +- Exchange hashpartitioning(ss_sold_date_sk#5606, 200), ENSURE_REQUIREMENTS, [id=#75519]
                                    :     :           +- *(1) Filter isnotnull(ss_sold_date_sk#5606)
                                    :     :              +- *(1) ColumnarToRow
                                    :     :                 +- FileScan parquet [ss_sold_date_sk#5606,ss_quantity#5616,ss_list_price#5618] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5606)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                    :     +- *(8) Sort [d_date_sk#5629 ASC NULLS FIRST], false, 0
                                    :        +- AQEShuffleRead coalesced
                                    :           +- ShuffleQueryStage 2
                                    :              +- ReusedExchange [d_date_sk#5629], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                                    :- *(12) Project [cs_quantity#5675 AS quantity#5479, cs_list_price#5677 AS list_price#5480]
                                    :  +- *(12) SortMergeJoin [cs_sold_date_sk#5657], [d_date_sk#5691], Inner
                                    :     :- *(10) Sort [cs_sold_date_sk#5657 ASC NULLS FIRST], false, 0
                                    :     :  +- AQEShuffleRead coalesced
                                    :     :     +- ShuffleQueryStage 3
                                    :     :        +- Exchange hashpartitioning(cs_sold_date_sk#5657, 200), ENSURE_REQUIREMENTS, [id=#75561]
                                    :     :           +- *(3) Filter isnotnull(cs_sold_date_sk#5657)
                                    :     :              +- *(3) ColumnarToRow
                                    :     :                 +- FileScan parquet [cs_sold_date_sk#5657,cs_quantity#5675,cs_list_price#5677] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5657)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                    :     +- *(11) Sort [d_date_sk#5691 ASC NULLS FIRST], false, 0
                                    :        +- AQEShuffleRead coalesced
                                    :           +- ShuffleQueryStage 5
                                    :              +- ReusedExchange [d_date_sk#5691], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                                    +- *(15) Project [ws_quantity#5737 AS quantity#5481, ws_list_price#5739 AS list_price#5482]
                                       +- *(15) SortMergeJoin [ws_sold_date_sk#5719], [d_date_sk#5753], Inner
                                          :- *(13) Sort [ws_sold_date_sk#5719 ASC NULLS FIRST], false, 0
                                          :  +- AQEShuffleRead coalesced
                                          :     +- ShuffleQueryStage 6
                                          :        +- Exchange hashpartitioning(ws_sold_date_sk#5719, 200), ENSURE_REQUIREMENTS, [id=#75603]
                                          :           +- *(5) Filter isnotnull(ws_sold_date_sk#5719)
                                          :              +- *(5) ColumnarToRow
                                          :                 +- FileScan parquet [ws_sold_date_sk#5719,ws_quantity#5737,ws_list_price#5739] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5719)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                          +- *(14) Sort [d_date_sk#5753 ASC NULLS FIRST], false, 0
                                             +- AQEShuffleRead coalesced
                                                +- ShuffleQueryStage 8
                                                   +- ReusedExchange [d_date_sk#5753], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                     +- == Initial Plan ==
                        HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5483])
                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#62593]
                           +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6026, count#6027L])
                              +- Union
                                 :- Project [ss_quantity#5616 AS quantity#5477, ss_list_price#5618 AS list_price#5478]
                                 :  +- SortMergeJoin [ss_sold_date_sk#5606], [d_date_sk#5629], Inner
                                 :     :- Sort [ss_sold_date_sk#5606 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(ss_sold_date_sk#5606, 200), ENSURE_REQUIREMENTS, [id=#62570]
                                 :     :     +- Filter isnotnull(ss_sold_date_sk#5606)
                                 :     :        +- FileScan parquet [ss_sold_date_sk#5606,ss_quantity#5616,ss_list_price#5618] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5606)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#5629 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#5629, 200), ENSURE_REQUIREMENTS, [id=#62571]
                                 :           +- Project [d_date_sk#5629]
                                 :              +- Filter (((isnotnull(d_year#5635) AND (d_year#5635 >= 1999)) AND (d_year#5635 <= 2001)) AND isnotnull(d_date_sk#5629))
                                 :                 +- FileScan parquet [d_date_sk#5629,d_year#5635] Batched: true, DataFilters: [isnotnull(d_year#5635), (d_year#5635 >= 1999), (d_year#5635 <= 2001), isnotnull(d_date_sk#5629)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :- Project [cs_quantity#5675 AS quantity#5479, cs_list_price#5677 AS list_price#5480]
                                 :  +- SortMergeJoin [cs_sold_date_sk#5657], [d_date_sk#5691], Inner
                                 :     :- Sort [cs_sold_date_sk#5657 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(cs_sold_date_sk#5657, 200), ENSURE_REQUIREMENTS, [id=#62577]
                                 :     :     +- Filter isnotnull(cs_sold_date_sk#5657)
                                 :     :        +- FileScan parquet [cs_sold_date_sk#5657,cs_quantity#5675,cs_list_price#5677] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5657)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#5691 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#5691, 200), ENSURE_REQUIREMENTS, [id=#62578]
                                 :           +- Project [d_date_sk#5691]
                                 :              +- Filter (((isnotnull(d_year#5697) AND (d_year#5697 >= 1999)) AND (d_year#5697 <= 2001)) AND isnotnull(d_date_sk#5691))
                                 :                 +- FileScan parquet [d_date_sk#5691,d_year#5697] Batched: true, DataFilters: [isnotnull(d_year#5697), (d_year#5697 >= 1999), (d_year#5697 <= 2001), isnotnull(d_date_sk#5691)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 +- Project [ws_quantity#5737 AS quantity#5481, ws_list_price#5739 AS list_price#5482]
                                    +- SortMergeJoin [ws_sold_date_sk#5719], [d_date_sk#5753], Inner
                                       :- Sort [ws_sold_date_sk#5719 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_sold_date_sk#5719, 200), ENSURE_REQUIREMENTS, [id=#62584]
                                       :     +- Filter isnotnull(ws_sold_date_sk#5719)
                                       :        +- FileScan parquet [ws_sold_date_sk#5719,ws_quantity#5737,ws_list_price#5739] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5719)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       +- Sort [d_date_sk#5753 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date_sk#5753, 200), ENSURE_REQUIREMENTS, [id=#62585]
                                             +- Project [d_date_sk#5753]
                                                +- Filter (((isnotnull(d_year#5759) AND (d_year#5759 >= 1999)) AND (d_year#5759 <= 2001)) AND isnotnull(d_date_sk#5753))
                                                   +- FileScan parquet [d_date_sk#5753,d_year#5759] Batched: true, DataFilters: [isnotnull(d_year#5759), (d_year#5759 >= 1999), (d_year#5759 <= 2001), isnotnull(d_date_sk#5753)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- *(179) HashAggregate(keys=[i_brand_id#5811, i_class_id#5813, i_category_id#5815], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5791 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5793 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5811, i_class_id#5813, i_category_id#5815, sales#5450, number_sales#5451L])
         :        +- AQEShuffleRead coalesced
         :           +- ShuffleQueryStage 154
         :              +- Exchange hashpartitioning(i_brand_id#5811, i_class_id#5813, i_category_id#5815, 200), ENSURE_REQUIREMENTS, [id=#75174]
         :                 +- *(175) HashAggregate(keys=[i_brand_id#5811, i_class_id#5813, i_category_id#5815], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5791 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5793 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5811, i_class_id#5813, i_category_id#5815, sum#6015, isEmpty#6016, count#6017L])
         :                    +- *(175) Project [ss_quantity#5791, ss_list_price#5793, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
         :                       +- *(175) SortMergeJoin [ss_sold_date_sk#5781], [d_date_sk#5826], Inner
         :                          :- *(173) Sort [ss_sold_date_sk#5781 ASC NULLS FIRST], false, 0
         :                          :  +- AQEShuffleRead coalesced
         :                          :     +- ShuffleQueryStage 151
         :                          :        +- Exchange hashpartitioning(ss_sold_date_sk#5781, 200), ENSURE_REQUIREMENTS, [id=#74904]
         :                          :           +- *(165) Project [ss_sold_date_sk#5781, ss_quantity#5791, ss_list_price#5793, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
         :                          :              +- *(165) SortMergeJoin [ss_item_sk#5783], [i_item_sk#5804], Inner
         :                          :                 :- *(161) SortMergeJoin [ss_item_sk#5783], [ss_item_sk#5476], LeftSemi
         :                          :                 :  :- *(159) Sort [ss_item_sk#5783 ASC NULLS FIRST], false, 0
         :                          :                 :  :  +- AQEShuffleRead coalesced
         :                          :                 :  :     +- ShuffleQueryStage 0
         :                          :                 :  :        +- Exchange hashpartitioning(ss_item_sk#5783, 200), ENSURE_REQUIREMENTS, [id=#63552]
         :                          :                 :  :           +- *(1) Filter (isnotnull(ss_item_sk#5783) AND isnotnull(ss_sold_date_sk#5781))
         :                          :                 :  :              +- *(1) ColumnarToRow
         :                          :                 :  :                 +- FileScan parquet [ss_sold_date_sk#5781,ss_item_sk#5783,ss_quantity#5791,ss_list_price#5793] Batched: true, DataFilters: [isnotnull(ss_item_sk#5783), isnotnull(ss_sold_date_sk#5781)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :                          :                 :  +- *(160) Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
         :                          :                 :     +- AQEShuffleRead coalesced
         :                          :                 :        +- ShuffleQueryStage 144
         :                          :                 :           +- Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#74470]
         :                          :                 :              +- *(149) Project [i_item_sk#668 AS ss_item_sk#5476]
         :                          :                 :                 +- *(149) SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5473, class_id#5474, category_id#5475], Inner
         :                          :                 :                    :- *(147) Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
         :                          :                 :                    :  +- AQEShuffleRead coalesced
         :                          :                 :                    :     +- ShuffleQueryStage 1
         :                          :                 :                    :        +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#63569]
         :                          :                 :                    :           +- *(2) Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
         :                          :                 :                    :              +- *(2) ColumnarToRow
         :                          :                 :                    :                 +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                          :                 :                    +- *(148) Sort [brand_id#5473 ASC NULLS FIRST, class_id#5474 ASC NULLS FIRST, category_id#5475 ASC NULLS FIRST], false, 0
         :                          :                 :                       +- *(148) HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                          :                 :                          +- AQEShuffleRead coalesced
         :                          :                 :                             +- ShuffleQueryStage 137
         :                          :                 :                                +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#73952]
         :                          :                 :                                   +- *(137) HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                          :                 :                                      +- *(137) SortMergeJoin [coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475)], [coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567)], LeftSemi
         :                          :                 :                                         :- *(135) Sort [coalesce(brand_id#5473, 0) ASC NULLS FIRST, isnull(brand_id#5473) ASC NULLS FIRST, coalesce(class_id#5474, 0) ASC NULLS FIRST, isnull(class_id#5474) ASC NULLS FIRST, coalesce(category_id#5475, 0) ASC NULLS FIRST, isnull(category_id#5475) ASC NULLS FIRST], false, 0
         :                          :                 :                                         :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :     +- ShuffleQueryStage 130
         :                          :                 :                                         :        +- Exchange hashpartitioning(coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475), 200), ENSURE_REQUIREMENTS, [id=#73404]
         :                          :                 :                                         :           +- *(131) HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                          :                 :                                         :              +- AQEShuffleRead coalesced
         :                          :                 :                                         :                 +- ShuffleQueryStage 123
         :                          :                 :                                         :                    +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#72730]
         :                          :                 :                                         :                       +- *(121) HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                          :                 :                                         :                          +- *(121) Project [i_brand_id#5491 AS brand_id#5473, i_class_id#5493 AS class_id#5474, i_category_id#5495 AS category_id#5475]
         :                          :                 :                                         :                             +- *(121) SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :                          :                 :                                         :                                :- *(119) Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :     +- ShuffleQueryStage 116
         :                          :                 :                                         :                                :        +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#72012]
         :                          :                 :                                         :                                :           +- *(109) Project [ss_sold_date_sk#252, i_brand_id#5491, i_class_id#5493, i_category_id#5495]
         :                          :                 :                                         :                                :              +- *(109) SortMergeJoin [ss_item_sk#254], [i_item_sk#5484], Inner
         :                          :                 :                                         :                                :                 :- *(107) Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                 :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                 :     +- ShuffleQueryStage 2
         :                          :                 :                                         :                                :                 :        +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#63586]
         :                          :                 :                                         :                                :                 :           +- *(3) Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
         :                          :                 :                                         :                                :                 :              +- *(3) ColumnarToRow
         :                          :                 :                                         :                                :                 :                 +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                          :                 :                                         :                                :                 +- *(108) Sort [i_item_sk#5484 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                    +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                       +- ShuffleQueryStage 109
         :                          :                 :                                         :                                :                          +- Exchange hashpartitioning(i_item_sk#5484, 200), ENSURE_REQUIREMENTS, [id=#70196]
         :                          :                 :                                         :                                :                             +- *(97) SortMergeJoin [coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495)], [coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517)], LeftSemi
         :                          :                 :                                         :                                :                                :- *(95) Sort [coalesce(i_brand_id#5491, 0) ASC NULLS FIRST, isnull(i_brand_id#5491) ASC NULLS FIRST, coalesce(i_class_id#5493, 0) ASC NULLS FIRST, isnull(i_class_id#5493) ASC NULLS FIRST, coalesce(i_category_id#5495, 0) ASC NULLS FIRST, isnull(i_category_id#5495) ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                :     +- ShuffleQueryStage 3
         :                          :                 :                                         :                                :                                :        +- Exchange hashpartitioning(coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495), 200), ENSURE_REQUIREMENTS, [id=#63603]
         :                          :                 :                                         :                                :                                :           +- *(4) Filter (((isnotnull(i_item_sk#5484) AND isnotnull(i_brand_id#5491)) AND isnotnull(i_class_id#5493)) AND isnotnull(i_category_id#5495))
         :                          :                 :                                         :                                :                                :              +- *(4) ColumnarToRow
         :                          :                 :                                         :                                :                                :                 +- FileScan parquet [i_item_sk#5484,i_brand_id#5491,i_class_id#5493,i_category_id#5495] Batched: true, DataFilters: [isnotnull(i_item_sk#5484), isnotnull(i_brand_id#5491), isnotnull(i_class_id#5493), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                          :                 :                                         :                                :                                +- *(96) Sort [coalesce(i_brand_id#5513, 0) ASC NULLS FIRST, isnull(i_brand_id#5513) ASC NULLS FIRST, coalesce(i_class_id#5515, 0) ASC NULLS FIRST, isnull(i_class_id#5515) ASC NULLS FIRST, coalesce(i_category_id#5517, 0) ASC NULLS FIRST, isnull(i_category_id#5517) ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                   +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                      +- ShuffleQueryStage 95
         :                          :                 :                                         :                                :                                         +- Exchange hashpartitioning(coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517), 200), ENSURE_REQUIREMENTS, [id=#68310]
         :                          :                 :                                         :                                :                                            +- *(73) Project [i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                          :                 :                                         :                                :                                               +- *(73) SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5528], Inner
         :                          :                 :                                         :                                :                                                  :- *(71) Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                                  :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                                  :     +- ShuffleQueryStage 81
         :                          :                 :                                         :                                :                                                  :        +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#65960]
         :                          :                 :                                         :                                :                                                  :           +- *(49) Project [cs_sold_date_sk#544, i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                          :                 :                                         :                                :                                                  :              +- *(49) SortMergeJoin [cs_item_sk#559], [i_item_sk#5506], Inner
         :                          :                 :                                         :                                :                                                  :                 :- *(47) Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                                  :                 :  +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                                  :                 :     +- ShuffleQueryStage 4
         :                          :                 :                                         :                                :                                                  :                 :        +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#63620]
         :                          :                 :                                         :                                :                                                  :                 :           +- *(5) Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
         :                          :                 :                                         :                                :                                                  :                 :              +- *(5) ColumnarToRow
         :                          :                 :                                         :                                :                                                  :                 :                 +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                          :                 :                                         :                                :                                                  :                 +- *(48) Sort [i_item_sk#5506 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                                  :                    +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                                  :                       +- ShuffleQueryStage 5
         :                          :                 :                                         :                                :                                                  :                          +- Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#63637]
         :                          :                 :                                         :                                :                                                  :                             +- *(6) Filter isnotnull(i_item_sk#5506)
         :                          :                 :                                         :                                :                                                  :                                +- *(6) ColumnarToRow
         :                          :                 :                                         :                                :                                                  :                                   +- FileScan parquet [i_item_sk#5506,i_brand_id#5513,i_class_id#5515,i_category_id#5517] Batched: true, DataFilters: [isnotnull(i_item_sk#5506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                          :                 :                                         :                                :                                                  +- *(72) Sort [d_date_sk#5528 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                :                                                     +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                :                                                        +- ShuffleQueryStage 6
         :                          :                 :                                         :                                :                                                           +- Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
         :                          :                 :                                         :                                :                                                              +- *(7) Project [d_date_sk#5528]
         :                          :                 :                                         :                                :                                                                 +- *(7) Filter (((isnotnull(d_year#5534) AND (d_year#5534 >= 1999)) AND (d_year#5534 <= 2001)) AND isnotnull(d_date_sk#5528))
         :                          :                 :                                         :                                :                                                                    +- *(7) ColumnarToRow
         :                          :                 :                                         :                                :                                                                       +- FileScan parquet [d_date_sk#5528,d_year#5534] Batched: true, DataFilters: [isnotnull(d_year#5534), (d_year#5534 >= 1999), (d_year#5534 <= 2001), isnotnull(d_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                          :                 :                                         :                                +- *(120) Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :                          :                 :                                         :                                   +- AQEShuffleRead coalesced
         :                          :                 :                                         :                                      +- ShuffleQueryStage 8
         :                          :                 :                                         :                                         +- ReusedExchange [d_date_sk#612], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
         :                          :                 :                                         +- *(136) Sort [coalesce(i_brand_id#5563, 0) ASC NULLS FIRST, isnull(i_brand_id#5563) ASC NULLS FIRST, coalesce(i_class_id#5565, 0) ASC NULLS FIRST, isnull(i_class_id#5565) ASC NULLS FIRST, coalesce(i_category_id#5567, 0) ASC NULLS FIRST, isnull(i_category_id#5567) ASC NULLS FIRST], false, 0
         :                          :                 :                                            +- AQEShuffleRead coalesced
         :                          :                 :                                               +- ShuffleQueryStage 102
         :                          :                 :                                                  +- Exchange hashpartitioning(coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567), 200), ENSURE_REQUIREMENTS, [id=#69318]
         :                          :                 :                                                     +- *(85) Project [i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                          :                 :                                                        +- *(85) SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5578], Inner
         :                          :                 :                                                           :- *(83) Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
         :                          :                 :                                                           :  +- AQEShuffleRead coalesced
         :                          :                 :                                                           :     +- ShuffleQueryStage 88
         :                          :                 :                                                           :        +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#67266]
         :                          :                 :                                                           :           +- *(61) Project [ws_sold_date_sk#476, i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                          :                 :                                                           :              +- *(61) SortMergeJoin [ws_item_sk#479], [i_item_sk#5556], Inner
         :                          :                 :                                                           :                 :- *(59) Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
         :                          :                 :                                                           :                 :  +- AQEShuffleRead coalesced
         :                          :                 :                                                           :                 :     +- ShuffleQueryStage 9
         :                          :                 :                                                           :                 :        +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#63720]
         :                          :                 :                                                           :                 :           +- *(9) Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
         :                          :                 :                                                           :                 :              +- *(9) ColumnarToRow
         :                          :                 :                                                           :                 :                 +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                          :                 :                                                           :                 +- *(60) Sort [i_item_sk#5556 ASC NULLS FIRST], false, 0
         :                          :                 :                                                           :                    +- AQEShuffleRead coalesced
         :                          :                 :                                                           :                       +- ShuffleQueryStage 11
         :                          :                 :                                                           :                          +- ReusedExchange [i_item_sk#5556, i_brand_id#5563, i_class_id#5565, i_category_id#5567], Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#63637]
         :                          :                 :                                                           +- *(84) Sort [d_date_sk#5578 ASC NULLS FIRST], false, 0
         :                          :                 :                                                              +- AQEShuffleRead coalesced
         :                          :                 :                                                                 +- ShuffleQueryStage 13
         :                          :                 :                                                                    +- ReusedExchange [d_date_sk#5578], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
         :                          :                 +- *(164) SortMergeJoin [i_item_sk#5804], [ss_item_sk#5476], LeftSemi
         :                          :                    :- *(162) Sort [i_item_sk#5804 ASC NULLS FIRST], false, 0
         :                          :                    :  +- AQEShuffleRead coalesced
         :                          :                    :     +- ShuffleQueryStage 14
         :                          :                    :        +- Exchange hashpartitioning(i_item_sk#5804, 200), ENSURE_REQUIREMENTS, [id=#63797]
         :                          :                    :           +- *(12) Filter (((isnotnull(i_item_sk#5804) AND isnotnull(i_brand_id#5811)) AND isnotnull(i_class_id#5813)) AND isnotnull(i_category_id#5815))
         :                          :                    :              +- *(12) ColumnarToRow
         :                          :                    :                 +- FileScan parquet [i_item_sk#5804,i_brand_id#5811,i_class_id#5813,i_category_id#5815] Batched: true, DataFilters: [isnotnull(i_item_sk#5804), isnotnull(i_brand_id#5811), isnotnull(i_class_id#5813), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                          :                    +- *(163) Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
         :                          :                       +- AQEShuffleRead coalesced
         :                          :                          +- ShuffleQueryStage 146
         :                          :                             +- ReusedExchange [ss_item_sk#5476], Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#74470]
         :                          +- *(174) Sort [d_date_sk#5826 ASC NULLS FIRST], false, 0
         :                             +- AQEShuffleRead coalesced
         :                                +- ShuffleQueryStage 35
         :                                   +- Exchange hashpartitioning(d_date_sk#5826, 200), ENSURE_REQUIREMENTS, [id=#64062]
         :                                      +- *(23) Project [d_date_sk#5826]
         :                                         +- *(23) Filter ((isnotnull(d_week_seq#5830) AND (d_week_seq#5830 = Subquery subquery#5453, [id=#62601])) AND isnotnull(d_date_sk#5826))
         :                                            :  +- Subquery subquery#5453, [id=#62601]
         :                                            :     +- AdaptiveSparkPlan isFinalPlan=true
                                                            +- == Final Plan ==
                                                               *(1) Project [d_week_seq#5933]
                                                               +- *(1) Filter (((((isnotnull(d_year#5935) AND isnotnull(d_moy#5937)) AND isnotnull(d_dom#5938)) AND (d_year#5935 = 2000)) AND (d_moy#5937 = 12)) AND (d_dom#5938 = 12))
                                                                  +- *(1) ColumnarToRow
                                                                     +- FileScan parquet [d_week_seq#5933,d_year#5935,d_moy#5937,d_dom#5938] Batched: true, DataFilters: [isnotnull(d_year#5935), isnotnull(d_moy#5937), isnotnull(d_dom#5938), (d_year#5935 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                            +- == Initial Plan ==
                                                               Project [d_week_seq#5933]
                                                               +- Filter (((((isnotnull(d_year#5935) AND isnotnull(d_moy#5937)) AND isnotnull(d_dom#5938)) AND (d_year#5935 = 2000)) AND (d_moy#5937 = 12)) AND (d_dom#5938 = 12))
                                                                  +- FileScan parquet [d_week_seq#5933,d_year#5935,d_moy#5937,d_dom#5938] Batched: true, DataFilters: [isnotnull(d_year#5935), isnotnull(d_moy#5937), isnotnull(d_dom#5938), (d_year#5935 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                                            +- *(23) ColumnarToRow
         :                                               +- FileScan parquet [d_date_sk#5826,d_week_seq#5830] Batched: true, DataFilters: [isnotnull(d_week_seq#5830), isnotnull(d_date_sk#5826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         +- *(180) Sort [i_brand_id#5884 ASC NULLS FIRST, i_class_id#5886 ASC NULLS FIRST, i_category_id#5888 ASC NULLS FIRST], false, 0
            +- *(180) Filter (isnotnull(sales#5456) AND (cast(sales#5456 as decimal(32,6)) > cast(ReusedSubquery Subquery subquery#5454, [id=#62595] as decimal(32,6))))
               :  +- ReusedSubquery Subquery subquery#5454, [id=#62595]
               +- *(180) HashAggregate(keys=[i_brand_id#5884, i_class_id#5886, i_category_id#5888], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5864 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5866 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5884, i_class_id#5886, i_category_id#5888, sales#5456, number_sales#5457L])
                  +- AQEShuffleRead coalesced
                     +- ShuffleQueryStage 155
                        +- Exchange hashpartitioning(i_brand_id#5884, i_class_id#5886, i_category_id#5888, 200), ENSURE_REQUIREMENTS, [id=#75230]
                           +- *(178) HashAggregate(keys=[i_brand_id#5884, i_class_id#5886, i_category_id#5888], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5864 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5866 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5884, i_class_id#5886, i_category_id#5888, sum#6021, isEmpty#6022, count#6023L])
                              +- *(178) Project [ss_quantity#5864, ss_list_price#5866, i_brand_id#5884, i_class_id#5886, i_category_id#5888]
                                 +- *(178) SortMergeJoin [ss_sold_date_sk#5854], [d_date_sk#5899], Inner
                                    :- *(176) Sort [ss_sold_date_sk#5854 ASC NULLS FIRST], false, 0
                                    :  +- AQEShuffleRead coalesced
                                    :     +- ShuffleQueryStage 153
                                    :        +- ReusedExchange [ss_sold_date_sk#5854, ss_quantity#5864, ss_list_price#5866, i_brand_id#5884, i_class_id#5886, i_category_id#5888], Exchange hashpartitioning(ss_sold_date_sk#5781, 200), ENSURE_REQUIREMENTS, [id=#74904]
                                    +- *(177) Sort [d_date_sk#5899 ASC NULLS FIRST], false, 0
                                       +- AQEShuffleRead coalesced
                                          +- ShuffleQueryStage 80
                                             +- Exchange hashpartitioning(d_date_sk#5899, 200), ENSURE_REQUIREMENTS, [id=#64973]
                                                +- *(46) Project [d_date_sk#5899]
                                                   +- *(46) Filter ((isnotnull(d_week_seq#5903) AND (d_week_seq#5903 = Subquery subquery#5459, [id=#62699])) AND isnotnull(d_date_sk#5899))
                                                      :  +- Subquery subquery#5459, [id=#62699]
                                                      :     +- AdaptiveSparkPlan isFinalPlan=true
                                                            +- == Final Plan ==
                                                               *(1) Project [d_week_seq#5961]
                                                               +- *(1) Filter (((((isnotnull(d_year#5963) AND isnotnull(d_moy#5965)) AND isnotnull(d_dom#5966)) AND (d_year#5963 = 1999)) AND (d_moy#5965 = 12)) AND (d_dom#5966 = 12))
                                                                  +- *(1) ColumnarToRow
                                                                     +- FileScan parquet [d_week_seq#5961,d_year#5963,d_moy#5965,d_dom#5966] Batched: true, DataFilters: [isnotnull(d_year#5963), isnotnull(d_moy#5965), isnotnull(d_dom#5966), (d_year#5963 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                            +- == Initial Plan ==
                                                               Project [d_week_seq#5961]
                                                               +- Filter (((((isnotnull(d_year#5963) AND isnotnull(d_moy#5965)) AND isnotnull(d_dom#5966)) AND (d_year#5963 = 1999)) AND (d_moy#5965 = 12)) AND (d_dom#5966 = 12))
                                                                  +- FileScan parquet [d_week_seq#5961,d_year#5963,d_moy#5965,d_dom#5966] Batched: true, DataFilters: [isnotnull(d_year#5963), isnotnull(d_moy#5965), isnotnull(d_dom#5966), (d_year#5963 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                      +- *(46) ColumnarToRow
                                                         +- FileScan parquet [d_date_sk#5899,d_week_seq#5903] Batched: true, DataFilters: [isnotnull(d_week_seq#5903), isnotnull(d_date_sk#5899)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
+- == Initial Plan ==
   TakeOrderedAndProject(limit=100, orderBy=[i_brand_id#5811 ASC NULLS FIRST,i_class_id#5813 ASC NULLS FIRST,i_category_id#5815 ASC NULLS FIRST], output=[ty_channel#5461,ty_brand#5462,ty_class#5463,ty_category#5464,ty_sales#5465,ty_number_sales#5466L,ly_channel#5467,ly_brand#5468,ly_class#5469,ly_category#5470,ly_sales#5471,ly_number_sales#5472L])
   +- Project [i_brand_id#5811 AS ty_brand#5462, i_class_id#5813 AS ty_class#5463, i_category_id#5815 AS ty_category#5464, sales#5450 AS ty_sales#5465, number_sales#5451L AS ty_number_sales#5466L, i_brand_id#5884 AS ly_brand#5468, i_class_id#5886 AS ly_class#5469, i_category_id#5888 AS ly_category#5470, sales#5456 AS ly_sales#5471, number_sales#5457L AS ly_number_sales#5472L, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
      +- SortMergeJoin [i_brand_id#5811, i_class_id#5813, i_category_id#5815], [i_brand_id#5884, i_class_id#5886, i_category_id#5888], Inner
         :- Sort [i_brand_id#5811 ASC NULLS FIRST, i_class_id#5813 ASC NULLS FIRST, i_category_id#5815 ASC NULLS FIRST], false, 0
         :  +- Filter (isnotnull(sales#5450) AND (cast(sales#5450 as decimal(32,6)) > cast(Subquery subquery#5454, [id=#62595] as decimal(32,6))))
         :     :  +- Subquery subquery#5454, [id=#62595]
         :     :     +- AdaptiveSparkPlan isFinalPlan=true
                     +- == Final Plan ==
                        *(17) HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5483])
                        +- ShuffleQueryStage 9
                           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#75935]
                              +- *(16) HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6026, count#6027L])
                                 +- Union
                                    :- *(9) Project [ss_quantity#5616 AS quantity#5477, ss_list_price#5618 AS list_price#5478]
                                    :  +- *(9) SortMergeJoin [ss_sold_date_sk#5606], [d_date_sk#5629], Inner
                                    :     :- *(7) Sort [ss_sold_date_sk#5606 ASC NULLS FIRST], false, 0
                                    :     :  +- AQEShuffleRead coalesced
                                    :     :     +- ShuffleQueryStage 0
                                    :     :        +- Exchange hashpartitioning(ss_sold_date_sk#5606, 200), ENSURE_REQUIREMENTS, [id=#75519]
                                    :     :           +- *(1) Filter isnotnull(ss_sold_date_sk#5606)
                                    :     :              +- *(1) ColumnarToRow
                                    :     :                 +- FileScan parquet [ss_sold_date_sk#5606,ss_quantity#5616,ss_list_price#5618] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5606)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                    :     +- *(8) Sort [d_date_sk#5629 ASC NULLS FIRST], false, 0
                                    :        +- AQEShuffleRead coalesced
                                    :           +- ShuffleQueryStage 2
                                    :              +- ReusedExchange [d_date_sk#5629], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                                    :- *(12) Project [cs_quantity#5675 AS quantity#5479, cs_list_price#5677 AS list_price#5480]
                                    :  +- *(12) SortMergeJoin [cs_sold_date_sk#5657], [d_date_sk#5691], Inner
                                    :     :- *(10) Sort [cs_sold_date_sk#5657 ASC NULLS FIRST], false, 0
                                    :     :  +- AQEShuffleRead coalesced
                                    :     :     +- ShuffleQueryStage 3
                                    :     :        +- Exchange hashpartitioning(cs_sold_date_sk#5657, 200), ENSURE_REQUIREMENTS, [id=#75561]
                                    :     :           +- *(3) Filter isnotnull(cs_sold_date_sk#5657)
                                    :     :              +- *(3) ColumnarToRow
                                    :     :                 +- FileScan parquet [cs_sold_date_sk#5657,cs_quantity#5675,cs_list_price#5677] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5657)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                    :     +- *(11) Sort [d_date_sk#5691 ASC NULLS FIRST], false, 0
                                    :        +- AQEShuffleRead coalesced
                                    :           +- ShuffleQueryStage 5
                                    :              +- ReusedExchange [d_date_sk#5691], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                                    +- *(15) Project [ws_quantity#5737 AS quantity#5481, ws_list_price#5739 AS list_price#5482]
                                       +- *(15) SortMergeJoin [ws_sold_date_sk#5719], [d_date_sk#5753], Inner
                                          :- *(13) Sort [ws_sold_date_sk#5719 ASC NULLS FIRST], false, 0
                                          :  +- AQEShuffleRead coalesced
                                          :     +- ShuffleQueryStage 6
                                          :        +- Exchange hashpartitioning(ws_sold_date_sk#5719, 200), ENSURE_REQUIREMENTS, [id=#75603]
                                          :           +- *(5) Filter isnotnull(ws_sold_date_sk#5719)
                                          :              +- *(5) ColumnarToRow
                                          :                 +- FileScan parquet [ws_sold_date_sk#5719,ws_quantity#5737,ws_list_price#5739] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5719)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                          +- *(14) Sort [d_date_sk#5753 ASC NULLS FIRST], false, 0
                                             +- AQEShuffleRead coalesced
                                                +- ShuffleQueryStage 8
                                                   +- ReusedExchange [d_date_sk#5753], Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63660]
                     +- == Initial Plan ==
                        HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5483])
                        +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#62593]
                           +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6026, count#6027L])
                              +- Union
                                 :- Project [ss_quantity#5616 AS quantity#5477, ss_list_price#5618 AS list_price#5478]
                                 :  +- SortMergeJoin [ss_sold_date_sk#5606], [d_date_sk#5629], Inner
                                 :     :- Sort [ss_sold_date_sk#5606 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(ss_sold_date_sk#5606, 200), ENSURE_REQUIREMENTS, [id=#62570]
                                 :     :     +- Filter isnotnull(ss_sold_date_sk#5606)
                                 :     :        +- FileScan parquet [ss_sold_date_sk#5606,ss_quantity#5616,ss_list_price#5618] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5606)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#5629 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#5629, 200), ENSURE_REQUIREMENTS, [id=#62571]
                                 :           +- Project [d_date_sk#5629]
                                 :              +- Filter (((isnotnull(d_year#5635) AND (d_year#5635 >= 1999)) AND (d_year#5635 <= 2001)) AND isnotnull(d_date_sk#5629))
                                 :                 +- FileScan parquet [d_date_sk#5629,d_year#5635] Batched: true, DataFilters: [isnotnull(d_year#5635), (d_year#5635 >= 1999), (d_year#5635 <= 2001), isnotnull(d_date_sk#5629)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 :- Project [cs_quantity#5675 AS quantity#5479, cs_list_price#5677 AS list_price#5480]
                                 :  +- SortMergeJoin [cs_sold_date_sk#5657], [d_date_sk#5691], Inner
                                 :     :- Sort [cs_sold_date_sk#5657 ASC NULLS FIRST], false, 0
                                 :     :  +- Exchange hashpartitioning(cs_sold_date_sk#5657, 200), ENSURE_REQUIREMENTS, [id=#62577]
                                 :     :     +- Filter isnotnull(cs_sold_date_sk#5657)
                                 :     :        +- FileScan parquet [cs_sold_date_sk#5657,cs_quantity#5675,cs_list_price#5677] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5657)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
                                 :     +- Sort [d_date_sk#5691 ASC NULLS FIRST], false, 0
                                 :        +- Exchange hashpartitioning(d_date_sk#5691, 200), ENSURE_REQUIREMENTS, [id=#62578]
                                 :           +- Project [d_date_sk#5691]
                                 :              +- Filter (((isnotnull(d_year#5697) AND (d_year#5697 >= 1999)) AND (d_year#5697 <= 2001)) AND isnotnull(d_date_sk#5691))
                                 :                 +- FileScan parquet [d_date_sk#5691,d_year#5697] Batched: true, DataFilters: [isnotnull(d_year#5697), (d_year#5697 >= 1999), (d_year#5697 <= 2001), isnotnull(d_date_sk#5691)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                                 +- Project [ws_quantity#5737 AS quantity#5481, ws_list_price#5739 AS list_price#5482]
                                    +- SortMergeJoin [ws_sold_date_sk#5719], [d_date_sk#5753], Inner
                                       :- Sort [ws_sold_date_sk#5719 ASC NULLS FIRST], false, 0
                                       :  +- Exchange hashpartitioning(ws_sold_date_sk#5719, 200), ENSURE_REQUIREMENTS, [id=#62584]
                                       :     +- Filter isnotnull(ws_sold_date_sk#5719)
                                       :        +- FileScan parquet [ws_sold_date_sk#5719,ws_quantity#5737,ws_list_price#5739] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5719)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
                                       +- Sort [d_date_sk#5753 ASC NULLS FIRST], false, 0
                                          +- Exchange hashpartitioning(d_date_sk#5753, 200), ENSURE_REQUIREMENTS, [id=#62585]
                                             +- Project [d_date_sk#5753]
                                                +- Filter (((isnotnull(d_year#5759) AND (d_year#5759 >= 1999)) AND (d_year#5759 <= 2001)) AND isnotnull(d_date_sk#5753))
                                                   +- FileScan parquet [d_date_sk#5753,d_year#5759] Batched: true, DataFilters: [isnotnull(d_year#5759), (d_year#5759 >= 1999), (d_year#5759 <= 2001), isnotnull(d_date_sk#5753)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :     +- HashAggregate(keys=[i_brand_id#5811, i_class_id#5813, i_category_id#5815], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5791 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5793 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5811, i_class_id#5813, i_category_id#5815, sales#5450, number_sales#5451L])
         :        +- Exchange hashpartitioning(i_brand_id#5811, i_class_id#5813, i_category_id#5815, 200), ENSURE_REQUIREMENTS, [id=#62998]
         :           +- HashAggregate(keys=[i_brand_id#5811, i_class_id#5813, i_category_id#5815], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5791 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5793 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5811, i_class_id#5813, i_category_id#5815, sum#6015, isEmpty#6016, count#6017L])
         :              +- Project [ss_quantity#5791, ss_list_price#5793, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
         :                 +- SortMergeJoin [ss_sold_date_sk#5781], [d_date_sk#5826], Inner
         :                    :- Sort [ss_sold_date_sk#5781 ASC NULLS FIRST], false, 0
         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#5781, 200), ENSURE_REQUIREMENTS, [id=#62990]
         :                    :     +- Project [ss_sold_date_sk#5781, ss_quantity#5791, ss_list_price#5793, i_brand_id#5811, i_class_id#5813, i_category_id#5815]
         :                    :        +- SortMergeJoin [ss_item_sk#5783], [i_item_sk#5804], Inner
         :                    :           :- SortMergeJoin [ss_item_sk#5783], [ss_item_sk#5476], LeftSemi
         :                    :           :  :- Sort [ss_item_sk#5783 ASC NULLS FIRST], false, 0
         :                    :           :  :  +- Exchange hashpartitioning(ss_item_sk#5783, 200), ENSURE_REQUIREMENTS, [id=#62898]
         :                    :           :  :     +- Filter (isnotnull(ss_item_sk#5783) AND isnotnull(ss_sold_date_sk#5781))
         :                    :           :  :        +- FileScan parquet [ss_sold_date_sk#5781,ss_item_sk#5783,ss_quantity#5791,ss_list_price#5793] Batched: true, DataFilters: [isnotnull(ss_item_sk#5783), isnotnull(ss_sold_date_sk#5781)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
         :                    :           :  +- Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
         :                    :           :     +- Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#62899]
         :                    :           :        +- Project [i_item_sk#668 AS ss_item_sk#5476]
         :                    :           :           +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5473, class_id#5474, category_id#5475], Inner
         :                    :           :              :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
         :                    :           :              :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#62891]
         :                    :           :              :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
         :                    :           :              :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :              +- Sort [brand_id#5473 ASC NULLS FIRST, class_id#5474 ASC NULLS FIRST, category_id#5475 ASC NULLS FIRST], false, 0
         :                    :           :                 +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :           :                    +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#62887]
         :                    :           :                       +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :           :                          +- SortMergeJoin [coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475)], [coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567)], LeftSemi
         :                    :           :                             :- Sort [coalesce(brand_id#5473, 0) ASC NULLS FIRST, isnull(brand_id#5473) ASC NULLS FIRST, coalesce(class_id#5474, 0) ASC NULLS FIRST, isnull(class_id#5474) ASC NULLS FIRST, coalesce(category_id#5475, 0) ASC NULLS FIRST, isnull(category_id#5475) ASC NULLS FIRST], false, 0
         :                    :           :                             :  +- Exchange hashpartitioning(coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475), 200), ENSURE_REQUIREMENTS, [id=#62880]
         :                    :           :                             :     +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :           :                             :        +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#62861]
         :                    :           :                             :           +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :           :                             :              +- Project [i_brand_id#5491 AS brand_id#5473, i_class_id#5493 AS class_id#5474, i_category_id#5495 AS category_id#5475]
         :                    :           :                             :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :                    :           :                             :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#62853]
         :                    :           :                             :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5491, i_class_id#5493, i_category_id#5495]
         :                    :           :                             :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5484], Inner
         :                    :           :                             :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#62845]
         :                    :           :                             :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
         :                    :           :                             :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :           :                             :                    :           +- Sort [i_item_sk#5484 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :              +- Exchange hashpartitioning(i_item_sk#5484, 200), ENSURE_REQUIREMENTS, [id=#62846]
         :                    :           :                             :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495)], [coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517)], LeftSemi
         :                    :           :                             :                    :                    :- Sort [coalesce(i_brand_id#5491, 0) ASC NULLS FIRST, isnull(i_brand_id#5491) ASC NULLS FIRST, coalesce(i_class_id#5493, 0) ASC NULLS FIRST, isnull(i_class_id#5493) ASC NULLS FIRST, coalesce(i_category_id#5495, 0) ASC NULLS FIRST, isnull(i_category_id#5495) ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495), 200), ENSURE_REQUIREMENTS, [id=#62838]
         :                    :           :                             :                    :                    :     +- Filter (((isnotnull(i_item_sk#5484) AND isnotnull(i_brand_id#5491)) AND isnotnull(i_class_id#5493)) AND isnotnull(i_category_id#5495))
         :                    :           :                             :                    :                    :        +- FileScan parquet [i_item_sk#5484,i_brand_id#5491,i_class_id#5493,i_category_id#5495] Batched: true, DataFilters: [isnotnull(i_item_sk#5484), isnotnull(i_brand_id#5491), isnotnull(i_class_id#5493), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                             :                    :                    +- Sort [coalesce(i_brand_id#5513, 0) ASC NULLS FIRST, isnull(i_brand_id#5513) ASC NULLS FIRST, coalesce(i_class_id#5515, 0) ASC NULLS FIRST, isnull(i_class_id#5515) ASC NULLS FIRST, coalesce(i_category_id#5517, 0) ASC NULLS FIRST, isnull(i_category_id#5517) ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517), 200), ENSURE_REQUIREMENTS, [id=#62839]
         :                    :           :                             :                    :                          +- Project [i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                    :           :                             :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5528], Inner
         :                    :           :                             :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#62830]
         :                    :           :                             :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                    :           :                             :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5506], Inner
         :                    :           :                             :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#62822]
         :                    :           :                             :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
         :                    :           :                             :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :           :                             :                    :                                :           +- Sort [i_item_sk#5506 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                                :              +- Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#62823]
         :                    :           :                             :                    :                                :                 +- Filter isnotnull(i_item_sk#5506)
         :                    :           :                             :                    :                                :                    +- FileScan parquet [i_item_sk#5506,i_brand_id#5513,i_class_id#5515,i_category_id#5517] Batched: true, DataFilters: [isnotnull(i_item_sk#5506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                             :                    :                                +- Sort [d_date_sk#5528 ASC NULLS FIRST], false, 0
         :                    :           :                             :                    :                                   +- Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#62831]
         :                    :           :                             :                    :                                      +- Project [d_date_sk#5528]
         :                    :           :                             :                    :                                         +- Filter (((isnotnull(d_year#5534) AND (d_year#5534 >= 1999)) AND (d_year#5534 <= 2001)) AND isnotnull(d_date_sk#5528))
         :                    :           :                             :                    :                                            +- FileScan parquet [d_date_sk#5528,d_year#5534] Batched: true, DataFilters: [isnotnull(d_year#5534), (d_year#5534 >= 1999), (d_year#5534 <= 2001), isnotnull(d_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           :                             :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :                    :           :                             :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#62854]
         :                    :           :                             :                          +- Project [d_date_sk#612]
         :                    :           :                             :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
         :                    :           :                             :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           :                             +- Sort [coalesce(i_brand_id#5563, 0) ASC NULLS FIRST, isnull(i_brand_id#5563) ASC NULLS FIRST, coalesce(i_class_id#5565, 0) ASC NULLS FIRST, isnull(i_class_id#5565) ASC NULLS FIRST, coalesce(i_category_id#5567, 0) ASC NULLS FIRST, isnull(i_category_id#5567) ASC NULLS FIRST], false, 0
         :                    :           :                                +- Exchange hashpartitioning(coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567), 200), ENSURE_REQUIREMENTS, [id=#62881]
         :                    :           :                                   +- Project [i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                    :           :                                      +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5578], Inner
         :                    :           :                                         :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
         :                    :           :                                         :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#62872]
         :                    :           :                                         :     +- Project [ws_sold_date_sk#476, i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                    :           :                                         :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5556], Inner
         :                    :           :                                         :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
         :                    :           :                                         :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#62864]
         :                    :           :                                         :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
         :                    :           :                                         :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :           :                                         :           +- Sort [i_item_sk#5556 ASC NULLS FIRST], false, 0
         :                    :           :                                         :              +- Exchange hashpartitioning(i_item_sk#5556, 200), ENSURE_REQUIREMENTS, [id=#62865]
         :                    :           :                                         :                 +- Filter isnotnull(i_item_sk#5556)
         :                    :           :                                         :                    +- FileScan parquet [i_item_sk#5556,i_brand_id#5563,i_class_id#5565,i_category_id#5567] Batched: true, DataFilters: [isnotnull(i_item_sk#5556)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :           :                                         +- Sort [d_date_sk#5578 ASC NULLS FIRST], false, 0
         :                    :           :                                            +- Exchange hashpartitioning(d_date_sk#5578, 200), ENSURE_REQUIREMENTS, [id=#62873]
         :                    :           :                                               +- Project [d_date_sk#5578]
         :                    :           :                                                  +- Filter (((isnotnull(d_year#5584) AND (d_year#5584 >= 1999)) AND (d_year#5584 <= 2001)) AND isnotnull(d_date_sk#5578))
         :                    :           :                                                     +- FileScan parquet [d_date_sk#5578,d_year#5584] Batched: true, DataFilters: [isnotnull(d_year#5584), (d_year#5584 >= 1999), (d_year#5584 <= 2001), isnotnull(d_date_sk#5578)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :           +- SortMergeJoin [i_item_sk#5804], [ss_item_sk#5476], LeftSemi
         :                    :              :- Sort [i_item_sk#5804 ASC NULLS FIRST], false, 0
         :                    :              :  +- Exchange hashpartitioning(i_item_sk#5804, 200), ENSURE_REQUIREMENTS, [id=#62980]
         :                    :              :     +- Filter (((isnotnull(i_item_sk#5804) AND isnotnull(i_brand_id#5811)) AND isnotnull(i_class_id#5813)) AND isnotnull(i_category_id#5815))
         :                    :              :        +- FileScan parquet [i_item_sk#5804,i_brand_id#5811,i_class_id#5813,i_category_id#5815] Batched: true, DataFilters: [isnotnull(i_item_sk#5804), isnotnull(i_brand_id#5811), isnotnull(i_class_id#5813), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :              +- Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
         :                    :                 +- Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#62981]
         :                    :                    +- Project [i_item_sk#668 AS ss_item_sk#5476]
         :                    :                       +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5473, class_id#5474, category_id#5475], Inner
         :                    :                          :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
         :                    :                          :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#62973]
         :                    :                          :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
         :                    :                          :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                          +- Sort [brand_id#5473 ASC NULLS FIRST, class_id#5474 ASC NULLS FIRST, category_id#5475 ASC NULLS FIRST], false, 0
         :                    :                             +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :                                +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#62969]
         :                    :                                   +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :                                      +- SortMergeJoin [coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475)], [coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567)], LeftSemi
         :                    :                                         :- Sort [coalesce(brand_id#5473, 0) ASC NULLS FIRST, isnull(brand_id#5473) ASC NULLS FIRST, coalesce(class_id#5474, 0) ASC NULLS FIRST, isnull(class_id#5474) ASC NULLS FIRST, coalesce(category_id#5475, 0) ASC NULLS FIRST, isnull(category_id#5475) ASC NULLS FIRST], false, 0
         :                    :                                         :  +- Exchange hashpartitioning(coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475), 200), ENSURE_REQUIREMENTS, [id=#62962]
         :                    :                                         :     +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :                                         :        +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#62943]
         :                    :                                         :           +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
         :                    :                                         :              +- Project [i_brand_id#5491 AS brand_id#5473, i_class_id#5493 AS class_id#5474, i_category_id#5495 AS category_id#5475]
         :                    :                                         :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
         :                    :                                         :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#62935]
         :                    :                                         :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5491, i_class_id#5493, i_category_id#5495]
         :                    :                                         :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5484], Inner
         :                    :                                         :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#62927]
         :                    :                                         :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
         :                    :                                         :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
         :                    :                                         :                    :           +- Sort [i_item_sk#5484 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :              +- Exchange hashpartitioning(i_item_sk#5484, 200), ENSURE_REQUIREMENTS, [id=#62928]
         :                    :                                         :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495)], [coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517)], LeftSemi
         :                    :                                         :                    :                    :- Sort [coalesce(i_brand_id#5491, 0) ASC NULLS FIRST, isnull(i_brand_id#5491) ASC NULLS FIRST, coalesce(i_class_id#5493, 0) ASC NULLS FIRST, isnull(i_class_id#5493) ASC NULLS FIRST, coalesce(i_category_id#5495, 0) ASC NULLS FIRST, isnull(i_category_id#5495) ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495), 200), ENSURE_REQUIREMENTS, [id=#62920]
         :                    :                                         :                    :                    :     +- Filter (((isnotnull(i_item_sk#5484) AND isnotnull(i_brand_id#5491)) AND isnotnull(i_class_id#5493)) AND isnotnull(i_category_id#5495))
         :                    :                                         :                    :                    :        +- FileScan parquet [i_item_sk#5484,i_brand_id#5491,i_class_id#5493,i_category_id#5495] Batched: true, DataFilters: [isnotnull(i_item_sk#5484), isnotnull(i_brand_id#5491), isnotnull(i_class_id#5493), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                         :                    :                    +- Sort [coalesce(i_brand_id#5513, 0) ASC NULLS FIRST, isnull(i_brand_id#5513) ASC NULLS FIRST, coalesce(i_class_id#5515, 0) ASC NULLS FIRST, isnull(i_class_id#5515) ASC NULLS FIRST, coalesce(i_category_id#5517, 0) ASC NULLS FIRST, isnull(i_category_id#5517) ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517), 200), ENSURE_REQUIREMENTS, [id=#62921]
         :                    :                                         :                    :                          +- Project [i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                    :                                         :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5528], Inner
         :                    :                                         :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#62912]
         :                    :                                         :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#5513, i_class_id#5515, i_category_id#5517]
         :                    :                                         :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5506], Inner
         :                    :                                         :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#62904]
         :                    :                                         :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
         :                    :                                         :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
         :                    :                                         :                    :                                :           +- Sort [i_item_sk#5506 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                                :              +- Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#62905]
         :                    :                                         :                    :                                :                 +- Filter isnotnull(i_item_sk#5506)
         :                    :                                         :                    :                                :                    +- FileScan parquet [i_item_sk#5506,i_brand_id#5513,i_class_id#5515,i_category_id#5517] Batched: true, DataFilters: [isnotnull(i_item_sk#5506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                         :                    :                                +- Sort [d_date_sk#5528 ASC NULLS FIRST], false, 0
         :                    :                                         :                    :                                   +- Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#62913]
         :                    :                                         :                    :                                      +- Project [d_date_sk#5528]
         :                    :                                         :                    :                                         +- Filter (((isnotnull(d_year#5534) AND (d_year#5534 >= 1999)) AND (d_year#5534 <= 2001)) AND isnotnull(d_date_sk#5528))
         :                    :                                         :                    :                                            +- FileScan parquet [d_date_sk#5528,d_year#5534] Batched: true, DataFilters: [isnotnull(d_year#5534), (d_year#5534 >= 1999), (d_year#5534 <= 2001), isnotnull(d_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                                         :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
         :                    :                                         :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#62936]
         :                    :                                         :                          +- Project [d_date_sk#612]
         :                    :                                         :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
         :                    :                                         :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    :                                         +- Sort [coalesce(i_brand_id#5563, 0) ASC NULLS FIRST, isnull(i_brand_id#5563) ASC NULLS FIRST, coalesce(i_class_id#5565, 0) ASC NULLS FIRST, isnull(i_class_id#5565) ASC NULLS FIRST, coalesce(i_category_id#5567, 0) ASC NULLS FIRST, isnull(i_category_id#5567) ASC NULLS FIRST], false, 0
         :                    :                                            +- Exchange hashpartitioning(coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567), 200), ENSURE_REQUIREMENTS, [id=#62963]
         :                    :                                               +- Project [i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                    :                                                  +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5578], Inner
         :                    :                                                     :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
         :                    :                                                     :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#62954]
         :                    :                                                     :     +- Project [ws_sold_date_sk#476, i_brand_id#5563, i_class_id#5565, i_category_id#5567]
         :                    :                                                     :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5556], Inner
         :                    :                                                     :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
         :                    :                                                     :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#62946]
         :                    :                                                     :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
         :                    :                                                     :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
         :                    :                                                     :           +- Sort [i_item_sk#5556 ASC NULLS FIRST], false, 0
         :                    :                                                     :              +- Exchange hashpartitioning(i_item_sk#5556, 200), ENSURE_REQUIREMENTS, [id=#62947]
         :                    :                                                     :                 +- Filter isnotnull(i_item_sk#5556)
         :                    :                                                     :                    +- FileScan parquet [i_item_sk#5556,i_brand_id#5563,i_class_id#5565,i_category_id#5567] Batched: true, DataFilters: [isnotnull(i_item_sk#5556)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
         :                    :                                                     +- Sort [d_date_sk#5578 ASC NULLS FIRST], false, 0
         :                    :                                                        +- Exchange hashpartitioning(d_date_sk#5578, 200), ENSURE_REQUIREMENTS, [id=#62955]
         :                    :                                                           +- Project [d_date_sk#5578]
         :                    :                                                              +- Filter (((isnotnull(d_year#5584) AND (d_year#5584 >= 1999)) AND (d_year#5584 <= 2001)) AND isnotnull(d_date_sk#5578))
         :                    :                                                                 +- FileScan parquet [d_date_sk#5578,d_year#5584] Batched: true, DataFilters: [isnotnull(d_year#5584), (d_year#5584 >= 1999), (d_year#5584 <= 2001), isnotnull(d_date_sk#5578)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
         :                    +- Sort [d_date_sk#5826 ASC NULLS FIRST], false, 0
         :                       +- Exchange hashpartitioning(d_date_sk#5826, 200), ENSURE_REQUIREMENTS, [id=#62991]
         :                          +- Project [d_date_sk#5826]
         :                             +- Filter ((isnotnull(d_week_seq#5830) AND (d_week_seq#5830 = Subquery subquery#5453, [id=#62601])) AND isnotnull(d_date_sk#5826))
         :                                :  +- Subquery subquery#5453, [id=#62601]
         :                                :     +- AdaptiveSparkPlan isFinalPlan=true
                                                +- == Final Plan ==
                                                   *(1) Project [d_week_seq#5933]
                                                   +- *(1) Filter (((((isnotnull(d_year#5935) AND isnotnull(d_moy#5937)) AND isnotnull(d_dom#5938)) AND (d_year#5935 = 2000)) AND (d_moy#5937 = 12)) AND (d_dom#5938 = 12))
                                                      +- *(1) ColumnarToRow
                                                         +- FileScan parquet [d_week_seq#5933,d_year#5935,d_moy#5937,d_dom#5938] Batched: true, DataFilters: [isnotnull(d_year#5935), isnotnull(d_moy#5937), isnotnull(d_dom#5938), (d_year#5935 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                +- == Initial Plan ==
                                                   Project [d_week_seq#5933]
                                                   +- Filter (((((isnotnull(d_year#5935) AND isnotnull(d_moy#5937)) AND isnotnull(d_dom#5938)) AND (d_year#5935 = 2000)) AND (d_moy#5937 = 12)) AND (d_dom#5938 = 12))
                                                      +- FileScan parquet [d_week_seq#5933,d_year#5935,d_moy#5937,d_dom#5938] Batched: true, DataFilters: [isnotnull(d_year#5935), isnotnull(d_moy#5937), isnotnull(d_dom#5938), (d_year#5935 = 2000), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,2000), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
         :                                +- FileScan parquet [d_date_sk#5826,d_week_seq#5830] Batched: true, DataFilters: [isnotnull(d_week_seq#5830), isnotnull(d_date_sk#5826)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
         +- Sort [i_brand_id#5884 ASC NULLS FIRST, i_class_id#5886 ASC NULLS FIRST, i_category_id#5888 ASC NULLS FIRST], false, 0
            +- Filter (isnotnull(sales#5456) AND (cast(sales#5456 as decimal(32,6)) > cast(Subquery subquery#5460, [id=#62693] as decimal(32,6))))
               :  +- Subquery subquery#5460, [id=#62693]
               :     +- AdaptiveSparkPlan isFinalPlan=false
               :        +- HashAggregate(keys=[], functions=[avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[average_sales#5483])
               :           +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#62691]
               :              +- HashAggregate(keys=[], functions=[partial_avg(CheckOverflow((promote_precision(cast(cast(quantity#5477 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(list_price#5478 as decimal(12,2)))), DecimalType(18,2), true))], output=[sum#6026, count#6027L])
               :                 +- Union
               :                    :- Project [ss_quantity#5616 AS quantity#5477, ss_list_price#5618 AS list_price#5478]
               :                    :  +- SortMergeJoin [ss_sold_date_sk#5606], [d_date_sk#5629], Inner
               :                    :     :- Sort [ss_sold_date_sk#5606 ASC NULLS FIRST], false, 0
               :                    :     :  +- Exchange hashpartitioning(ss_sold_date_sk#5606, 200), ENSURE_REQUIREMENTS, [id=#62668]
               :                    :     :     +- Filter isnotnull(ss_sold_date_sk#5606)
               :                    :     :        +- FileScan parquet [ss_sold_date_sk#5606,ss_quantity#5616,ss_list_price#5618] Batched: true, DataFilters: [isnotnull(ss_sold_date_sk#5606)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
               :                    :     +- Sort [d_date_sk#5629 ASC NULLS FIRST], false, 0
               :                    :        +- Exchange hashpartitioning(d_date_sk#5629, 200), ENSURE_REQUIREMENTS, [id=#62669]
               :                    :           +- Project [d_date_sk#5629]
               :                    :              +- Filter (((isnotnull(d_year#5635) AND (d_year#5635 >= 1999)) AND (d_year#5635 <= 2001)) AND isnotnull(d_date_sk#5629))
               :                    :                 +- FileScan parquet [d_date_sk#5629,d_year#5635] Batched: true, DataFilters: [isnotnull(d_year#5635), (d_year#5635 >= 1999), (d_year#5635 <= 2001), isnotnull(d_date_sk#5629)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    :- Project [cs_quantity#5675 AS quantity#5479, cs_list_price#5677 AS list_price#5480]
               :                    :  +- SortMergeJoin [cs_sold_date_sk#5657], [d_date_sk#5691], Inner
               :                    :     :- Sort [cs_sold_date_sk#5657 ASC NULLS FIRST], false, 0
               :                    :     :  +- Exchange hashpartitioning(cs_sold_date_sk#5657, 200), ENSURE_REQUIREMENTS, [id=#62675]
               :                    :     :     +- Filter isnotnull(cs_sold_date_sk#5657)
               :                    :     :        +- FileScan parquet [cs_sold_date_sk#5657,cs_quantity#5675,cs_list_price#5677] Batched: true, DataFilters: [isnotnull(cs_sold_date_sk#5657)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_quantity:int,cs_list_price:decimal(7,2)>
               :                    :     +- Sort [d_date_sk#5691 ASC NULLS FIRST], false, 0
               :                    :        +- Exchange hashpartitioning(d_date_sk#5691, 200), ENSURE_REQUIREMENTS, [id=#62676]
               :                    :           +- Project [d_date_sk#5691]
               :                    :              +- Filter (((isnotnull(d_year#5697) AND (d_year#5697 >= 1999)) AND (d_year#5697 <= 2001)) AND isnotnull(d_date_sk#5691))
               :                    :                 +- FileScan parquet [d_date_sk#5691,d_year#5697] Batched: true, DataFilters: [isnotnull(d_year#5697), (d_year#5697 >= 1999), (d_year#5697 <= 2001), isnotnull(d_date_sk#5691)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               :                    +- Project [ws_quantity#5737 AS quantity#5481, ws_list_price#5739 AS list_price#5482]
               :                       +- SortMergeJoin [ws_sold_date_sk#5719], [d_date_sk#5753], Inner
               :                          :- Sort [ws_sold_date_sk#5719 ASC NULLS FIRST], false, 0
               :                          :  +- Exchange hashpartitioning(ws_sold_date_sk#5719, 200), ENSURE_REQUIREMENTS, [id=#62682]
               :                          :     +- Filter isnotnull(ws_sold_date_sk#5719)
               :                          :        +- FileScan parquet [ws_sold_date_sk#5719,ws_quantity#5737,ws_list_price#5739] Batched: true, DataFilters: [isnotnull(ws_sold_date_sk#5719)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_quantity:int,ws_list_price:decimal(7,2)>
               :                          +- Sort [d_date_sk#5753 ASC NULLS FIRST], false, 0
               :                             +- Exchange hashpartitioning(d_date_sk#5753, 200), ENSURE_REQUIREMENTS, [id=#62683]
               :                                +- Project [d_date_sk#5753]
               :                                   +- Filter (((isnotnull(d_year#5759) AND (d_year#5759 >= 1999)) AND (d_year#5759 <= 2001)) AND isnotnull(d_date_sk#5753))
               :                                      +- FileScan parquet [d_date_sk#5753,d_year#5759] Batched: true, DataFilters: [isnotnull(d_year#5759), (d_year#5759 >= 1999), (d_year#5759 <= 2001), isnotnull(d_date_sk#5753)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
               +- HashAggregate(keys=[i_brand_id#5884, i_class_id#5886, i_category_id#5888], functions=[sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5864 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5866 as decimal(12,2)))), DecimalType(18,2), true)), count(1)], output=[i_brand_id#5884, i_class_id#5886, i_category_id#5888, sales#5456, number_sales#5457L])
                  +- Exchange hashpartitioning(i_brand_id#5884, i_class_id#5886, i_category_id#5888, 200), ENSURE_REQUIREMENTS, [id=#63178]
                     +- HashAggregate(keys=[i_brand_id#5884, i_class_id#5886, i_category_id#5888], functions=[partial_sum(CheckOverflow((promote_precision(cast(cast(ss_quantity#5864 as decimal(10,0)) as decimal(12,2))) * promote_precision(cast(ss_list_price#5866 as decimal(12,2)))), DecimalType(18,2), true)), partial_count(1)], output=[i_brand_id#5884, i_class_id#5886, i_category_id#5888, sum#6021, isEmpty#6022, count#6023L])
                        +- Project [ss_quantity#5864, ss_list_price#5866, i_brand_id#5884, i_class_id#5886, i_category_id#5888]
                           +- SortMergeJoin [ss_sold_date_sk#5854], [d_date_sk#5899], Inner
                              :- Sort [ss_sold_date_sk#5854 ASC NULLS FIRST], false, 0
                              :  +- Exchange hashpartitioning(ss_sold_date_sk#5854, 200), ENSURE_REQUIREMENTS, [id=#63170]
                              :     +- Project [ss_sold_date_sk#5854, ss_quantity#5864, ss_list_price#5866, i_brand_id#5884, i_class_id#5886, i_category_id#5888]
                              :        +- SortMergeJoin [ss_item_sk#5856], [i_item_sk#5877], Inner
                              :           :- SortMergeJoin [ss_item_sk#5856], [ss_item_sk#5476], LeftSemi
                              :           :  :- Sort [ss_item_sk#5856 ASC NULLS FIRST], false, 0
                              :           :  :  +- Exchange hashpartitioning(ss_item_sk#5856, 200), ENSURE_REQUIREMENTS, [id=#63078]
                              :           :  :     +- Filter (isnotnull(ss_item_sk#5856) AND isnotnull(ss_sold_date_sk#5854))
                              :           :  :        +- FileScan parquet [ss_sold_date_sk#5854,ss_item_sk#5856,ss_quantity#5864,ss_list_price#5866] Batched: true, DataFilters: [isnotnull(ss_item_sk#5856), isnotnull(ss_sold_date_sk#5854)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int,ss_quantity:int,ss_list_price:decimal(7,2)>
                              :           :  +- Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
                              :           :     +- Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#63079]
                              :           :        +- Project [i_item_sk#668 AS ss_item_sk#5476]
                              :           :           +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5473, class_id#5474, category_id#5475], Inner
                              :           :              :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                              :           :              :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#63071]
                              :           :              :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                              :           :              :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :              +- Sort [brand_id#5473 ASC NULLS FIRST, class_id#5474 ASC NULLS FIRST, category_id#5475 ASC NULLS FIRST], false, 0
                              :           :                 +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :           :                    +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#63067]
                              :           :                       +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :           :                          +- SortMergeJoin [coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475)], [coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567)], LeftSemi
                              :           :                             :- Sort [coalesce(brand_id#5473, 0) ASC NULLS FIRST, isnull(brand_id#5473) ASC NULLS FIRST, coalesce(class_id#5474, 0) ASC NULLS FIRST, isnull(class_id#5474) ASC NULLS FIRST, coalesce(category_id#5475, 0) ASC NULLS FIRST, isnull(category_id#5475) ASC NULLS FIRST], false, 0
                              :           :                             :  +- Exchange hashpartitioning(coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475), 200), ENSURE_REQUIREMENTS, [id=#63060]
                              :           :                             :     +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :           :                             :        +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#63041]
                              :           :                             :           +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :           :                             :              +- Project [i_brand_id#5491 AS brand_id#5473, i_class_id#5493 AS class_id#5474, i_category_id#5495 AS category_id#5475]
                              :           :                             :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                              :           :                             :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                              :           :                             :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#63033]
                              :           :                             :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5491, i_class_id#5493, i_category_id#5495]
                              :           :                             :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5484], Inner
                              :           :                             :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                              :           :                             :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#63025]
                              :           :                             :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                              :           :                             :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :           :                             :                    :           +- Sort [i_item_sk#5484 ASC NULLS FIRST], false, 0
                              :           :                             :                    :              +- Exchange hashpartitioning(i_item_sk#5484, 200), ENSURE_REQUIREMENTS, [id=#63026]
                              :           :                             :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495)], [coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517)], LeftSemi
                              :           :                             :                    :                    :- Sort [coalesce(i_brand_id#5491, 0) ASC NULLS FIRST, isnull(i_brand_id#5491) ASC NULLS FIRST, coalesce(i_class_id#5493, 0) ASC NULLS FIRST, isnull(i_class_id#5493) ASC NULLS FIRST, coalesce(i_category_id#5495, 0) ASC NULLS FIRST, isnull(i_category_id#5495) ASC NULLS FIRST], false, 0
                              :           :                             :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495), 200), ENSURE_REQUIREMENTS, [id=#63018]
                              :           :                             :                    :                    :     +- Filter (((isnotnull(i_item_sk#5484) AND isnotnull(i_brand_id#5491)) AND isnotnull(i_class_id#5493)) AND isnotnull(i_category_id#5495))
                              :           :                             :                    :                    :        +- FileScan parquet [i_item_sk#5484,i_brand_id#5491,i_class_id#5493,i_category_id#5495] Batched: true, DataFilters: [isnotnull(i_item_sk#5484), isnotnull(i_brand_id#5491), isnotnull(i_class_id#5493), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                             :                    :                    +- Sort [coalesce(i_brand_id#5513, 0) ASC NULLS FIRST, isnull(i_brand_id#5513) ASC NULLS FIRST, coalesce(i_class_id#5515, 0) ASC NULLS FIRST, isnull(i_class_id#5515) ASC NULLS FIRST, coalesce(i_category_id#5517, 0) ASC NULLS FIRST, isnull(i_category_id#5517) ASC NULLS FIRST], false, 0
                              :           :                             :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517), 200), ENSURE_REQUIREMENTS, [id=#63019]
                              :           :                             :                    :                          +- Project [i_brand_id#5513, i_class_id#5515, i_category_id#5517]
                              :           :                             :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5528], Inner
                              :           :                             :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                              :           :                             :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#63010]
                              :           :                             :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#5513, i_class_id#5515, i_category_id#5517]
                              :           :                             :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5506], Inner
                              :           :                             :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                              :           :                             :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#63002]
                              :           :                             :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                              :           :                             :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :           :                             :                    :                                :           +- Sort [i_item_sk#5506 ASC NULLS FIRST], false, 0
                              :           :                             :                    :                                :              +- Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#63003]
                              :           :                             :                    :                                :                 +- Filter isnotnull(i_item_sk#5506)
                              :           :                             :                    :                                :                    +- FileScan parquet [i_item_sk#5506,i_brand_id#5513,i_class_id#5515,i_category_id#5517] Batched: true, DataFilters: [isnotnull(i_item_sk#5506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                             :                    :                                +- Sort [d_date_sk#5528 ASC NULLS FIRST], false, 0
                              :           :                             :                    :                                   +- Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63011]
                              :           :                             :                    :                                      +- Project [d_date_sk#5528]
                              :           :                             :                    :                                         +- Filter (((isnotnull(d_year#5534) AND (d_year#5534 >= 1999)) AND (d_year#5534 <= 2001)) AND isnotnull(d_date_sk#5528))
                              :           :                             :                    :                                            +- FileScan parquet [d_date_sk#5528,d_year#5534] Batched: true, DataFilters: [isnotnull(d_year#5534), (d_year#5534 >= 1999), (d_year#5534 <= 2001), isnotnull(d_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :                             :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                              :           :                             :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#63034]
                              :           :                             :                          +- Project [d_date_sk#612]
                              :           :                             :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                              :           :                             :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           :                             +- Sort [coalesce(i_brand_id#5563, 0) ASC NULLS FIRST, isnull(i_brand_id#5563) ASC NULLS FIRST, coalesce(i_class_id#5565, 0) ASC NULLS FIRST, isnull(i_class_id#5565) ASC NULLS FIRST, coalesce(i_category_id#5567, 0) ASC NULLS FIRST, isnull(i_category_id#5567) ASC NULLS FIRST], false, 0
                              :           :                                +- Exchange hashpartitioning(coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567), 200), ENSURE_REQUIREMENTS, [id=#63061]
                              :           :                                   +- Project [i_brand_id#5563, i_class_id#5565, i_category_id#5567]
                              :           :                                      +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5578], Inner
                              :           :                                         :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                              :           :                                         :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#63052]
                              :           :                                         :     +- Project [ws_sold_date_sk#476, i_brand_id#5563, i_class_id#5565, i_category_id#5567]
                              :           :                                         :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5556], Inner
                              :           :                                         :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                              :           :                                         :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#63044]
                              :           :                                         :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                              :           :                                         :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :           :                                         :           +- Sort [i_item_sk#5556 ASC NULLS FIRST], false, 0
                              :           :                                         :              +- Exchange hashpartitioning(i_item_sk#5556, 200), ENSURE_REQUIREMENTS, [id=#63045]
                              :           :                                         :                 +- Filter isnotnull(i_item_sk#5556)
                              :           :                                         :                    +- FileScan parquet [i_item_sk#5556,i_brand_id#5563,i_class_id#5565,i_category_id#5567] Batched: true, DataFilters: [isnotnull(i_item_sk#5556)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :           :                                         +- Sort [d_date_sk#5578 ASC NULLS FIRST], false, 0
                              :           :                                            +- Exchange hashpartitioning(d_date_sk#5578, 200), ENSURE_REQUIREMENTS, [id=#63053]
                              :           :                                               +- Project [d_date_sk#5578]
                              :           :                                                  +- Filter (((isnotnull(d_year#5584) AND (d_year#5584 >= 1999)) AND (d_year#5584 <= 2001)) AND isnotnull(d_date_sk#5578))
                              :           :                                                     +- FileScan parquet [d_date_sk#5578,d_year#5584] Batched: true, DataFilters: [isnotnull(d_year#5584), (d_year#5584 >= 1999), (d_year#5584 <= 2001), isnotnull(d_date_sk#5578)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :           +- SortMergeJoin [i_item_sk#5877], [ss_item_sk#5476], LeftSemi
                              :              :- Sort [i_item_sk#5877 ASC NULLS FIRST], false, 0
                              :              :  +- Exchange hashpartitioning(i_item_sk#5877, 200), ENSURE_REQUIREMENTS, [id=#63160]
                              :              :     +- Filter (((isnotnull(i_item_sk#5877) AND isnotnull(i_brand_id#5884)) AND isnotnull(i_class_id#5886)) AND isnotnull(i_category_id#5888))
                              :              :        +- FileScan parquet [i_item_sk#5877,i_brand_id#5884,i_class_id#5886,i_category_id#5888] Batched: true, DataFilters: [isnotnull(i_item_sk#5877), isnotnull(i_brand_id#5884), isnotnull(i_class_id#5886), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :              +- Sort [ss_item_sk#5476 ASC NULLS FIRST], false, 0
                              :                 +- Exchange hashpartitioning(ss_item_sk#5476, 200), ENSURE_REQUIREMENTS, [id=#63161]
                              :                    +- Project [i_item_sk#668 AS ss_item_sk#5476]
                              :                       +- SortMergeJoin [i_brand_id#675, i_class_id#677, i_category_id#679], [brand_id#5473, class_id#5474, category_id#5475], Inner
                              :                          :- Sort [i_brand_id#675 ASC NULLS FIRST, i_class_id#677 ASC NULLS FIRST, i_category_id#679 ASC NULLS FIRST], false, 0
                              :                          :  +- Exchange hashpartitioning(i_brand_id#675, i_class_id#677, i_category_id#679, 200), ENSURE_REQUIREMENTS, [id=#63153]
                              :                          :     +- Filter ((isnotnull(i_brand_id#675) AND isnotnull(i_class_id#677)) AND isnotnull(i_category_id#679))
                              :                          :        +- FileScan parquet [i_item_sk#668,i_brand_id#675,i_class_id#677,i_category_id#679] Batched: true, DataFilters: [isnotnull(i_brand_id#675), isnotnull(i_class_id#677), isnotnull(i_category_id#679)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                          +- Sort [brand_id#5473 ASC NULLS FIRST, class_id#5474 ASC NULLS FIRST, category_id#5475 ASC NULLS FIRST], false, 0
                              :                             +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :                                +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#63149]
                              :                                   +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :                                      +- SortMergeJoin [coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475)], [coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567)], LeftSemi
                              :                                         :- Sort [coalesce(brand_id#5473, 0) ASC NULLS FIRST, isnull(brand_id#5473) ASC NULLS FIRST, coalesce(class_id#5474, 0) ASC NULLS FIRST, isnull(class_id#5474) ASC NULLS FIRST, coalesce(category_id#5475, 0) ASC NULLS FIRST, isnull(category_id#5475) ASC NULLS FIRST], false, 0
                              :                                         :  +- Exchange hashpartitioning(coalesce(brand_id#5473, 0), isnull(brand_id#5473), coalesce(class_id#5474, 0), isnull(class_id#5474), coalesce(category_id#5475, 0), isnull(category_id#5475), 200), ENSURE_REQUIREMENTS, [id=#63142]
                              :                                         :     +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :                                         :        +- Exchange hashpartitioning(brand_id#5473, class_id#5474, category_id#5475, 200), ENSURE_REQUIREMENTS, [id=#63123]
                              :                                         :           +- HashAggregate(keys=[brand_id#5473, class_id#5474, category_id#5475], functions=[], output=[brand_id#5473, class_id#5474, category_id#5475])
                              :                                         :              +- Project [i_brand_id#5491 AS brand_id#5473, i_class_id#5493 AS class_id#5474, i_category_id#5495 AS category_id#5475]
                              :                                         :                 +- SortMergeJoin [ss_sold_date_sk#252], [d_date_sk#612], Inner
                              :                                         :                    :- Sort [ss_sold_date_sk#252 ASC NULLS FIRST], false, 0
                              :                                         :                    :  +- Exchange hashpartitioning(ss_sold_date_sk#252, 200), ENSURE_REQUIREMENTS, [id=#63115]
                              :                                         :                    :     +- Project [ss_sold_date_sk#252, i_brand_id#5491, i_class_id#5493, i_category_id#5495]
                              :                                         :                    :        +- SortMergeJoin [ss_item_sk#254], [i_item_sk#5484], Inner
                              :                                         :                    :           :- Sort [ss_item_sk#254 ASC NULLS FIRST], false, 0
                              :                                         :                    :           :  +- Exchange hashpartitioning(ss_item_sk#254, 200), ENSURE_REQUIREMENTS, [id=#63107]
                              :                                         :                    :           :     +- Filter (isnotnull(ss_item_sk#254) AND isnotnull(ss_sold_date_sk#252))
                              :                                         :                    :           :        +- FileScan parquet [ss_sold_date_sk#252,ss_item_sk#254] Batched: true, DataFilters: [isnotnull(ss_item_sk#254), isnotnull(ss_sold_date_sk#252)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/store_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ss_item_sk), IsNotNull(ss_sold_date_sk)], ReadSchema: struct<ss_sold_date_sk:int,ss_item_sk:int>
                              :                                         :                    :           +- Sort [i_item_sk#5484 ASC NULLS FIRST], false, 0
                              :                                         :                    :              +- Exchange hashpartitioning(i_item_sk#5484, 200), ENSURE_REQUIREMENTS, [id=#63108]
                              :                                         :                    :                 +- SortMergeJoin [coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495)], [coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517)], LeftSemi
                              :                                         :                    :                    :- Sort [coalesce(i_brand_id#5491, 0) ASC NULLS FIRST, isnull(i_brand_id#5491) ASC NULLS FIRST, coalesce(i_class_id#5493, 0) ASC NULLS FIRST, isnull(i_class_id#5493) ASC NULLS FIRST, coalesce(i_category_id#5495, 0) ASC NULLS FIRST, isnull(i_category_id#5495) ASC NULLS FIRST], false, 0
                              :                                         :                    :                    :  +- Exchange hashpartitioning(coalesce(i_brand_id#5491, 0), isnull(i_brand_id#5491), coalesce(i_class_id#5493, 0), isnull(i_class_id#5493), coalesce(i_category_id#5495, 0), isnull(i_category_id#5495), 200), ENSURE_REQUIREMENTS, [id=#63100]
                              :                                         :                    :                    :     +- Filter (((isnotnull(i_item_sk#5484) AND isnotnull(i_brand_id#5491)) AND isnotnull(i_class_id#5493)) AND isnotnull(i_category_id#5495))
                              :                                         :                    :                    :        +- FileScan parquet [i_item_sk#5484,i_brand_id#5491,i_class_id#5493,i_category_id#5495] Batched: true, DataFilters: [isnotnull(i_item_sk#5484), isnotnull(i_brand_id#5491), isnotnull(i_class_id#5493), isnotnull(i_c..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk), IsNotNull(i_brand_id), IsNotNull(i_class_id), IsNotNull(i_category_id)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                         :                    :                    +- Sort [coalesce(i_brand_id#5513, 0) ASC NULLS FIRST, isnull(i_brand_id#5513) ASC NULLS FIRST, coalesce(i_class_id#5515, 0) ASC NULLS FIRST, isnull(i_class_id#5515) ASC NULLS FIRST, coalesce(i_category_id#5517, 0) ASC NULLS FIRST, isnull(i_category_id#5517) ASC NULLS FIRST], false, 0
                              :                                         :                    :                       +- Exchange hashpartitioning(coalesce(i_brand_id#5513, 0), isnull(i_brand_id#5513), coalesce(i_class_id#5515, 0), isnull(i_class_id#5515), coalesce(i_category_id#5517, 0), isnull(i_category_id#5517), 200), ENSURE_REQUIREMENTS, [id=#63101]
                              :                                         :                    :                          +- Project [i_brand_id#5513, i_class_id#5515, i_category_id#5517]
                              :                                         :                    :                             +- SortMergeJoin [cs_sold_date_sk#544], [d_date_sk#5528], Inner
                              :                                         :                    :                                :- Sort [cs_sold_date_sk#544 ASC NULLS FIRST], false, 0
                              :                                         :                    :                                :  +- Exchange hashpartitioning(cs_sold_date_sk#544, 200), ENSURE_REQUIREMENTS, [id=#63092]
                              :                                         :                    :                                :     +- Project [cs_sold_date_sk#544, i_brand_id#5513, i_class_id#5515, i_category_id#5517]
                              :                                         :                    :                                :        +- SortMergeJoin [cs_item_sk#559], [i_item_sk#5506], Inner
                              :                                         :                    :                                :           :- Sort [cs_item_sk#559 ASC NULLS FIRST], false, 0
                              :                                         :                    :                                :           :  +- Exchange hashpartitioning(cs_item_sk#559, 200), ENSURE_REQUIREMENTS, [id=#63084]
                              :                                         :                    :                                :           :     +- Filter (isnotnull(cs_item_sk#559) AND isnotnull(cs_sold_date_sk#544))
                              :                                         :                    :                                :           :        +- FileScan parquet [cs_sold_date_sk#544,cs_item_sk#559] Batched: true, DataFilters: [isnotnull(cs_item_sk#559), isnotnull(cs_sold_date_sk#544)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/catalog_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(cs_item_sk), IsNotNull(cs_sold_date_sk)], ReadSchema: struct<cs_sold_date_sk:int,cs_item_sk:int>
                              :                                         :                    :                                :           +- Sort [i_item_sk#5506 ASC NULLS FIRST], false, 0
                              :                                         :                    :                                :              +- Exchange hashpartitioning(i_item_sk#5506, 200), ENSURE_REQUIREMENTS, [id=#63085]
                              :                                         :                    :                                :                 +- Filter isnotnull(i_item_sk#5506)
                              :                                         :                    :                                :                    +- FileScan parquet [i_item_sk#5506,i_brand_id#5513,i_class_id#5515,i_category_id#5517] Batched: true, DataFilters: [isnotnull(i_item_sk#5506)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                         :                    :                                +- Sort [d_date_sk#5528 ASC NULLS FIRST], false, 0
                              :                                         :                    :                                   +- Exchange hashpartitioning(d_date_sk#5528, 200), ENSURE_REQUIREMENTS, [id=#63093]
                              :                                         :                    :                                      +- Project [d_date_sk#5528]
                              :                                         :                    :                                         +- Filter (((isnotnull(d_year#5534) AND (d_year#5534 >= 1999)) AND (d_year#5534 <= 2001)) AND isnotnull(d_date_sk#5528))
                              :                                         :                    :                                            +- FileScan parquet [d_date_sk#5528,d_year#5534] Batched: true, DataFilters: [isnotnull(d_year#5534), (d_year#5534 >= 1999), (d_year#5534 <= 2001), isnotnull(d_date_sk#5528)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                                         :                    +- Sort [d_date_sk#612 ASC NULLS FIRST], false, 0
                              :                                         :                       +- Exchange hashpartitioning(d_date_sk#612, 200), ENSURE_REQUIREMENTS, [id=#63116]
                              :                                         :                          +- Project [d_date_sk#612]
                              :                                         :                             +- Filter (((isnotnull(d_year#618) AND (d_year#618 >= 1999)) AND (d_year#618 <= 2001)) AND isnotnull(d_date_sk#612))
                              :                                         :                                +- FileScan parquet [d_date_sk#612,d_year#618] Batched: true, DataFilters: [isnotnull(d_year#618), (d_year#618 >= 1999), (d_year#618 <= 2001), isnotnull(d_date_sk#612)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              :                                         +- Sort [coalesce(i_brand_id#5563, 0) ASC NULLS FIRST, isnull(i_brand_id#5563) ASC NULLS FIRST, coalesce(i_class_id#5565, 0) ASC NULLS FIRST, isnull(i_class_id#5565) ASC NULLS FIRST, coalesce(i_category_id#5567, 0) ASC NULLS FIRST, isnull(i_category_id#5567) ASC NULLS FIRST], false, 0
                              :                                            +- Exchange hashpartitioning(coalesce(i_brand_id#5563, 0), isnull(i_brand_id#5563), coalesce(i_class_id#5565, 0), isnull(i_class_id#5565), coalesce(i_category_id#5567, 0), isnull(i_category_id#5567), 200), ENSURE_REQUIREMENTS, [id=#63143]
                              :                                               +- Project [i_brand_id#5563, i_class_id#5565, i_category_id#5567]
                              :                                                  +- SortMergeJoin [ws_sold_date_sk#476], [d_date_sk#5578], Inner
                              :                                                     :- Sort [ws_sold_date_sk#476 ASC NULLS FIRST], false, 0
                              :                                                     :  +- Exchange hashpartitioning(ws_sold_date_sk#476, 200), ENSURE_REQUIREMENTS, [id=#63134]
                              :                                                     :     +- Project [ws_sold_date_sk#476, i_brand_id#5563, i_class_id#5565, i_category_id#5567]
                              :                                                     :        +- SortMergeJoin [ws_item_sk#479], [i_item_sk#5556], Inner
                              :                                                     :           :- Sort [ws_item_sk#479 ASC NULLS FIRST], false, 0
                              :                                                     :           :  +- Exchange hashpartitioning(ws_item_sk#479, 200), ENSURE_REQUIREMENTS, [id=#63126]
                              :                                                     :           :     +- Filter (isnotnull(ws_item_sk#479) AND isnotnull(ws_sold_date_sk#476))
                              :                                                     :           :        +- FileScan parquet [ws_sold_date_sk#476,ws_item_sk#479] Batched: true, DataFilters: [isnotnull(ws_item_sk#479), isnotnull(ws_sold_date_sk#476)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/web_sales.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(ws_item_sk), IsNotNull(ws_sold_date_sk)], ReadSchema: struct<ws_sold_date_sk:int,ws_item_sk:int>
                              :                                                     :           +- Sort [i_item_sk#5556 ASC NULLS FIRST], false, 0
                              :                                                     :              +- Exchange hashpartitioning(i_item_sk#5556, 200), ENSURE_REQUIREMENTS, [id=#63127]
                              :                                                     :                 +- Filter isnotnull(i_item_sk#5556)
                              :                                                     :                    +- FileScan parquet [i_item_sk#5556,i_brand_id#5563,i_class_id#5565,i_category_id#5567] Batched: true, DataFilters: [isnotnull(i_item_sk#5556)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/item.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(i_item_sk)], ReadSchema: struct<i_item_sk:int,i_brand_id:int,i_class_id:int,i_category_id:int>
                              :                                                     +- Sort [d_date_sk#5578 ASC NULLS FIRST], false, 0
                              :                                                        +- Exchange hashpartitioning(d_date_sk#5578, 200), ENSURE_REQUIREMENTS, [id=#63135]
                              :                                                           +- Project [d_date_sk#5578]
                              :                                                              +- Filter (((isnotnull(d_year#5584) AND (d_year#5584 >= 1999)) AND (d_year#5584 <= 2001)) AND isnotnull(d_date_sk#5578))
                              :                                                                 +- FileScan parquet [d_date_sk#5578,d_year#5584] Batched: true, DataFilters: [isnotnull(d_year#5584), (d_year#5584 >= 1999), (d_year#5584 <= 2001), isnotnull(d_date_sk#5578)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), GreaterThanOrEqual(d_year,1999), LessThanOrEqual(d_year,2001), IsNotNull(d_da..., ReadSchema: struct<d_date_sk:int,d_year:int>
                              +- Sort [d_date_sk#5899 ASC NULLS FIRST], false, 0
                                 +- Exchange hashpartitioning(d_date_sk#5899, 200), ENSURE_REQUIREMENTS, [id=#63171]
                                    +- Project [d_date_sk#5899]
                                       +- Filter ((isnotnull(d_week_seq#5903) AND (d_week_seq#5903 = Subquery subquery#5459, [id=#62699])) AND isnotnull(d_date_sk#5899))
                                          :  +- Subquery subquery#5459, [id=#62699]
                                          :     +- AdaptiveSparkPlan isFinalPlan=true
                                                +- == Final Plan ==
                                                   *(1) Project [d_week_seq#5961]
                                                   +- *(1) Filter (((((isnotnull(d_year#5963) AND isnotnull(d_moy#5965)) AND isnotnull(d_dom#5966)) AND (d_year#5963 = 1999)) AND (d_moy#5965 = 12)) AND (d_dom#5966 = 12))
                                                      +- *(1) ColumnarToRow
                                                         +- FileScan parquet [d_week_seq#5961,d_year#5963,d_moy#5965,d_dom#5966] Batched: true, DataFilters: [isnotnull(d_year#5963), isnotnull(d_moy#5965), isnotnull(d_dom#5966), (d_year#5963 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                                +- == Initial Plan ==
                                                   Project [d_week_seq#5961]
                                                   +- Filter (((((isnotnull(d_year#5963) AND isnotnull(d_moy#5965)) AND isnotnull(d_dom#5966)) AND (d_year#5963 = 1999)) AND (d_moy#5965 = 12)) AND (d_dom#5966 = 12))
                                                      +- FileScan parquet [d_week_seq#5961,d_year#5963,d_moy#5965,d_dom#5966] Batched: true, DataFilters: [isnotnull(d_year#5963), isnotnull(d_moy#5965), isnotnull(d_dom#5966), (d_year#5963 = 1999), (d_m..., Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_year), IsNotNull(d_moy), IsNotNull(d_dom), EqualTo(d_year,1999), EqualTo(d_moy,12), ..., ReadSchema: struct<d_week_seq:int,d_year:int,d_moy:int,d_dom:int>
                                          +- FileScan parquet [d_date_sk#5899,d_week_seq#5903] Batched: true, DataFilters: [isnotnull(d_week_seq#5903), isnotnull(d_date_sk#5899)], Format: Parquet, Location: InMemoryFileIndex(1 paths)[file:/mnt/bigdata/tpcds/sf100-parquet/date_dim.parquet], PartitionFilters: [], PushedFilters: [IsNotNull(d_week_seq), IsNotNull(d_date_sk)], ReadSchema: struct<d_date_sk:int,d_week_seq:int>
