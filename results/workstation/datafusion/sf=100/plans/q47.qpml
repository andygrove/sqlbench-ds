title: unknown
color: null
operator: null
inputs:
- title: unknown
  color: null
  operator: null
  inputs:
  - title: 'Projection: v2.i_category, v2.i_brand, v2.d_year, v2.d_moy, v2.avg_monthly_sales, v2.sum_sales, v2.psum, v2.nsum'
    color: null
    operator: projection
    inputs:
    - title: unknown
      color: null
      operator: null
      inputs:
      - title: 'Projection: v1.i_category, v1.i_brand, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum'
        color: null
        operator: projection
        inputs:
        - title: 'Projection: v1.i_category, v1.i_brand, v1.d_year, v1.d_moy, v1.sum_sales, v1.avg_monthly_sales, v1_lag.sum_sales, v1_lead.sum_sales'
          color: null
          operator: projection
          inputs:
          - title: 'Filter: CAST(v1.rn AS Int64) = CAST(v1_lead.rn AS Int64) - Int64(1)'
            color: null
            operator: filter
            inputs:
            - title: 'Join: v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lead.i_brand AND v1.s_store_name = v1_lead.s_store_name AND v1.s_company_name = v1_lead.s_company_name'
              color: null
              operator: join
              inputs:
              - title: 'Filter: CAST(v1.rn AS Int64) = CAST(v1_lag.rn AS Int64) + Int64(1)'
                color: null
                operator: filter
                inputs:
                - title: 'Join: v1.i_category = v1_lag.i_category AND v1.i_brand = v1_lag.i_brand AND v1.s_store_name = v1_lag.s_store_name AND v1.s_company_name = v1_lag.s_company_name'
                  color: null
                  operator: join
                  inputs:
                  - title: unknown
                    color: null
                    operator: null
                    inputs:
                    - title: 'Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn'
                      color: null
                      operator: projection
                      inputs:
                      - title: 'Projection: AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price)'
                        color: null
                        operator: projection
                        inputs:
                        - title: 'Filter: date_dim.d_year = Int32(2000) AND AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AND CASE WHEN AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] THEN abs(CAST(CAST(SUM(store_sales.ss_sales_price) AS Decimal128(22, 6)) - CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS Decimal128(22, 6)) AS Float64)) / CAST(AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS Float64) ELSE Float64(NULL) END > Float64(0.1)'
                          color: null
                          operator: filter
                          inputs:
                          - title: 'Projection: AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6) AS AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] > Decimal128(Some(0),21,6)Decimal128(Some(0),21,6)AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year], RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST], item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price)'
                            color: null
                            operator: projection
                            inputs:
                            - title: unknown
                              color: null
                              operator: null
                              inputs:
                              - title: unknown
                                color: null
                                operator: null
                                inputs:
                                - title: unknown
                                  color: null
                                  operator: null
                                  inputs:
                                  - title: 'Join: store_sales.ss_store_sk = store.s_store_sk'
                                    color: null
                                    operator: join
                                    inputs:
                                    - title: 'Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk'
                                      color: null
                                      operator: join
                                      inputs:
                                      - title: 'Join: item.i_item_sk = store_sales.ss_item_sk'
                                        color: null
                                        operator: join
                                        inputs:
                                        - title: item
                                          color: null
                                          operator: scan
                                          inputs: []
                                        - title: store_sales
                                          color: null
                                          operator: scan
                                          inputs: []
                                      - title: 'Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                        color: null
                                        operator: projection
                                        inputs:
                                        - title: 'Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)'
                                          color: null
                                          operator: filter
                                          inputs:
                                          - title: 'Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                            color: null
                                            operator: projection
                                            inputs:
                                            - title: date_dim
                                              color: null
                                              operator: scan
                                              inputs: []
                                    - title: store
                                      color: null
                                      operator: scan
                                      inputs: []
                  - title: unknown
                    color: null
                    operator: null
                    inputs:
                    - title: unknown
                      color: null
                      operator: null
                      inputs:
                      - title: 'Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn'
                        color: null
                        operator: projection
                        inputs:
                        - title: unknown
                          color: null
                          operator: null
                          inputs:
                          - title: unknown
                            color: null
                            operator: null
                            inputs:
                            - title: unknown
                              color: null
                              operator: null
                              inputs:
                              - title: 'Join: store_sales.ss_store_sk = store.s_store_sk'
                                color: null
                                operator: join
                                inputs:
                                - title: 'Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk'
                                  color: null
                                  operator: join
                                  inputs:
                                  - title: 'Join: item.i_item_sk = store_sales.ss_item_sk'
                                    color: null
                                    operator: join
                                    inputs:
                                    - title: item
                                      color: null
                                      operator: scan
                                      inputs: []
                                    - title: store_sales
                                      color: null
                                      operator: scan
                                      inputs: []
                                  - title: 'Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                    color: null
                                    operator: projection
                                    inputs:
                                    - title: 'Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)'
                                      color: null
                                      operator: filter
                                      inputs:
                                      - title: 'Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                        color: null
                                        operator: projection
                                        inputs:
                                        - title: date_dim
                                          color: null
                                          operator: scan
                                          inputs: []
                                - title: store
                                  color: null
                                  operator: scan
                                  inputs: []
              - title: unknown
                color: null
                operator: null
                inputs:
                - title: unknown
                  color: null
                  operator: null
                  inputs:
                  - title: 'Projection: item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year, date_dim.d_moy, SUM(store_sales.ss_sales_price) AS sum_sales, AVG(SUM(store_sales.ss_sales_price)) PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name, date_dim.d_year] AS avg_monthly_sales, RANK() PARTITION BY [item.i_category, item.i_brand, store.s_store_name, store.s_company_name] ORDER BY [date_dim.d_year ASC NULLS LAST, date_dim.d_moy ASC NULLS LAST] AS rn'
                    color: null
                    operator: projection
                    inputs:
                    - title: unknown
                      color: null
                      operator: null
                      inputs:
                      - title: unknown
                        color: null
                        operator: null
                        inputs:
                        - title: unknown
                          color: null
                          operator: null
                          inputs:
                          - title: 'Join: store_sales.ss_store_sk = store.s_store_sk'
                            color: null
                            operator: join
                            inputs:
                            - title: 'Join: store_sales.ss_sold_date_sk = date_dim.d_date_sk'
                              color: null
                              operator: join
                              inputs:
                              - title: 'Join: item.i_item_sk = store_sales.ss_item_sk'
                                color: null
                                operator: join
                                inputs:
                                - title: item
                                  color: null
                                  operator: scan
                                  inputs: []
                                - title: store_sales
                                  color: null
                                  operator: scan
                                  inputs: []
                              - title: 'Projection: date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                color: null
                                operator: projection
                                inputs:
                                - title: 'Filter: (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year) AND (date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year OR date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy)'
                                  color: null
                                  operator: filter
                                  inputs:
                                  - title: 'Projection: date_dim.d_moy = Int32(1) AS date_dim.d_moy = Int32(1)Int32(1)date_dim.d_moy, date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12) AS date_dim.d_year = Int32(2000) OR date_dim.d_moy = Int32(12)date_dim.d_moy = Int32(12)Int32(12)date_dim.d_moydate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999) AS date_dim.d_year = Int32(2000) OR date_dim.d_year = Int32(1999)date_dim.d_year = Int32(1999)Int32(1999)date_dim.d_yeardate_dim.d_year = Int32(2000)Int32(2000)date_dim.d_year, date_dim.d_year = Int32(2001) AS date_dim.d_year = Int32(2001)Int32(2001)date_dim.d_year, date_dim.d_date_sk, date_dim.d_year, date_dim.d_moy'
                                    color: null
                                    operator: projection
                                    inputs:
                                    - title: date_dim
                                      color: null
                                      operator: scan
                                      inputs: []
                            - title: store
                              color: null
                              operator: scan
                              inputs: []
